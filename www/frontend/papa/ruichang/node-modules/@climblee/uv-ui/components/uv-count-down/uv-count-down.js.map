{"version":3,"file":"uv-count-down.js","sources":["../../../../../../../../node_modules/@climblee/uv-ui/components/uv-count-down/uv-count-down.vue","../../../../../../../../uniComponent:/L1VzZXJzL2d1b3hpYW9taW5nL2NvZGUvcGFwYS1jb2RlL3BtLXluL3VuaWFwcC1zb2NpYWwtc3BvcnRzLW5ldy9ub2RlX21vZHVsZXMvQGNsaW1ibGVlL3V2LXVpL2NvbXBvbmVudHMvdXYtY291bnQtZG93bi91di1jb3VudC1kb3duLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view \r\n\t\tclass=\"uv-count-down\"\r\n\t\t:style=\"[$uv.addStyle(customStyle)]\">\r\n\t\t<slot>\r\n\t\t\t<text class=\"uv-count-down__text\">{{ formattedTime }}</text>\r\n\t\t</slot>\r\n\t</view>\r\n</template>\r\n<script>\r\n\timport mpMixin from '../../libs/mixin/mpMixin.js'\r\n\timport mixin from '../../libs/mixin/mixin.js'\r\n\timport props from './props.js';\r\n\timport {\r\n\t\tisSameSecond,\r\n\t\tparseFormat,\r\n\t\tparseTimeData\r\n\t} from './utils';\r\n\t/**\r\n\t * uv-count-down 倒计时\r\n\t * @description 该组件一般使用于某个活动的截止时间上，通过数字的变化，给用户明确的时间感受，提示用户进行某一个行为操作。\r\n\t * @tutorial https://www.uvui.cn/components/countDown.html\r\n\t * @property {String | Number}\ttime\t\t倒计时时长，单位ms （默认 0 ）\r\n\t * @property {String}\t\t\tformat\t\t时间格式，DD-日，HH-时，mm-分，ss-秒，SSS-毫秒  （默认 'HH:mm:ss' ）\r\n\t * @property {Boolean}\t\t\tautoStart\t是否自动开始倒计时 （默认 true ）\r\n\t * @property {Boolean}\t\t\tmillisecond\t是否展示毫秒倒计时 （默认 false ）\r\n\t * @event {Function} finish 倒计时结束时触发 \r\n\t * @event {Function} change 倒计时变化时触发 \r\n\t * @event {Function} start\t开始倒计时\r\n\t * @event {Function} pause\t暂停倒计时 \r\n\t * @event {Function} reset\t重设倒计时，若 auto-start 为 true，重设后会自动开始倒计时 \r\n\t * @example <uv-count-down :time=\"time\"></uv-count-down>\r\n\t */\r\n\texport default {\r\n\t\tname: 'uv-count-down',\r\n\t\tmixins: [mpMixin, mixin, props],\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttimer: null,\r\n\t\t\t\t// 各单位(天，时，分等)剩余时间\r\n\t\t\t\ttimeData: parseTimeData(0),\r\n\t\t\t\t// 格式化后的时间，如\"03:23:21\"\r\n\t\t\t\tformattedTime: '0',\r\n\t\t\t\t// 倒计时是否正在进行中\r\n\t\t\t\truning: false,\r\n\t\t\t\tendTime: 0, // 结束的毫秒时间戳\r\n\t\t\t\tremainTime: 0, // 剩余的毫秒时间\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\ttime(n) {\r\n\t\t\t\tthis.reset()\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tthis.init()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tinit() {\r\n\t\t\t\tthis.reset()\r\n\t\t\t},\r\n\t\t\t// 开始倒计时\r\n\t\t\tstart() {\r\n\t\t\t\tif (this.runing) return\r\n\t\t\t\t// 标识为进行中\r\n\t\t\t\tthis.runing = true\r\n\t\t\t\t// 结束时间戳 = 此刻时间戳 + 剩余的时间\r\n\t\t\t\tthis.endTime = Date.now() + this.remainTime\r\n\t\t\t\tthis.toTick()\r\n\t\t\t},\r\n\t\t\t// 根据是否展示毫秒，执行不同操作函数\r\n\t\t\ttoTick() {\r\n\t\t\t\tif (this.millisecond) {\r\n\t\t\t\t\tthis.microTick()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.macroTick()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmacroTick() {\r\n\t\t\t\tthis.clearTimeout()\r\n\t\t\t\t// 每隔一定时间，更新一遍定时器的值\r\n\t\t\t\t// 同时此定时器的作用也能带来毫秒级的更新\r\n\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\t// 获取剩余时间\r\n\t\t\t\t\tconst remain = this.getRemainTime()\r\n\t\t\t\t\t// 重设剩余时间\r\n\t\t\t\t\tif (!isSameSecond(remain, this.remainTime) || remain === 0) {\r\n\t\t\t\t\t\tthis.setRemainTime(remain)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 如果剩余时间不为0，则继续检查更新倒计时\r\n\t\t\t\t\tif (this.remainTime !== 0) {\r\n\t\t\t\t\t\tthis.macroTick()\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 30)\r\n\t\t\t},\r\n\t\t\tmicroTick() {\r\n\t\t\t\tthis.clearTimeout()\r\n\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\tthis.setRemainTime(this.getRemainTime())\r\n\t\t\t\t\tif (this.remainTime !== 0) {\r\n\t\t\t\t\t\tthis.microTick()\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 50)\r\n\t\t\t},\r\n\t\t\t// 获取剩余的时间\r\n\t\t\tgetRemainTime() {\r\n\t\t\t\t// 取最大值，防止出现小于0的剩余时间值\r\n\t\t\t\treturn Math.max(this.endTime - Date.now(), 0)\r\n\t\t\t},\r\n\t\t\t// 设置剩余的时间\r\n\t\t\tsetRemainTime(remain) {\r\n\t\t\t\tthis.remainTime = remain\r\n\t\t\t\t// 根据剩余的毫秒时间，得出该有天，小时，分钟等的值，返回一个对象\r\n\t\t\t\tconst timeData = parseTimeData(remain)\r\n\t\t\t\tthis.$emit('change', timeData)\r\n\t\t\t\t// 得出格式化后的时间\r\n\t\t\t\tthis.formattedTime = parseFormat(this.format, timeData)\r\n\t\t\t\t// 如果时间已到，停止倒计时\r\n\t\t\t\tif (remain <= 0) {\r\n\t\t\t\t\tthis.pause()\r\n\t\t\t\t\tthis.$emit('finish')\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 重置倒计时\r\n\t\t\treset() {\r\n\t\t\t\tthis.pause()\r\n\t\t\t\tthis.remainTime = this.time\r\n\t\t\t\tthis.setRemainTime(this.remainTime)\r\n\t\t\t\tif (this.autoStart) {\r\n\t\t\t\t\tthis.start()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 暂停倒计时\r\n\t\t\tpause() {\r\n\t\t\t\tthis.runing = false;\r\n\t\t\t\tthis.clearTimeout()\r\n\t\t\t},\r\n\t\t\t// 清空定时器\r\n\t\t\tclearTimeout() {\r\n\t\t\t\tclearTimeout(this.timer)\r\n\t\t\t\tthis.timer = null\r\n\t\t\t}\r\n\t\t},\r\n\t\t// #ifdef VUE2\r\n\t\tbeforeDestroy() {\r\n\t\t\tthis.clearTimeout()\r\n\t\t},\r\n\t\t// #endif\r\n\t\t// #ifdef VUE3\r\n\t\tunmounted() {\r\n\t\t\tthis.clearTimeout()\r\n\t\t}\r\n\t\t// #endif\r\n\t}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\t@import '../../libs/css/components.scss';\r\n\t@import '../../libs/css/color.scss';\r\n\t$uv-count-down-text-color: $uv-content-color !default;\r\n\t$uv-count-down-text-font-size: 15px !default;\r\n\t$uv-count-down-text-line-height: 22px !default;\r\n\t.uv-count-down {\r\n\t\t&__text {\r\n\t\t\tcolor: $uv-count-down-text-color;\r\n\t\t\tfont-size: $uv-count-down-text-font-size;\r\n\t\t\tline-height: $uv-count-down-text-line-height;\r\n\t\t}\r\n\t}\r\n</style>","import Component from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/node_modules/@climblee/uv-ui/components/uv-count-down/uv-count-down.vue'\nwx.createComponent(Component)"],"names":["mpMixin","mixin","props","parseTimeData","isSameSecond","parseFormat"],"mappings":";;AAiCC,MAAK,YAAU;AAAA,EACd,MAAM;AAAA,EACN,QAAQ,CAACA,cAAAA,SAASC,cAAK,OAAEC,sBAAK;AAAA,EAC9B,OAAO;AACN,WAAO;AAAA,MACN,OAAO;AAAA;AAAA,MAEP,UAAUC,cAAa,cAAC,CAAC;AAAA;AAAA,MAEzB,eAAe;AAAA;AAAA,MAEf,QAAQ;AAAA,MACR,SAAS;AAAA;AAAA,MACT,YAAY;AAAA;AAAA,IACb;AAAA,EACA;AAAA,EACD,OAAO;AAAA,IACN,KAAK,GAAG;AACP,WAAK,MAAM;AAAA,IACZ;AAAA,EACA;AAAA,EACD,UAAU;AACT,SAAK,KAAK;AAAA,EACV;AAAA,EACD,SAAS;AAAA,IACR,OAAO;AACN,WAAK,MAAM;AAAA,IACX;AAAA;AAAA,IAED,QAAQ;AACP,UAAI,KAAK;AAAQ;AAEjB,WAAK,SAAS;AAEd,WAAK,UAAU,KAAK,IAAM,IAAE,KAAK;AACjC,WAAK,OAAO;AAAA,IACZ;AAAA;AAAA,IAED,SAAS;AACR,UAAI,KAAK,aAAa;AACrB,aAAK,UAAU;AAAA,aACT;AACN,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA,IACD,YAAY;AACX,WAAK,aAAa;AAGlB,WAAK,QAAQ,WAAW,MAAM;AAE7B,cAAM,SAAS,KAAK,cAAc;AAElC,YAAI,CAACC,cAAY,aAAC,QAAQ,KAAK,UAAU,KAAK,WAAW,GAAG;AAC3D,eAAK,cAAc,MAAM;AAAA,QAC1B;AAEA,YAAI,KAAK,eAAe,GAAG;AAC1B,eAAK,UAAU;AAAA,QAChB;AAAA,MACA,GAAE,EAAE;AAAA,IACL;AAAA,IACD,YAAY;AACX,WAAK,aAAa;AAClB,WAAK,QAAQ,WAAW,MAAM;AAC7B,aAAK,cAAc,KAAK,eAAe;AACvC,YAAI,KAAK,eAAe,GAAG;AAC1B,eAAK,UAAU;AAAA,QAChB;AAAA,MACA,GAAE,EAAE;AAAA,IACL;AAAA;AAAA,IAED,gBAAgB;AAEf,aAAO,KAAK,IAAI,KAAK,UAAU,KAAK,IAAK,GAAE,CAAC;AAAA,IAC5C;AAAA;AAAA,IAED,cAAc,QAAQ;AACrB,WAAK,aAAa;AAElB,YAAM,WAAWD,cAAa,cAAC,MAAM;AACrC,WAAK,MAAM,UAAU,QAAQ;AAE7B,WAAK,gBAAgBE,cAAAA,YAAY,KAAK,QAAQ,QAAQ;AAEtD,UAAI,UAAU,GAAG;AAChB,aAAK,MAAM;AACX,aAAK,MAAM,QAAQ;AAAA,MACpB;AAAA,IACA;AAAA;AAAA,IAED,QAAQ;AACP,WAAK,MAAM;AACX,WAAK,aAAa,KAAK;AACvB,WAAK,cAAc,KAAK,UAAU;AAClC,UAAI,KAAK,WAAW;AACnB,aAAK,MAAM;AAAA,MACZ;AAAA,IACA;AAAA;AAAA,IAED,QAAQ;AACP,WAAK,SAAS;AACd,WAAK,aAAa;AAAA,IAClB;AAAA;AAAA,IAED,eAAe;AACd,mBAAa,KAAK,KAAK;AACvB,WAAK,QAAQ;AAAA,IACd;AAAA,EACA;AAAA,EAOD,YAAY;AACX,SAAK,aAAa;AAAA,EACnB;AAED;;;;;;;;ACxJD,GAAG,gBAAgB,SAAS;","x_google_ignoreList":[0]}