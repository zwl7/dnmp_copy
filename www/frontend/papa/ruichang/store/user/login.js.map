{"version":3,"file":"login.js","sources":["../../../../../src/store/user/login.js"],"sourcesContent":["import {\n  loginByPhone,\n  getCompany,\n  getTokenNoLogin,\n  miniLogin,\n  wxMiniAuthLogin,\n} from '@/apis/user/index'\nimport { platform } from '@/utils/platform'\n\nclass UserLoginClass {\n  constructor(parameters) {}\n\n  getTemporaryToken() {\n    return new Promise(async (resolve, reject) => {\n      let res = {}\n      if (platform == 'h5') {\n        res = await this.getH5TemporaryToken()\n      } else if (platform == 'mp-weixin') {\n        res = await this.getWxTemporaryToken()\n      }\n      resolve(res)\n    })\n  }\n\n  //  h5 - 临时token 获取\n  getH5TemporaryToken(data) {\n    return new Promise(async (resolve, reject) => {\n      const companyData = await getCompany({\n        // domain: location.domain,\n      })\n      const { data } = companyData\n      let resultData = {}\n      let params = data?.data?.company_id ? { company_id: data?.data?.company_id } : {}\n      const res = await getTokenNoLogin(params)\n      if (res.code != 200) {\n        reject(res)\n      }\n      resolve(res.data)\n    })\n  }\n  // 小程序 - 临时token 获取\n  getWxTemporaryToken() {\n    return new Promise(async (resolve, reject) => {\n      let wxCode = await this.getWxCode()\n      let params = {\n        code: wxCode,\n      }\n      let res = await miniLogin(params)\n      if (res.code != 200) {\n        uni.showToast({\n          title: res.message,\n          icon: 'none',\n          duration: 2000,\n        })\n        reject(res)\n      }\n      resolve(res.data)\n    })\n  }\n\n  // 获取微信code\n  getWxCode() {\n    return new Promise((resolve, reject) => {\n      uni.login({\n        provider: 'weixin',\n        success(res) {\n          resolve(res.code)\n        },\n        fail() {\n          reject('faily get wxcode')\n        },\n      })\n    })\n  }\n}\n\nexport { UserLoginClass }\n"],"names":["getCompany","data","getTokenNoLogin","miniLogin","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AASA,MAAM,eAAe;AAAA,EACnB,YAAY,YAAY;AAAA,EAAA;AAAA,EAExB,oBAAoB;AAClB,WAAO,IAAI,QAAQ,CAAO,SAAS,WAAW;AAC5C,UAAI,MAAM,CAAA;AAG0B;AAClC,cAAM,MAAM,KAAK,oBAAmB;AAAA,MAC5C;AACM,cAAQ,GAAG;AAAA,IACZ,EAAA;AAAA,EACL;AAAA;AAAA,EAGE,oBAAoB,MAAM;AACxB,WAAO,IAAI,QAAQ,CAAO,SAAS,WAAW;;AAC5C,YAAM,cAAc,MAAMA,2BAAW;AAAA;AAAA,MAEpC,CAAA;AACD,YAAM,EAAE,MAAAC,MAAI,IAAK;AAEjB,UAAI,WAAS,KAAAA,SAAA,gBAAAA,MAAM,SAAN,mBAAY,cAAa,EAAE,aAAY,KAAAA,SAAA,gBAAAA,MAAM,SAAN,mBAAY,eAAe,CAAA;AAC/E,YAAM,MAAM,MAAMC,gBAAAA,gBAAgB,MAAM;AACxC,UAAI,IAAI,QAAQ,KAAK;AACnB,eAAO,GAAG;AAAA,MAClB;AACM,cAAQ,IAAI,IAAI;AAAA,IACjB,EAAA;AAAA,EACL;AAAA;AAAA,EAEE,sBAAsB;AACpB,WAAO,IAAI,QAAQ,CAAO,SAAS,WAAW;AAC5C,UAAI,SAAS,MAAM,KAAK,UAAS;AACjC,UAAI,SAAS;AAAA,QACX,MAAM;AAAA,MACd;AACM,UAAI,MAAM,MAAMC,gBAAAA,UAAU,MAAM;AAChC,UAAI,IAAI,QAAQ,KAAK;AACnBC,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO,IAAI;AAAA,UACX,MAAM;AAAA,UACN,UAAU;AAAA,QACX,CAAA;AACD,eAAO,GAAG;AAAA,MAClB;AACM,cAAQ,IAAI,IAAI;AAAA,IACjB,EAAA;AAAA,EACL;AAAA;AAAA,EAGE,YAAY;AACV,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtCA,oBAAAA,MAAI,MAAM;AAAA,QACR,UAAU;AAAA,QACV,QAAQ,KAAK;AACX,kBAAQ,IAAI,IAAI;AAAA,QACjB;AAAA,QACD,OAAO;AACL,iBAAO,kBAAkB;AAAA,QAC1B;AAAA,MACF,CAAA;AAAA,IACF,CAAA;AAAA,EACL;AACA;;"}