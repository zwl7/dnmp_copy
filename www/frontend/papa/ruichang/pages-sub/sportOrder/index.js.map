{"version":3,"file":"index.js","sources":["../../../../../src/pages-sub/sportOrder/index.vue","../../../../../uniPage:/cGFnZXMtc3ViL3Nwb3J0T3JkZXIvaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"sport-order\">\n    <navBar\n      :navColor=\"'transparent'\"\n      title=\"\"\n      titleColor=\"#323233\"\n      backColor=\"#323233\"\n      :showBack=\"true\"\n    ></navBar>\n    <!-- 顶部渐变背景+标题+背景图 -->\n    <view class=\"order-header\">\n      <view class=\"header-content\">\n        <view class=\"header-title\">服务点单</view>\n        <view class=\"header-desc\">轻松享健身服务</view>\n      </view>\n    </view>\n    <!-- 滑动tab栏 -->\n    <scroll-view scroll-x class=\"tab-bar-scroll\">\n      <view class=\"tab-bar\">\n        <view\n          v-for=\"(tab, index) in tabs\"\n          :key=\"index\"\n          class=\"btn-black\"\n          :class=\"{ active: currentTab === index }\"\n          @click=\"handleTabChange(tab, index)\"\n        >\n          {{ tab.label }}\n        </view>\n      </view>\n    </scroll-view>\n    <!-- 订单列表 -->\n    <view class=\"order-list\">\n      <order-item\n        v-for=\"(item, index) in list\"\n        :key=\"index\"\n        :item=\"item\"\n        :showApplyBtn=\"currentTab === 0\"\n        @apply=\"handleApply\"\n        @view=\"handleView(item)\"\n      />\n      <empty v-if=\"showEmpty\"></empty>\n      <!-- <div class=\"test\">\n      </div> -->\n      <loadMore :status=\"loadStatus\" v-if=\"showLoadMore\" />\n    </view>\n    <!-- 右下角fixed按钮      :style=\"boxStyle\"-->\n    <image\n      src=\"https://cdn-static.papa.com.cn/social/sportsService/addBtn.png\"\n      :style=\"boxStyle\"\n      class=\"fixed-add-btn\"\n      @click=\"handleSubmit\"\n      @touchstart=\"startDrag\"\n      @touchmove.stop=\"onDrag\"\n      @touchend=\"endDrag\"\n      @mousedown=\"startDrag\"\n      @mousemove.stop=\"onDrag\"\n      @mouseup=\"endDrag\"\n    />\n  </view>\n</template>\n\n<script>\nimport OrderItem from './components/OrderItem.vue'\nimport listMixins from '@/mixins/listMixins.js'\nimport { getMyOrderList } from '@/apis/sportsService/serviceOrder'\nimport { useUserStore } from '@/store/user'\nexport default {\n  mixins: [listMixins],\n  components: {\n    OrderItem,\n  },\n\n  data() {\n    return {\n      tabs: [\n        { name: '全部', value: 'all' },\n        { name: '待评价', value: 'pending' },\n        { name: '待派单', value: 'dispatch' },\n        { name: '待服务', value: 'service' },\n      ],\n      currentTab: 0,\n      list: [],\n      page: 1,\n      pageSize: 10,\n      loadMoreStatus: 'loadmore',\n      isRefreshing: false,\n      // 模拟数据\n      mockOrders: [\n        {\n          id: 1,\n          categoryName: '科学健身指导',\n          title: '南门社区广场舞指导',\n          location: '南门社区广场',\n          serviceTime: '2025/08/26 12:00:00',\n          createTime: '2025/08/26 12:00',\n          status: '1',\n        },\n        {\n          id: 2,\n          categoryName: '科学健身指导',\n          title: '南门社区广场舞指导',\n          location: '南门社区广场',\n          serviceTime: '2025/08/26 12:00:00',\n          createTime: '2025/08/26 12:00',\n          status: '2',\n        },\n      ],\n      serveWorkStatStatus: '',\n      isDragging: false,\n      startX: 0,\n      startY: 0,\n      boxX: 0,\n      boxY: 0,\n      windowWidth: 375, // 默认值，需在mounted中更新\n      windowHeight: 667,\n    }\n  },\n\n  onLoad() {\n    // 加载枚举\n    const data =\n      JSON.parse(JSON.stringify(useUserStore().getEnumListByKey('serveWorkStatStatus'))) || []\n    console.log({ data })\n    data.unshift({ label: '全部', value: '' })\n    this.tabs = data\n  },\n  onShow() {\n    this.resetData()\n  },\n  mounted() {\n    // 获取屏幕尺寸\n    const systemInfo = uni.getSystemInfoSync()\n    console.log({ systemInfo })\n\n    this.windowWidth = systemInfo.windowWidth\n    this.windowHeight = systemInfo.windowHeight\n\n    // 初始化位置\n    this.initPosition()\n  },\n  computed: {\n    boxStyle() {\n      return {\n        left: `${this.boxX}px`,\n        top: `${this.boxY}px`,\n        position: 'fixed',\n        transform: this.isDragging ? 'none' : 'translateY(-50%)',\n      }\n    },\n  },\n  methods: {\n    // 获取订单列表\n    async getList(refresh = false) {\n      let param = {\n        page: this.page,\n        size: 10,\n        serveWorkStatStatus: this.serveWorkStatStatus,\n      }\n\n      // 模拟接口请求\n      // await new Promise((resolve) => setTimeout(resolve, 500))\n      const res = await getMyOrderList(param)\n      this.getListExtend(res, refresh)\n      // this.list = list\n    },\n\n    // 切换标签\n    handleTabChange(item, index) {\n      if (this.currentTab === index) return\n      this.currentTab = index\n      this.serveWorkStatStatus = item.value\n      this.resetData()\n    },\n    // 申请服务\n    handleApply(item) {\n      uni.navigateTo({\n        url: `/pagesSub/sportsService/sprotOrder/form?id=${item.id}`,\n      })\n    },\n\n    // 查看详情\n    handleView(item) {\n      uni.navigateTo({\n        url: `/pagesSub/sportsService/sprotOrder/detail?id=${item.serveWorkId}`,\n      })\n    },\n\n    // 发布服务\n    handleSubmit() {\n      uni.navigateTo({\n        url: '/pagesSub/sportsService/sprotOrder/form',\n      })\n    },\n    initPosition() {\n      // 初始右侧居中位置\n      this.boxX = this.windowWidth - 100 // 假设元素宽度100px\n      this.boxY = this.windowHeight - 360 // 假设元素高度100px\n    },\n\n    startDrag(e) {\n      const touch = e.touches ? e.touches[0] : e\n      this.isDragging = true\n      console.log({ touch })\n\n      // 记录初始触摸点与元素位置的偏移this.boxX\n      this.startX = touch.clientX - this.boxX\n      this.startY = touch.clientY - this.boxY\n    },\n\n    onDrag(e) {\n      if (!this.isDragging) return\n      // console.log({e});\n\n      e.preventDefault()\n      e.stopPropagation()\n      const touch = e.touches ? e.touches[0] : e\n\n      // 计算新位置\n      let newX = touch.clientX - this.startX\n      let newY = touch.clientY - this.startY\n\n      // 边界检查\n      const maxX = this.windowWidth - 100 // 元素宽度\n      const maxY = this.windowHeight - 100 // 元素高度\n\n      this.boxX = Math.max(0, Math.min(newX, maxX))\n      this.boxY = Math.max(0, Math.min(newY, maxY))\n\n      // 阻止滚动（小程序需要）\n      e.preventDefault()\n    },\n\n    endDrag() {\n      this.isDragging = false\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.sport-order {\n  min-height: 100vh;\n  background: #f5f5f5;\n  position: relative;\n\n  .order-header {\n    width: 100vw;\n    height: 448rpx;\n    background: url('https://cdn-static.papa.com.cn/social/sportsService/topBannerThree.png');\n    background-size: cover;\n    position: relative;\n    margin-bottom: 20rpx;\n\n    .header-content {\n      position: absolute;\n      top: 174rpx;\n      z-index: 2;\n      padding-left: 40rpx;\n\n      .header-title {\n        font-size: 70rpx;\n        font-weight: 400;\n        color: rgba(48, 49, 51, 1);\n        line-height: 90rpx;\n        margin-bottom: 24rpx;\n      }\n\n      .header-desc {\n        font-size: 32rpx;\n        color: rgba(48, 49, 51, 1);\n        background: linear-gradient(90deg, rgba(140, 244, 188, 1) 0%, rgba(225, 255, 122, 1) 100%);\n        display: inline-block;\n        border-radius: 26rpx;\n        padding: 0 24rpx;\n        line-height: 56rpx;\n      }\n    }\n  }\n\n  .tab-bar-scroll {\n    width: 100vw;\n    background: transparent;\n    margin-top: -32rpx;\n    // margin-bottom: 36rpx;\n  }\n\n  .tab-bar {\n    display: flex;\n    gap: 16rpx;\n    // background: #fff;\n    border-radius: 40rpx;\n    box-shadow: 0 2rpx 8rpx #eaf9d6;\n    // padding: 8rpx 12rpx;\n    margin-left: 24rpx;\n    overflow-x: auto;\n\n    .btn-black {\n      min-width: 160rpx;\n      background: #fff;\n      padding: 0 36rpx;\n      height: 56rpx;\n\n      &.active {\n        background: #303133;\n      }\n    }\n\n    .btn-black1 {\n      min-width: 120rpx;\n      padding: 12rpx 0;\n      margin: 0 12rpx;\n      font-size: 28rpx;\n      color: #888;\n      text-align: center;\n      border-radius: 32rpx;\n      background: transparent;\n      transition: all 0.2s;\n    }\n  }\n\n  .order-list {\n    box-sizing: border-box;\n    padding: 36rpx 32rpx 24rpx;\n    background: transparent;\n  }\n\n  .fixed-add-btn {\n    position: fixed;\n    right: 0;\n    top: 720rpx;\n    width: 200rpx;\n    height: 208rpx;\n    z-index: 99;\n  }\n}\n.test {\n  height: 200vh;\n  background-color: red;\n  width: 100vw;\n}\n</style>\n","import MiniProgramPage from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pages-sub/sportOrder/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["listMixins","useUserStore","uni","getMyOrderList"],"mappings":"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"}