{"version":3,"file":"orderDetail.js","sources":["../../../../../../src/pages-sub/sportOrder/components/orderDetail.vue","../../../../../../uniComponent:/L1VzZXJzL2d1b3hpYW9taW5nL2NvZGUvcGFwYS1jb2RlL3BtLXluL3VuaWFwcC1zb2NpYWwtc3BvcnRzLW5ldy9zcmMvcGFnZXMtc3ViL3Nwb3J0T3JkZXIvY29tcG9uZW50cy9vcmRlckRldGFpbC52dWU"],"sourcesContent":["<template>\n  <view class=\"order-detail\">\n    <!-- 时间盒子 -->\n    <view class=\"serviceTimeBox\" v-if=\"['rating_wait', 'completed'].includes(status)\">\n      <view class=\"formItem\" v-if=\"status === 'rating_wait'\" style=\"\">\n        <view class=\"label\">服务时间</view>\n        <view class=\"content\">\n          <view style=\"display: flex; justify-content: space-between\">\n            <view class=\"time\">\n              {{ order.serveStartDate }}\n              <br />\n              <view>{{ order.serveEndDate }}</view>\n            </view>\n            <view v-if=\"isOrderMan\" @click=\"routeToStyleDetail\" class=\"evaluteBtn btn-black active\">\n              评价\n            </view>\n          </view>\n        </view>\n      </view>\n      <view class=\"formItem\" v-if=\"status === 'completed'\" style=\"align-items: center\">\n        <view class=\"label\">评价时间</view>\n        <view class=\"content\">\n          <view style=\"display: flex; justify-content: space-between; align-items: center\">\n            {{ order.ratingTime }}\n            <view @click=\"routeToStyleDetail\" class=\"evaluteBtn btn-black active\">看评价</view>\n          </view>\n        </view>\n      </view>\n    </view>\n    <view class=\"assignBox greenBox\" v-if=\"formList.length\">\n      <view class=\"formItem\" v-for=\"(item, index) in formList\" :key=\"index + 'formItem'\">\n        <view class=\"label\">{{ item.label }}</view>\n        <view class=\"content\">{{ item.value }}</view>\n      </view>\n    </view>\n    <!-- 顶部活动信息 -->\n    <serviceDetailTitle :item=\"order\"></serviceDetailTitle>\n    <!-- 组织待接单 -->\n    <!-- 点单人信息 -->\n    <view class=\"card\" v-if=\"isShowBase\">\n      <view class=\"cardItem\">\n        <view class=\"card-title\">点单人信息</view>\n        <view class=\"card-content\">\n          <view class=\"formItem\">\n            <view class=\"label\">联系人</view>\n            <view class=\"content\">{{ order.creatorName }}</view>\n          </view>\n          <view class=\"formItem\">\n            <view class=\"label\">手机号</view>\n            <view class=\"content\">{{ order.createPhone }}</view>\n          </view>\n        </view>\n      </view>\n      <view class=\"cardItem\">\n        <view class=\"card-title\">需求详情</view>\n        <view class=\"card-content\">\n          <view class=\"formItem\">参加活动人数：{{ order.peopleNum }}人</view>\n          <view class=\"formItem\">详情：{{ order.demandDescription }}</view>\n        </view>\n      </view>\n    </view>\n    <!-- 游客查看评价 -->\n    <!-- <visitor-view-comment-popup\n      ref=\"visitorViewCommentPopup\"\n      :initStart=\"order.rating\"\n      :evaluteMode=\"evaluteMode\"\n      @submit=\"handleCommentSubmit\"\n    /> -->\n  </view>\n</template>\n\n<script>\nimport serviceDetailTitle from './serviceDetailTitle.vue'\n// import VisitorViewCommentPopup from '@/pages/tabbar/newHome/components/ServiceStyleItem/components/VisitorViewCommentPopup.vue'\nimport { getOrderInfo } from '@/apis/sportsService/serviceOrder'\nimport orderDetail from './orderDetail.vue'\nimport { getStyleDetail, addAppraise } from '@/apis/sportsService/serviceStyle'\nimport { useAppStore } from '@/store/app'\nexport default {\n  components: {\n    serviceDetailTitle,\n    // VisitorViewCommentPopup,\n  },\n  props: {\n    order: {\n      type: Object,\n      default: () => {},\n    },\n    isShowBase: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  data() {\n    return {\n      status: 'wait', // wait:待派，service:待服务，comment:待评价，reject:已拒单，finish:已完成\n      formList: [],\n      waitMap: {\n        platformOpTime: {\n          label: '派单时间',\n          value: '2025/10/18 12:00:00',\n        },\n        organizationIdCn: {\n          label: '接单组织',\n          value: '靖安县广场舞协会',\n        },\n        organizationMemberIdName: {\n          label: '联系人',\n          value: '芒果',\n        },\n        orgPhone: {\n          label: '手机号码',\n          value: '17417513326',\n        },\n      },\n      reasonMap: {\n        platformOpTime: {\n          label: '时间',\n          value: '南门社区广场',\n        },\n        rejectReason: {\n          label: '原因',\n          value: '需求不明确，目前没有匹配人员和资源，请重新描述',\n        },\n      },\n      // 组织待接单\n      orgWaitMap: {\n        platformOpTime: {\n          label: '派单时间',\n          value: '2025/10/18 12:00:00',\n        },\n        organizationIdCn: {\n          label: '接单组织',\n          value: '靖安县广场舞协会',\n        },\n      },\n      evaluteMode: 'view',\n      appStore: null,\n    }\n  },\n  computed: {\n    // 判断是否点单人\n    isOrderMan() {\n      console.log({ userInfo: this.appStore.userInfo, order: this.order })\n\n      return this.appStore.userInfo.account_id === this.order.creatorId\n    },\n  },\n  onLoad(options) {},\n  mounted() {\n    this.appStore = useAppStore()\n    // uni.setNavigationBarTitle({ title: '已完成' })\n    // 获取路由参数\n  },\n  watch: {\n    order: {\n      handler(val) {\n        this.formatFormList(val.serveWorkDevStatus)\n      },\n    },\n  },\n  methods: {\n    // 根据状态组装表单展示\n    formatFormList(serveWorkDevStatus) {\n      this.status = serveWorkDevStatus\n      this.formList = []\n      switch (serveWorkDevStatus) {\n        // 待服务\n        case 'serve_wait' || 'rating_wait':\n          Object.keys(this.waitMap).forEach((key) => {\n            const item = this.waitMap[key]\n            item.value = this.order[key]\n            this.formList.push(item)\n          })\n          break\n        // 组织待接单\n        case 'org_wait':\n          Object.keys(this.orgWaitMap).forEach((key) => {\n            const item = this.orgWaitMap[key]\n            item.value = this.order[key]\n            this.formList.push(item)\n          })\n          break\n        // 不通过\n        case 'no_pass':\n          Object.keys(this.reasonMap).forEach((key) => {\n            const item = this.reasonMap[key]\n            item.value = this.order[key]\n            this.formList.push(item)\n          })\n          break\n        // 已完成\n        case 'completed':\n          Object.keys(this.waitMap).forEach((key) => {\n            const item = this.waitMap[key]\n            item.value = this.order[key]\n            this.formList.push(item)\n          })\n          // 再添加一个服务时间\n          this.formList.push({\n            label: '服务时间',\n            value: `${this.order.serveStartDate}至${this.order.serveEndDate}`,\n          })\n          break\n        // case 'order_accept':\n        //   this.formList =\n      }\n    },\n    // 评价函数\n    async handleCommentSubmit(value) {\n      const res = await addAppraise({\n        serveWorkId: this.order.serveWorkId,\n        rating: value,\n      })\n      if (res.code === 0) {\n        uni.showToast({\n          title: '评价成功',\n          icon: 'success',\n        })\n        this.$refs.visitorViewCommentPopup.close()\n        this.$emit('reload')\n      }\n    },\n    // 前往目标风采详情页面\n    routeToStyleDetail() {\n      uni.navigateTo({\n        url: `/pagesSub/sportsService/serviceStyle/detail?id=${this.order.serveMienId}`,\n      })\n    },\n    viewStyle() {\n      uni.navigateTo({ url: '/pagesSub/sportsService/serviceStyle/detail?id=1' })\n    },\n    commentOrder() {\n      uni.navigateTo({ url: '/pagesSub/sportsService/serviceComment/index?orderId=1' })\n    },\n    retryOrder() {\n      uni.navigateTo({ url: '/pagesSub/sportsService/sprotOrder/form?orderId=1' })\n    },\n    // 打开我的评价\n    handleViewMyComment() {\n      console.log('打开我的评价', this.$refs.visitorViewCommentPopup)\n      this.evaluteMode = 'edit'\n      this.$refs.visitorViewCommentPopup.open()\n    },\n    // 前往评价页面\n    toEvaluePage() {},\n    // 重新提交\n    reSubmit() {},\n    // 查看评价\n    checkEvalue() {\n      this.evaluteMode = 'view'\n      this.$refs.visitorViewCommentPopup.open()\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n$grayColor: rgba(96, 98, 102, 1);\n\n.order-detail {\n  // min-height: 100vh;\n  // height: 100%;\n  padding: 24rpx 32rpx;\n  background: #f5f7fa;\n\n  .serviceTimeBox {\n    background: #c5f730;\n    border-radius: 24rpx;\n    margin-bottom: -30rpx;\n    height: 140rpx;\n\n    .btn-black {\n      padding: 6rpx 30rpx;\n      height: 56rpx;\n      width: 150rpx;\n    }\n    .time {\n      width: 285rpx;\n      font-size: 28rpx;\n\n      // 允许文字换行\n      word-break: break-all;\n    }\n  }\n\n  .assignBox {\n    margin-bottom: 32rpx;\n  }\n\n  .greenBox {\n    padding: 0;\n  }\n\n  .card {\n    // padding: 28rpx 24rpx;\n    margin-top: 24rpx;\n    background: #fff;\n    border-radius: 24rpx;\n\n    .cardItem {\n      margin-bottom: 20rpx;\n\n      .card-title {\n        margin-bottom: 16rpx;\n        font-size: 32rpx;\n        font-weight: 500;\n        padding: 28rpx 24rpx;\n      }\n\n      .card-content {\n        font-size: 28rpx;\n      }\n    }\n\n    // box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);\n  }\n\n  .formItem {\n    display: flex;\n    padding: 24rpx;\n\n    // gap: 40rpx;\n    color: rgba(96, 98, 102, 1);\n\n    .label {\n      width: 160rpx;\n      font-size: 28rpx;\n      line-height: 44rpx;\n    }\n\n    .content {\n      color: #303133;\n      flex: 1;\n      flex-wrap: wrap;\n    }\n  }\n}\n</style>\n","import Component from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pages-sub/sportOrder/components/orderDetail.vue'\nwx.createComponent(Component)"],"names":["useAppStore","addAppraise","uni"],"mappings":"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"}