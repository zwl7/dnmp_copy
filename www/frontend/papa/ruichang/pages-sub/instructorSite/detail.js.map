{"version":3,"file":"detail.js","sources":["../../../../../src/pages-sub/instructorSite/detail.vue","../../../../../uniPage:/cGFnZXMtc3ViL2luc3RydWN0b3JTaXRlL2RldGFpbC52dWU"],"sourcesContent":["<template>\n  <view class=\"fit-site-detail-container\">\n    <navBar\n      :navColor=\"navColor\"\n      title=\"站点详情\"\n      titleColor=\"#323233\"\n      backColor=\"#323233\"\n      :showBack=\"true\"\n    ></navBar>\n    <view class=\"fit-site-header\">\n      <swiper class=\"swiper-box\" :circular=\"true\" :autoplay=\"true\">\n        <swiper-item v-for=\"(item, index) in info.images_array\" :key=\"index\">\n          <view class=\"swiper-item\">\n            <image :src=\"item\" mode=\"aspectFill\" />\n          </view>\n        </swiper-item>\n      </swiper>\n      <view class=\"bottom-radius\">\n        <view class=\"bottom-radius-main\"></view>\n      </view>\n    </view>\n    <view class=\"main-content-container\">\n      <view class=\"fit-site-content\">\n        <view class=\"detail-title-wrap\">\n          <view class=\"detail-title\">{{ info.name }}</view>\n          <image\n            class=\"collect-icon\"\n            :src=\"isCollect ? '/static/images/star-fill.png' : '/static/images/star.png'\"\n            @click=\"handleCollect\"\n          />\n        </view>\n\n        <view class=\"detail-row\" v-if=\"info.tag_ids_arr.length\">\n          <view class=\"sport_item\" v-for=\"(sport_item, sindex) in info.tag_ids_arr\" :key=\"sindex\">\n            {{ sport_item.tag_id_str }}\n          </view>\n        </view>\n        <view class=\"detail-status\" v-if=\"info.typeStr\">\n          <text v-for=\"(item, index) in info.typeStr\" :key=\"index\" class=\"status-type\">\n            {{ item }}\n          </text>\n        </view>\n        <view class=\"detail-des\">\n          <view class=\"des-contact\">\n            <text class=\"d-name\">站点编号</text>\n            <text>{{ info.no }}</text>\n          </view>\n          <view class=\"des-contact\">\n            <text class=\"d-name\">服务时间</text>\n            <text>{{ info.service_time }}</text>\n          </view>\n          <view class=\"des-contact\">\n            <text class=\"d-name\">负责人</text>\n            <text>{{ info.charge_person }}</text>\n          </view>\n        </view>\n        <phoneAddressService :info=\"info\" />\n      </view>\n      <view class=\"fit-site-tab-content\">\n        <uv-tabs\n          :customStyle=\"{\n            backgroundColor: '#fff',\n          }\"\n          :list=\"tab_list\"\n          :scrollable=\"true\"\n          lineColor=\"#0078D0\"\n          lineWidth=\"40\"\n          :activeStyle=\"{\n            color: 'rgba(50, 50, 51, 1)',\n            fontWeight: '610',\n          }\"\n          :inactiveStyle=\"{\n            color: 'rgba(150, 151, 153, 1)',\n            fontWeight: '400',\n          }\"\n          :current=\"currentTab\"\n          @change=\"changeTab\"\n        ></uv-tabs>\n        <view class=\"content-card\">\n          <view v-if=\"currentTab === 0\" class=\"des-content\">\n            <view class=\"des-content-title\">详细介绍</view>\n            <rich-text :nodes=\"info.des\"></rich-text>\n          </view>\n          <view v-if=\"currentTab === 1\" class=\"instructor-content\">\n            <site-instructors :siteId=\"instructor_site_id\" />\n          </view>\n          <view v-if=\"currentTab === 2\" class=\"activity-content\">\n            <site-activities :siteId=\"instructor_site_id\" ref=\"siteActivitiesRef\" />\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport phoneAddressService from '@/components/phoneAddressService/index.vue'\nimport bottomButton from '@/components/bottomButton.vue'\nimport navBar from '@/components/navBar/index.vue'\nimport { formatRichText } from '@/utils/index'\nimport SiteInstructors from './components/SiteInstructors.vue'\nimport SiteActivities from './components/SiteActivities.vue'\nimport { debounce, throttle } from '@/utils/buttonClick'\n\nexport default {\n  components: {\n    bottomButton,\n    navBar,\n    phoneAddressService,\n    SiteInstructors,\n    SiteActivities,\n  },\n  data() {\n    return {\n      navColor: 'transparent',\n      primaryColor: '#C0C4CC',\n      instructor_site_id: '',\n      info: {\n        tag_ids_arr: [],\n      },\n      form: {},\n      showMore: false,\n      avatarInfo: {},\n      timeData: {},\n      recommendList: [],\n      isCollect: 0, // 0 未收藏 1 已收藏\n      shareTimelineObj: {\n        title: '',\n      },\n      tab_list: [\n        { name: '详细介绍', id: '1' },\n        { name: '站点指导员', id: '2' },\n        { name: '站点活动', id: '3' },\n      ],\n      project: [],\n      traffic: '',\n      currentTab: 0,\n    }\n  },\n  computed: {},\n  onShow() {},\n  async onLoad(options) {\n    const app = getApp()\n    console.log('app', app)\n    if (options.instructor_site_id) {\n      let form = {\n        instructor_site_id: options.instructor_site_id,\n      }\n      this.instructor_site_id = options.instructor_site_id\n      this.form = { ...form }\n      await this.getDetail()\n      this.share = {\n        title: this.info.name,\n        path: '/pages-sub/instructorSite/detail?instructor_site_id=' + options.instructor_site_id,\n        withShareTicket: true,\n      }\n    }\n  },\n  onShareTimeline() {\n    return {\n      title: this.shareTimelineObj.title,\n    }\n  },\n  onReachBottom() {\n    console.log('触底了')\n    if (this.currentTab == 2) {\n      this.$refs.siteActivitiesRef.loadMore()\n    }\n  },\n  onPageScroll: throttle(function (e) {\n    let scrollTop = e[0].scrollTop\n    if (scrollTop > 60) {\n      this.navColor = '#fff'\n    } else {\n      this.navColor = 'transparent'\n    }\n  }, 100),\n  methods: {\n    changeTab(e) {\n      this.currentTab = e.index\n    },\n    onChange(e) {\n      this.timeData = e\n    },\n\n    async getDetail() {\n      let res = await this.$api.getInstructorSiteDetail({\n        instructor_site_id: this.instructor_site_id,\n      })\n      let { data, code } = res\n      if (code == 200) {\n        data.des = formatRichText(data.des, '暂无内容')\n        this.isCollect = data.is_love ? true : false\n        this.shareTimelineObj.title = data.name\n        if (data.images_array.length == 0) {\n          data.images_array = ['https://cdn-static.papa.com.cn/social/site-default.png']\n        }\n        this.info = data\n      }\n    },\n    handleCollect: debounce(async function () {\n      try {\n        let flag = await getApp().judgeIsAuth()\n        if (!flag) {\n          return\n        }\n        const res = await this.$api.instructorSiteBehavior({\n          instructor_site_id: this.instructor_site_id,\n          cancel: this.isCollect ? 2 : 1,\n        })\n        if (res.code === 200) {\n          this.isCollect = !this.isCollect\n          uni.showToast({\n            title: this.isCollect ? '收藏成功' : '已取消收藏',\n            icon: 'none',\n          })\n        }\n      } catch (error) {\n        console.error('收藏操作失败:', error)\n      }\n    }, 500),\n  },\n}\n</script>\n<style lang=\"scss\" scoped>\n.fit-site-detail-container {\n  padding-bottom: 100rpx;\n  background-color: $hubei-primary-bg-grey;\n  .fit-site-header {\n    height: 500rpx;\n    .swiper-box {\n      height: 500rpx;\n    }\n    image {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n    .swiper-item {\n      position: relative;\n      height: 100%;\n\n      img,\n      image {\n        position: absolute;\n        inset: 0;\n        width: 100%;\n        height: 100%;\n        // object-fit: cover;\n      }\n    }\n  }\n\n  .bottom-radius {\n    padding: 0 16rpx;\n    position: absolute;\n    box-sizing: border-box;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n    .bottom-radius-main {\n      width: 100%;\n      height: 32rpx;\n      border-radius: 32rpx 32rpx 0 0;\n      box-sizing: border-box;\n      background-color: #fff;\n    }\n  }\n  .main-content-container {\n    position: relative;\n    box-sizing: border-box;\n    min-height: calc(100vh - 632rpx);\n    background: $hubei-primary-bg-grey;\n  }\n  .fit-site-content {\n    margin: 0 16rpx;\n    padding: 32rpx;\n    background: #fff;\n    border-radius: 24rpx;\n    transform: translateY(-32rpx);\n\n    .detail-title-wrap {\n      display: flex;\n      align-items: flex-start;\n      justify-content: space-between;\n      margin-bottom: 26rpx;\n\n      .detail-title {\n        margin-bottom: 0;\n        font-size: 34rpx;\n        font-weight: 600;\n      }\n\n      .collect-icon {\n        width: 44rpx;\n        height: 44rpx;\n      }\n    }\n    .detail-row {\n      margin-bottom: 8rpx;\n      display: flex;\n      overflow: auto;\n      padding: 10rpx 0rpx;\n      .sport_item {\n        box-sizing: border-box;\n        flex-shrink: 0;\n        width: fit-content;\n        max-width: 100%;\n        height: 40rpx;\n        line-height: 36rpx;\n        border-radius: 4rpx;\n        margin-right: 10rpx;\n        background: $hubei-primary-light;\n        border: 1px solid $hubei-border-color-light;\n        font-size: 24rpx;\n        color: $hubei-primary;\n        letter-spacing: 0;\n        text-align: center;\n        font-weight: 500;\n        padding: 0 20rpx;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n      }\n    }\n    .detail-status {\n      // padding: 24rpx 0;\n      font-size: 24rpx;\n\n      .status-text {\n        display: inline-block;\n        margin-bottom: 5rpx;\n        width: fit-content;\n        min-height: 30rpx;\n        padding: 4rpx 8rpx;\n        margin-right: 15rpx;\n        color: #fff;\n        background-color: #4cd964;\n\n        &.warning {\n          background-color: #f0ad4e;\n        }\n\n        &.error {\n          background-color: #dd524d;\n        }\n      }\n\n      .status-type {\n        display: inline-block;\n        margin-bottom: 5rpx;\n        width: fit-content;\n        margin-right: 5rpx;\n        padding: 4rpx 20rpx;\n        color: $hubei-primary;\n        background: $hubei-primary-light;\n        border: 1px solid $hubei-primary-light;\n      }\n    }\n\n    .detail-des {\n      margin-bottom: 40rpx;\n      padding: 24rpx;\n      display: flex;\n      flex-direction: column;\n      font-size: 24rpx;\n      color: #606266;\n      border-radius: 12rpx;\n      background: #f6faff;\n\n      .des-item {\n        display: flex;\n        justify-content: flex-start;\n        align-items: flex-start;\n\n        .left {\n          flex-shrink: 0;\n          display: flex;\n          align-items: center;\n        }\n        .d-name {\n          flex-shrink: 0;\n          width: 96rpx;\n          height: 40rpx;\n          line-height: 40rpx;\n          color: #303133;\n          font-weight: 500;\n          text-align: right;\n        }\n        .d-time {\n          margin-left: 24rpx;\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n          color: #505f79;\n          &.limit {\n            max-height: 156rpx;\n          }\n          text {\n            margin-bottom: 18rpx;\n            height: 40rpx;\n            line-height: 40rpx;\n            &:last-child {\n              margin-bottom: 0;\n            }\n          }\n        }\n        .more {\n          margin-left: 130rpx;\n          height: 40rpx;\n          line-height: 40rpx;\n          color: #505f79;\n        }\n      }\n    }\n\n    .des-contact {\n      &:not(:first-child) {\n        margin-top: 24rpx;\n      }\n      .d-name {\n        margin-right: 24rpx;\n        display: inline-block;\n        width: 96rpx;\n      }\n    }\n  }\n\n  .card-container {\n    padding: 0 32rpx;\n    box-sizing: border-box;\n    .card-box {\n      border-radius: 12px;\n      padding: 36rpx 24rpx;\n      background: linear-gradient(180deg, #ffe4d1 0%, #ffffff 50%);\n      box-shadow: 0px 2px 10px #ffe4d1;\n\n      .top-box {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n      }\n      .left {\n        flex-shrink: 0;\n        display: flex;\n        align-items: center;\n        .icon {\n          display: block;\n          width: 48rpx;\n          height: 48rpx;\n        }\n        .title {\n          font-size: 28rpx;\n          font-weight: 500;\n          line-height: 40rpx;\n          color: #323233;\n          margin-left: 16rpx;\n        }\n      }\n      .apply-count {\n        display: flex;\n        align-items: center;\n        font-size: 24rpx;\n        color: #909399;\n\n        .img-wrap {\n          margin-left: 16rpx;\n          margin-right: 5rpx;\n          padding-right: 8rpx;\n          img,\n          image {\n            margin-right: -18rpx;\n            width: 56rpx;\n            height: 56rpx;\n            border-radius: 50%;\n            border: 2rpx solid #fff;\n            box-sizing: border-box;\n          }\n        }\n      }\n    }\n  }\n\n  .fit-site-tab-content {\n    margin: 16rpx 16rpx 0;\n    padding: 16rpx 0rpx 200rpx;\n    position: relative;\n    border-radius: 24rpx;\n    background: #fff;\n  }\n}\n\n.des-content {\n  font-size: 28rpx;\n  color: #606266;\n  letter-spacing: 0;\n  line-height: 48rpx;\n  white-space: normal !important;\n  max-width: 100% !important;\n  padding: 0 22rpx;\n  box-sizing: border-box;\n}\n.des-content-title {\n  font-size: 30rpx;\n  color: $hubei-text-color-primary;\n  font-weight: 600;\n  line-height: 48rpx;\n  margin: 24rpx 0;\n}\n</style>\n","import MiniProgramPage from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pages-sub/instructorSite/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["throttle","formatRichText","debounce","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA,MAAA,sBAAA,MAAA;AACA,MAAA,eAAA,MAAA;AACA,MAAA,SAAA,MAAA;AAEA,MAAA,kBAAA,MAAA;AACA,MAAA,iBAAA,MAAA;AAGA,MAAA,YAAA;AAAA;;IAGA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;EAEA,OAAA;AACA,WAAA;AAAA;;MAGA,oBAAA;AAAA;QAEA,aAAA,CAAA;AAAA;MAEA,MAAA,CAAA;AAAA,MACA,UAAA;AAAA;;MAGA,eAAA,CAAA;AAAA,MACA,WAAA;AAAA;AAAA,MACA,kBAAA;AAAA,QACA,OAAA;AAAA;MAEA,UAAA;AAAA,QACA,EAAA,MAAA,QAAA,IAAA,IAAA;AAAA,QACA,EAAA,MAAA,SAAA,IAAA,IAAA;AAAA,QACA,EAAA,MAAA,QAAA,IAAA,IAAA;AAAA;;;;IAKA;AAAA;;;;EAIA,OAAA,SAAA;AAAA;AACA,YAAA,MAAA,OAAA;AACA,cAAA,IAAA,OAAA,GAAA;AACA,UAAA,QAAA,oBAAA;AACA,YAAA,OAAA;AAAA,UACA,oBAAA,QAAA;AAAA,QACA;;AAEA,aAAA,OAAA,mBAAA;AACA,cAAA,KAAA,UAAA;;UAEA,OAAA,KAAA,KAAA;AAAA,UACA,MAAA,yDAAA,QAAA;AAAA,UACA,iBAAA;AAAA,QACA;AAAA,MACA;AAAA;;EAEA,kBAAA;AACA,WAAA;AAAA,MACA,OAAA,KAAA,iBAAA;AAAA,IACA;AAAA;EAEA,gBAAA;AACA,YAAA,IAAA,KAAA;;AAEA,WAAA,MAAA,kBAAA,SAAA;AAAA,IACA;AAAA;EAEA,cAAAA,kBAAAA,SAAA,SAAA,GAAA;;AAEA,QAAA,YAAA,IAAA;AACA,WAAA,WAAA;AAAA;;IAGA;AAAA,EACA,GAAA,GAAA;AAAA,EACA,SAAA;AAAA;;;;AAKA,WAAA,WAAA;AAAA;IAGA,YAAA;AAAA;;UAEA,oBAAA,KAAA;AAAA;AAEA,YAAA,EAAA,MAAA,SAAA;;AAEA,eAAA,MAAAC,YAAAA,eAAA,KAAA,KAAA,MAAA;AACA,eAAA,YAAA,KAAA,UAAA,OAAA;AACA,eAAA,iBAAA,QAAA,KAAA;AACA,cAAA,KAAA,aAAA,UAAA,GAAA;AACA,iBAAA,eAAA,CAAA,wDAAA;AAAA,UACA;;QAEA;AAAA;;IAEA,eAAAC,kBAAA,SAAA,WAAA;AAAA;AACA,YAAA;AACA,cAAA,OAAA,MAAA,OAAA,EAAA,YAAA;AACA,cAAA,CAAA,MAAA;;UAEA;;YAEA,oBAAA,KAAA;AAAA;;AAGA,cAAA,IAAA,SAAA,KAAA;;AAEAC,0BAAAA,MAAA,UAAA;AAAA,cACA,OAAA,KAAA,YAAA,SAAA;AAAA;;UAGA;AAAA;;QAGA;AAAA,MACA;AAAA,OAAA,GAAA;AAAA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7NA,GAAG,WAAW,eAAe;"}