{"version":3,"file":"SiteActivities.js","sources":["../../../../../../src/pages-sub/instructorSite/components/SiteActivities.vue","../../../../../../uniComponent:/L1VzZXJzL2d1b3hpYW9taW5nL2NvZGUvcGFwYS1jb2RlL3BtLXluL3VuaWFwcC1zb2NpYWwtc3BvcnRzLW5ldy9zcmMvcGFnZXMtc3ViL2luc3RydWN0b3JTaXRlL2NvbXBvbmVudHMvU2l0ZUFjdGl2aXRpZXMudnVl"],"sourcesContent":["<template>\n  <view class=\"site-activities\">\n    <view class=\"des-content-title\">站点活动</view>\n    <view v-if=\"activityList.length\" class=\"activity-list\">\n      <view v-for=\"(item, index) in activityList\" :key=\"index\" class=\"activity-item\">\n        <ActivityItem :item=\"item\" multipleSize=\"180rpx\" />\n      </view>\n    </view>\n    <loadMore :status=\"loadStatus\" v-if=\"showLoadMore\" />\n    <view v-else class=\"empty-tip\">\n      <empty />\n    </view>\n  </view>\n</template>\n\n<script>\nimport ActivityItem from '@/components/ActivityItem/index.vue'\nimport { getVoluntaryActivityList } from '@/apis/instructorSite/index'\nexport default {\n  name: 'SiteActivities',\n  components: {\n    ActivityItem,\n  },\n  props: {\n    siteId: {\n      type: [String, Number],\n      required: true,\n    },\n  },\n  data() {\n    return {\n      activityList: [],\n      loading: false,\n      finished: false,\n      page: 1,\n    }\n  },\n  computed: {\n    loadStatus() {\n      if (this.finished) {\n        return 'nomore'\n      } else {\n        if (this.loading) {\n          return 'loading'\n        } else {\n          return 'loadmore'\n        }\n      }\n    },\n    showSkeleton() {\n      if (this.activityList.length == 0 && !this.finished && this.loading) {\n        return true\n      }\n    },\n    showEmpty() {\n      if (this.activityList.length == 0 && this.finished && !this.loading) {\n        return true\n      }\n    },\n    showLoadMore() {\n      return !this.showEmpty && this.activityList.length > 0\n    },\n  },\n  created() {\n    this.getActivityList()\n  },\n  methods: {\n    loadMore() {\n      console.log('触底加载')\n      if (this.finished) {\n        console.log('加载完成')\n        this.loading = false\n        return\n      }\n      if (this.loading) {\n        console.log('正在加载')\n        return\n      }\n      this.page = this.page + 1\n      this.getActivityList()\n    },\n    async getActivityList() {\n      if (this.loading) return\n      this.loading = true\n      let params = {\n        page: this.page,\n        size: 10,\n        sort: this.sort,\n        instructor_site_id: this.siteId,\n      }\n      let res = await getVoluntaryActivityList(params)\n      if (res.code !== 200) {\n        this.$toast(res.message)\n        return\n      }\n      res.data.list.map((item) => {\n        let formatObj = {\n          addressFormat: item.province_str + item.county_str + item.city_str + item.address,\n          startTime: this.$dayjs(item.c_time * 1000).format('YYYY-MM-DD HH:mm:ss'),\n        }\n        return {\n          ...formatObj,\n          ...item,\n        }\n      })\n\n      this.activityList = this.activityList.concat(res.data.list)\n      this.count = res.data.count\n      this.loading = false\n      if (res.data.list.length === 0 || res.data.list.length < res.data.size) {\n        this.finished = true\n      }\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.site-activities {\n  padding: 20rpx 0;\n\n  .activity-list {\n    .activity-item {\n      border-bottom: 1rpx solid #f0f0f0;\n    }\n  }\n}\n.des-content-title {\n  font-size: 30rpx;\n  color: $hubei-text-color-primary;\n  font-weight: 600;\n  line-height: 1;\n  padding: 0 22rpx;\n}\n</style>\n","import Component from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pages-sub/instructorSite/components/SiteActivities.vue'\nwx.createComponent(Component)"],"names":["getVoluntaryActivityList"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBA,MAAK,eAAgB,MAAW;AAEhC,MAAK,YAAU;AAAA,EACb,MAAM;AAAA,EACN,YAAY;AAAA,IACV;AAAA,EACD;AAAA,EACD,OAAO;AAAA,IACL,QAAQ;AAAA,MACN,MAAM,CAAC,QAAQ,MAAM;AAAA,MACrB,UAAU;AAAA,IACX;AAAA,EACF;AAAA,EACD,OAAO;AACL,WAAO;AAAA,MACL,cAAc,CAAE;AAAA,MAChB,SAAS;AAAA,MACT,UAAU;AAAA,MACV,MAAM;AAAA,IACR;AAAA,EACD;AAAA,EACD,UAAU;AAAA,IACR,aAAa;AACX,UAAI,KAAK,UAAU;AACjB,eAAO;AAAA,aACF;AACL,YAAI,KAAK,SAAS;AAChB,iBAAO;AAAA,eACF;AACL,iBAAO;AAAA,QACT;AAAA,MACF;AAAA,IACD;AAAA,IACD,eAAe;AACb,UAAI,KAAK,aAAa,UAAU,KAAK,CAAC,KAAK,YAAY,KAAK,SAAS;AACnE,eAAO;AAAA,MACT;AAAA,IACD;AAAA,IACD,YAAY;AACV,UAAI,KAAK,aAAa,UAAU,KAAK,KAAK,YAAY,CAAC,KAAK,SAAS;AACnE,eAAO;AAAA,MACT;AAAA,IACD;AAAA,IACD,eAAe;AACb,aAAO,CAAC,KAAK,aAAa,KAAK,aAAa,SAAS;AAAA,IACtD;AAAA,EACF;AAAA,EACD,UAAU;AACR,SAAK,gBAAe;AAAA,EACrB;AAAA,EACD,SAAS;AAAA,IACP,WAAW;AACT,cAAQ,IAAI,MAAM;AAClB,UAAI,KAAK,UAAU;AACjB,gBAAQ,IAAI,MAAM;AAClB,aAAK,UAAU;AACf;AAAA,MACF;AACA,UAAI,KAAK,SAAS;AAChB,gBAAQ,IAAI,MAAM;AAClB;AAAA,MACF;AACA,WAAK,OAAO,KAAK,OAAO;AACxB,WAAK,gBAAe;AAAA,IACrB;AAAA,IACK,kBAAkB;AAAA;AACtB,YAAI,KAAK;AAAS;AAClB,aAAK,UAAU;AACf,YAAI,SAAS;AAAA,UACX,MAAM,KAAK;AAAA,UACX,MAAM;AAAA,UACN,MAAM,KAAK;AAAA,UACX,oBAAoB,KAAK;AAAA,QAC3B;AACA,YAAI,MAAM,MAAMA,0BAAAA,yBAAyB,MAAM;AAC/C,YAAI,IAAI,SAAS,KAAK;AACpB,eAAK,OAAO,IAAI,OAAO;AACvB;AAAA,QACF;AACA,YAAI,KAAK,KAAK,IAAI,CAAC,SAAS;AAC1B,cAAI,YAAY;AAAA,YACd,eAAe,KAAK,eAAe,KAAK,aAAa,KAAK,WAAW,KAAK;AAAA,YAC1E,WAAW,KAAK,OAAO,KAAK,SAAS,GAAI,EAAE,OAAO,qBAAqB;AAAA,UACzE;AACA,iBAAO,kCACF,YACA;AAAA,QAEN,CAAA;AAED,aAAK,eAAe,KAAK,aAAa,OAAO,IAAI,KAAK,IAAI;AAC1D,aAAK,QAAQ,IAAI,KAAK;AACtB,aAAK,UAAU;AACf,YAAI,IAAI,KAAK,KAAK,WAAW,KAAK,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,MAAM;AACtE,eAAK,WAAW;AAAA,QAClB;AAAA,MACD;AAAA;AAAA,EACF;AACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjHA,GAAG,gBAAgB,SAAS;"}