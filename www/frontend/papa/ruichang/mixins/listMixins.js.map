{"version":3,"file":"listMixins.js","sources":["../../../../src/mixins/listMixins.js"],"sourcesContent":["export default {\n  data() {\n    return {\n      list: [],\n      page: 1,\n      count: 0,\n      loading: false,\n      finished: false,\n    }\n  },\n  computed: {\n    loadStatus() {\n      if (this.finished) {\n        return 'nomore'\n      } else {\n        if (this.loading) {\n          return 'loading'\n        } else {\n          return 'loadmore'\n        }\n      }\n    },\n    showSkeleton() {\n      if (this.list.length == 0 && !this.finished && this.loading) {\n        return true\n      }\n    },\n    showEmpty() {\n      if (this.list.length == 0 && this.finished && !this.loading) {\n        return true\n      }\n    },\n    showLoadMore() {\n      return !this.showEmpty && this.list.length > 0\n    },\n  },\n  onReachBottom() {\n    console.log('触底加载')\n    this.loadMore()\n  },\n  onPullDownRefresh() {\n    this.page = 1\n    this.list = []\n    this.finished = false\n    this.$nextTick(() => {\n      this.getList(true)\n      uni.stopPullDownRefresh()\n    })\n  },\n  methods: {\n    loadMore() {\n      console.log('触底加载')\n      if (this.finished) {\n        console.log('加载完成')\n        this.loading = false\n        return\n      }\n      this.page = this.page + 1\n      this.getList()\n    },\n    getListExtend(res, refresh = false) {\n      try {\n        // 兼容Java\n        res.data.list = res.data.list || res.data.listData || []\n        res.data.count = res.data.count || res.data.total || 0\n        let _this = this\n        if (res.code === 200 || res.code === 0) {\n          if (this.handleDataCallBack instanceof Function) {\n            res.data.list = this.handleDataCallBack(res.data.list)\n          }\n          this.list = this.list.concat(res.data.list)\n          this.count = res.data.count\n          this.loading = false\n          if (res.data.list.length === 0 || res.data.list.length < res.data.size) {\n            this.finished = true\n          }\n          if (!this.finished) {\n            this.$isFullScreen().then((fres) => {\n              let { windowHeight, scrollHeight } = fres\n              if (windowHeight + 70 >= scrollHeight) {\n                _this.loadMore()\n              }\n            })\n          }\n          if (refresh) {\n            uni.stopPullDownRefresh()\n          }\n        } else {\n          this.$showToastNone(res.message)\n        }\n      } catch (e) {\n        console.error('handleList', e)\n      }\n    },\n    resetData() {\n      this.finished = false\n      this.loading = false\n      this.page = 1\n      this.list = []\n      this.$nextTick(() => {\n        this.getList()\n      })\n    },\n  },\n}\n"],"names":["uni"],"mappings":";;AAAA,MAAe,aAAA;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,MAAM,CAAE;AAAA,MACR,MAAM;AAAA,MACN,OAAO;AAAA,MACP,SAAS;AAAA,MACT,UAAU;AAAA,IAChB;AAAA,EACG;AAAA,EACD,UAAU;AAAA,IACR,aAAa;AACX,UAAI,KAAK,UAAU;AACjB,eAAO;AAAA,MACf,OAAa;AACL,YAAI,KAAK,SAAS;AAChB,iBAAO;AAAA,QACjB,OAAe;AACL,iBAAO;AAAA,QACjB;AAAA,MACA;AAAA,IACK;AAAA,IACD,eAAe;AACb,UAAI,KAAK,KAAK,UAAU,KAAK,CAAC,KAAK,YAAY,KAAK,SAAS;AAC3D,eAAO;AAAA,MACf;AAAA,IACK;AAAA,IACD,YAAY;AACV,UAAI,KAAK,KAAK,UAAU,KAAK,KAAK,YAAY,CAAC,KAAK,SAAS;AAC3D,eAAO;AAAA,MACf;AAAA,IACK;AAAA,IACD,eAAe;AACb,aAAO,CAAC,KAAK,aAAa,KAAK,KAAK,SAAS;AAAA,IAC9C;AAAA,EACF;AAAA,EACD,gBAAgB;AACd,YAAQ,IAAI,MAAM;AAClB,SAAK,SAAQ;AAAA,EACd;AAAA,EACD,oBAAoB;AAClB,SAAK,OAAO;AACZ,SAAK,OAAO,CAAA;AACZ,SAAK,WAAW;AAChB,SAAK,UAAU,MAAM;AACnB,WAAK,QAAQ,IAAI;AACjBA,oBAAAA,MAAI,oBAAmB;AAAA,IACxB,CAAA;AAAA,EACF;AAAA,EACD,SAAS;AAAA,IACP,WAAW;AACT,cAAQ,IAAI,MAAM;AAClB,UAAI,KAAK,UAAU;AACjB,gBAAQ,IAAI,MAAM;AAClB,aAAK,UAAU;AACf;AAAA,MACR;AACM,WAAK,OAAO,KAAK,OAAO;AACxB,WAAK,QAAO;AAAA,IACb;AAAA,IACD,cAAc,KAAK,UAAU,OAAO;AAClC,UAAI;AAEF,YAAI,KAAK,OAAO,IAAI,KAAK,QAAQ,IAAI,KAAK,YAAY,CAAA;AACtD,YAAI,KAAK,QAAQ,IAAI,KAAK,SAAS,IAAI,KAAK,SAAS;AACrD,YAAI,QAAQ;AACZ,YAAI,IAAI,SAAS,OAAO,IAAI,SAAS,GAAG;AACtC,cAAI,KAAK,8BAA8B,UAAU;AAC/C,gBAAI,KAAK,OAAO,KAAK,mBAAmB,IAAI,KAAK,IAAI;AAAA,UACjE;AACU,eAAK,OAAO,KAAK,KAAK,OAAO,IAAI,KAAK,IAAI;AAC1C,eAAK,QAAQ,IAAI,KAAK;AACtB,eAAK,UAAU;AACf,cAAI,IAAI,KAAK,KAAK,WAAW,KAAK,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,MAAM;AACtE,iBAAK,WAAW;AAAA,UAC5B;AACU,cAAI,CAAC,KAAK,UAAU;AAClB,iBAAK,cAAa,EAAG,KAAK,CAAC,SAAS;AAClC,kBAAI,EAAE,cAAc,iBAAiB;AACrC,kBAAI,eAAe,MAAM,cAAc;AACrC,sBAAM,SAAQ;AAAA,cAC9B;AAAA,YACa,CAAA;AAAA,UACb;AACU,cAAI,SAAS;AACXA,0BAAAA,MAAI,oBAAmB;AAAA,UACnC;AAAA,QACA,OAAe;AACL,eAAK,eAAe,IAAI,OAAO;AAAA,QACzC;AAAA,MACO,SAAQ,GAAG;AACV,gBAAQ,MAAM,cAAc,CAAC;AAAA,MACrC;AAAA,IACK;AAAA,IACD,YAAY;AACV,WAAK,WAAW;AAChB,WAAK,UAAU;AACf,WAAK,OAAO;AACZ,WAAK,OAAO,CAAA;AACZ,WAAK,UAAU,MAAM;AACnB,aAAK,QAAO;AAAA,MACb,CAAA;AAAA,IACF;AAAA,EACF;AACH;;"}