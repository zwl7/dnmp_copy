{"version":3,"file":"index.js","sources":["../../../../../../../src/pagesSub/sportsService/components/ServiceStyleItem/index.vue","../../../../../../../uniComponent:/L1VzZXJzL2d1b3hpYW9taW5nL2NvZGUvcGFwYS1jb2RlL3BtLXluL3VuaWFwcC1zb2NpYWwtc3BvcnRzLW5ldy9zcmMvcGFnZXNTdWIvc3BvcnRzU2VydmljZS9jb21wb25lbnRzL1NlcnZpY2VTdHlsZUl0ZW0vaW5kZXgudnVl"],"sourcesContent":["<template>\n  <view class=\"styleItem\">\n    <view @click.stop=\"onItemClick\">\n      <view class=\"tags\">\n        <view class=\"tag green\">{{ item.dictName }}</view>\n        <view class=\"tag shallowGreen\">{{ item.serveWorkName }}</view>\n      </view>\n      <view class=\"contentBox\">\n        <view class=\"user-info\">\n          <uv-avatar :src=\"item.avatar\" class=\"avatar\" mode=\"aspectFill\" />\n          <view class=\"user-meta\">\n            <view class=\"nickname\">{{ item.creatorName }}</view>\n            <view class=\"time\">{{ item.createTime }}</view>\n          </view>\n          <!-- <view class=\"tag-level\" v-if=\"item.level\">{{ item.level }}</view> -->\n          <image :src=\"levelMap[item.level]\" class=\"level-img\" mode=\"aspectFill\" />\n        </view>\n        <view class=\"content u-line-2\">{{ item.content }}</view>\n        <!-- <view class=\"img-list\">\n          <image v-for=\"(img, i) in item.images\" :key=\"i\" :src=\"img\" class=\"img-item\" mode=\"aspectFill\" />\n        </view> -->\n        <view class=\"img-list-box\">\n          <uv-album\n            v-if=\"item.images.length > 0\"\n            :urls=\"item.images\"\n            space=\"12rpx\"\n            :multipleSize=\"multipleSize\"\n            singleSize=\"400rpx\"\n            :previewFullImage=\"viewType\"\n          ></uv-album>\n        </view>\n        <view class=\"location\" @click.stop=\"handleShowMap\">\n          <uv-icon name=\"map\" color=\"#a8abb2\"></uv-icon>\n          <!-- style=\"margin-left: 14rpx\" -->\n          <text class=\"u-line-1\">{{ item.address }}</text>\n        </view>\n        <view class=\"meta-bottom\">\n          <view class=\"participants\">\n            <!-- <view class=\"avaterGroup\" v-if=\"item.avatarList?.length > 0\">\n              <uv-avatar v-for=\"(img, i) in item.avatarList.slice(0, 3)\" :key=\"i\" :src=\"img\" class=\"img-item\"\n                mode=\"aspectFill\" />\n            </view> -->\n            <text class=\"count\">{{ item.realityNum }}人参加</text>\n          </view>\n          <view class=\"actions\">\n            <!-- 分享 -->\n            <!-- <view class=\"action share-btn\" v-if=\"isShare\" open-type=\"share\" @click.stop=\"handleCustomShare\">\n              <uv-icon name=\"share-square\" size=\"20\"></uv-icon>\n              {{ item.shareNum }}\n            </view> -->\n            <view class=\"action\" v-if=\"isMyComment\">\n              <view\n                class=\"action-btn review flex\"\n                style=\"gap: 4rpx\"\n                @click.stop=\"handleShowCreatePopup\"\n              >\n                <uv-icon name=\"file-text-fill\" size=\"20\"></uv-icon>\n                看评\n              </view>\n            </view>\n            <!-- 点赞 -->\n            <view class=\"action\" @click.stop=\"handleChangeLike\">\n              <uv-icon\n                size=\"20\"\n                :color=\"item.isLike ? '#ffc411' : ''\"\n                :name=\"item.isLike ? getThemeIcon('thumb_fill') : getThemeIcon('thumb')\"\n              ></uv-icon>\n              {{ item.likesNum }}\n            </view>\n            <!-- 查看个人评价 -->\n            <!-- 查看评价 -->\n            <view\n              class=\"action-btn review flex\"\n              style=\"gap: 4rpx\"\n              v-if=\"isComment && item.isRating\"\n              @click.stop=\"handleViewComment\"\n            >\n              <uv-icon name=\"file-text-fill\" size=\"20\"></uv-icon>\n              看评\n            </view>\n            <!-- 新增评价 -->\n            <view class=\"action\" v-if=\"isComment && !item.isRating\">\n              <view @click.stop=\"handleAddComment\" class=\"items-center\" style=\"gap: 4rpx\">\n                <image\n                  src=\"https://cdn-static.papa.com.cn/jingAn/icon/evalute.svg\"\n                  size=\"20\"\n                  class=\"action-icon\"\n                ></image>\n                评价\n              </view>\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n    <!-- 游客查看评价 -->\n    <visitor-view-comment-popup\n      ref=\"visitorViewCommentPopup\"\n      :evaluteMode=\"evaluteMode\"\n      @submit=\"handleCommentSubmit\"\n      :initStart=\"item.rating\"\n    />\n    <!-- 创建者查看评价 -->\n    <creater-view-comment-popup ref=\"createrViewCommentPopup\" :ratingObj=\"ratingObj\" />\n  </view>\n</template>\n\n<script>\nimport CircleProgress from '@/components/CircleProgress/index.vue'\nimport VisitorViewCommentPopup from './components/VisitorViewCommentPopup.vue'\nimport CreaterViewCommentPopup from './components/CreaterViewCommentPopup.vue'\nimport themeMixins from '@/mixins/themeMixins.js'\nimport {\n  getStyleDetail,\n  addAppraise,\n  praise,\n  cancelPraise,\n  getAppraise,\n  getMessAppraise,\n} from '@/apis/sportsService/serviceStyle'\nexport default {\n  mixins: [themeMixins],\n  props: {\n    item: {\n      type: Object,\n      default: () => ({\n        images: [],\n      }),\n    },\n    isComment: {\n      type: Boolean,\n      default: false,\n    },\n    isMyComment: {\n      type: Boolean,\n      default: false,\n    },\n    isShare: {\n      type: Boolean,\n      default: true,\n    },\n    multipleSize: {\n      type: String,\n      default: '206rpx',\n    },\n    viewType: {\n      type: Boolean,\n      default: false, // 默认1  2 动态 3我的点赞4详情\n    },\n  },\n  components: {\n    CircleProgress,\n    VisitorViewCommentPopup,\n    CreaterViewCommentPopup,\n  },\n  data() {\n    return {\n      showComment: false,\n      showRatePopup: false,\n      rating: 0,\n      rateTexts: ['很差', '一般', '满意', '不错', '非常满意'],\n      count: 5,\n      startcount: 0,\n      evaluteMode: 'edit', // view/edit\n      levelMap: {\n        1: 'https://cdn-static.papa.com.cn/jingAn/icon/nation-level.png',\n        2: 'https://cdn-static.papa.com.cn/jingAn/icon/first-level.png',\n        3: 'https://cdn-static.papa.com.cn/jingAn/icon/second-level.png',\n        4: 'https://cdn-static.papa.com.cn/jingAn/icon/three-level.png',\n        5: 'https://cdn-static.papa.com.cn/jingAn/icon/other-level.png',\n      },\n      myEvalue: {\n        common: 4,\n        detail: 3,\n      },\n      ratingObj: {},\n      requesting: false,\n    }\n  },\n  mounted() {},\n  methods: {\n    // 点击地址打开地图\n    handleShowMap() {\n      // console.log({ item: this.item });\n\n      uni.openLocation({\n        latitude: this.item.lat,\n        longitude: this.item.lng,\n      })\n    },\n    toggleComment() {\n      this.showComment = !this.showComment\n    },\n    async handleChangeLike() {\n      let flag = await getApp().judgeIsLogin()\n      if (!flag) {\n        return\n      }\n      if (this.item.isLike) {\n        this.handleCancelPraise()\n      } else {\n        this.handleAddPraise()\n      }\n    },\n    // 新增点赞\n    async handleAddPraise() {\n      if (this.requesting) return\n      this.requesting = true\n      const res = await praise(this.item.serveWorkId)\n      if (res.code === 0) {\n        this.item.isLike = 1\n        this.item.likesNum++\n        this.requesting = false\n        this.$emit('refresh')\n      }\n    },\n    // 取消点赞\n    async handleCancelPraise() {\n      if (this.requesting) return\n      this.requesting = true\n      const res = await cancelPraise(this.item.serveWorkId)\n      if (res.code === 0) {\n        this.item.isLike = 0\n        this.item.likesNum--\n        this.requesting = false\n        this.$emit('refresh')\n      }\n    },\n    // 确定评价\n    async handleCommentSubmit(value) {\n      const res = await addAppraise({\n        serveWorkId: this.item.serveWorkId,\n        rating: value,\n      })\n      if (res.code === 0) {\n        uni.showToast({\n          title: '提交成功，感谢您的评价反馈~',\n          icon: 'none',\n        })\n        // 切换状态\n        this.item.isRating = 1\n        this.$refs.visitorViewCommentPopup.close()\n      }\n    },\n    // 获取点单人评价\n    async getMyComment() {\n      // if (this.item.rating) return\n      const res = await getAppraise(this.item.serveMienId)\n      if (res.code === 0) {\n        console.log({ 评论: res })\n        this.item.rating = res.data.rating\n\n        this.ratingObj = res.data\n      }\n    },\n    // 获取普通评价\n    async getComment() {\n      // if (this.item.rating) return\n      const res = await getMessAppraise(this.item.serveWorkId)\n      if (res.code === 0) {\n        console.log({ 评论: res })\n        this.item.rating = res.data.rating\n\n        this.ratingObj = res.data\n      }\n    },\n    // 查看评价\n    async handleViewComment() {\n      this.evaluteMode = 'view'\n      await this.getComment()\n      this.$refs.visitorViewCommentPopup.open()\n    },\n    handleAddComment() {\n      this.evaluteMode = 'edit'\n      this.$refs.visitorViewCommentPopup.open()\n    },\n    // 创建者评价\n    async handleShowCreatePopup() {\n      await this.getMyComment()\n      this.$refs.createrViewCommentPopup.open()\n    },\n    onItemClick(item) {\n      // console.log('点击', item)\n      const pages = getCurrentPages()\n      // 获取当前页面路由（最后一个页面）\n      const currentPage = pages[pages.length - 1]\n      const currentRoute = currentPage.route // 当前页面路由地址\n      // console.log({ currentRoute })\n      if (currentRoute === 'pagesSub/sportsService/serviceStyle/detail') {\n        return\n      }\n      // id=' + this.item.id\n      uni.navigateTo({\n        url: `/pagesSub/sportsService/serviceStyle/detail?id=${this.item.serveMienId}${this.isMyComment ? '&myComment=true' : ''}`,\n      })\n    },\n    handleCustomShare() {\n      console.log('666')\n\n      // 主动触发分享\n      wx.showShareMenu({\n        withShareTicket: true,\n        success: () => {\n          wx.updateShareMenu({\n            withShareTicket: true,\n          })\n        },\n      })\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.styleItem {\n  padding: 24rpx;\n  margin-bottom: 24rpx;\n  background: #fbfefa;\n  // border-bottom: 1px solid #f0f0f0;\n  border-radius: 40rpx;\n\n  .contentBox {\n  }\n}\n\n.tags {\n  display: flex;\n  width: 100%;\n  margin-bottom: 28rpx;\n  background: $hubei-card-bg2;\n  border-radius: 200rpx;\n}\n\n.tag {\n  height: 52rpx;\n  font-size: 28rpx;\n}\n\n.green {\n  z-index: 2;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  //   width: 212rpx;\n  padding: 0 28rpx;\n  font-family: 'YouSheBiaoTiHei';\n  color: #fff;\n  text-shadow: 1px 1px 0 $hubei-primary;\n  background: $hubei-primary;\n  border: 1px solid $hubei-primary;\n  border-radius: 200rpx;\n}\n\n.shallowGreen {\n  z-index: 1;\n  flex-grow: 1;\n  padding-left: 24rpx;\n  line-height: 52rpx;\n  color: $hubei-primary;\n}\n\n.user-info {\n  display: flex;\n  align-items: center;\n  margin-bottom: 4px;\n  gap: 24rpx;\n\n  .user-meta {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .level-img {\n    width: 102rpx;\n    height: 36rpx;\n  }\n}\n\n.avatar {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n}\n\n.nickname {\n  font-size: 14px;\n  font-weight: bold;\n}\n\n.tag-level {\n  margin-left: 4px;\n  font-size: 12px;\n  color: #faad14;\n}\n\n.time {\n  font-size: 12px;\n  color: #999;\n}\n\n.content {\n  margin: 24rpx 0;\n  font-size: 28rpx;\n  color: #303133;\n  line-height: 44rpx;\n}\n\n.img-list {\n  display: flex;\n  gap: 16rpx;\n  margin: 24rpx auto;\n\n  .img-item {\n    width: 208rpx;\n    height: 208rpx;\n    border-radius: 24rpx;\n  }\n}\n.img-list-box {\n  ::v-deep(.uv-album__row__wrapper) {\n    image {\n      border-radius: 24rpx;\n    }\n  }\n}\n\n.img {\n  width: 70px;\n  height: 70px;\n  border-radius: 8px;\n}\n\n.meta-bottom {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-top: 6px;\n}\n\n.participants {\n  display: flex;\n  align-items: center;\n}\n\n.p-avatar {\n  width: 20px;\n  height: 20px;\n  margin-right: 2px;\n  border-radius: 50%;\n}\n\n.count {\n  margin-left: 4px;\n  font-size: 12px;\n  color: #888;\n}\n\n.actions {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  font-size: 24rpx;\n\n  .action {\n    display: flex;\n    align-items: center;\n    gap: 10rpx;\n    color: #666;\n    cursor: pointer;\n  }\n\n  .share-btn {\n    background: transparent;\n  }\n}\n\n.action .iconfont {\n  margin-right: 2px;\n  font-size: 16px;\n}\n\n.location {\n  display: flex;\n  gap: 14rpx;\n  margin: 24rpx 0 32rpx;\n  font-size: 24rpx;\n  line-height: 40rpx;\n  color: #a8abb2;\n}\n\n.avaterGroup {\n  margin-right: 37rpx;\n\n  .avatar {\n    margin-right: -25rpx;\n    border: 2px solid #fff;\n    border-radius: 50%;\n  }\n}\n\n.action-icon {\n  width: 40rpx;\n  height: 40rpx;\n}\n\n.rate-popup {\n  width: 280px;\n  // padding: 24px;\n  text-align: left;\n  background: #fff;\n  border-radius: 16px;\n\n  .rate-desc {\n    margin-bottom: 16px;\n    margin-top: 40rpx;\n    font-size: 30rpx;\n    font-weight: 400;\n  }\n\n  .rate-text {\n    font-size: 30rpx;\n    color: #666;\n  }\n}\n</style>\n","import Component from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pagesSub/sportsService/components/ServiceStyleItem/index.vue'\nwx.createComponent(Component)"],"names":["themeMixins","uni","praise","cancelPraise","addAppraise","getAppraise","getMessAppraise","wx"],"mappings":"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"}