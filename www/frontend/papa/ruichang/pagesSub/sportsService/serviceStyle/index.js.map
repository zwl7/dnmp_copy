{"version":3,"file":"index.js","sources":["../../../../../../src/pagesSub/sportsService/serviceStyle/index.vue","../../../../../../uniPage:/cGFnZXNTdWIvc3BvcnRzU2VydmljZS9zZXJ2aWNlU3R5bGUvaW5kZXgudnVl"],"sourcesContent":["<!-- 使用 type=\"home\" 属性设置首页，其他页面不需要设置，默认为page；推荐使用json5，更强大，且允许注释 -->\n<!-- <route lang=\"json5\" type=\"home\">\n{\n  layout: 'tabbar',\n  style: {\n    navigationStyle: 'custom',\n    navigationBarTitleText: '首页',\n  },\n}\n</route> -->\n<template>\n  <view>\n    <view>\n      <view class=\"sticky\">\n        <view class=\"month-card-box\">\n          <monthCard :total=\"count\" @changeData=\"onChangeMonthData\" />\n        </view>\n        <homeDropDown @search=\"search\" ref=\"homeDropDownRef\" />\n      </view>\n      <view class=\"main-box\">\n        <view class=\"list-item-box\" v-for=\"(item, index) in list\" :key=\"index\">\n          <ServiceStyleItem :item=\"item\" :is-detail=\"true\" :isComment=\"true\" />\n        </view>\n        <empty v-if=\"showEmpty\"></empty>\n        <loadMore :status=\"loadStatus\" v-if=\"showLoadMore\" />\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport shareMixins from '@/mixins/shareMixins'\n// import { getVoluntaryActivityList } from '@/api/voluntaryActivity/index'\nimport ServiceStyleItem from '../components/ServiceStyleItem/index.vue'\nimport homeDropDown from './components/homeDropDown.vue'\nimport monthCard from './components/monthCard.vue'\nimport { getMonthStartAndEnd, formatTimeBase } from '@/utils/timeUtil'\nimport { getStyleList } from '@/apis/sportsService/serviceStyle'\nimport listMixins from '@/mixins/listMixins.js'\n\n// import zPaging from 'z-paging/components/z-paging/z-paging.vue'\nexport default {\n  mixins: [shareMixins, listMixins],\n  components: {\n    ServiceStyleItem,\n    homeDropDown,\n    monthCard,\n    // zPaging,\n  },\n  data() {\n    return {\n      searchObj: {},\n      list: [],\n      scrollTop: 0,\n      count: 0,\n      timeObj: {\n        start_time: '',\n        end_time: '',\n      },\n      activityType: '',\n    }\n  },\n  onLoad(options) {\n    if (options.activityType) {\n      this.activity_type = options.activityType\n    }\n  },\n  onShow() {\n    this.getSearchTime()\n    this.resetData()\n  },\n  methods: {\n    onChangeMonthData(data) {\n      console.log('[ data ] >', data)\n      this.getSearchTime(data.year, data.month)\n      this.resetData()\n    },\n    getSearchTime(year, month) {\n      if (!year || !month) {\n        let now = new Date()\n        year = now.getFullYear()\n        month = now.getMonth() + 1\n      }\n      let { start, end } = getMonthStartAndEnd(year, month)\n      this.timeObj = formatTimeBase(start, '{y}-{m}')\n    },\n    search(data) {\n      console.log('筛选！')\n\n      const map = {\n        2: {\n          sortColumn: 'B.likes_num',\n          sortType: 'desc',\n        },\n      }\n      if (map[data.sort]) {\n        data.sortColumn = map[data.sort].sortColumn\n        data.sortType = map[data.sort].sortType\n      }\n\n      this.searchObj = data\n      this.resetData()\n    },\n    async getList(refresh = false) {\n      let params = {\n        page: this.page,\n        size: 10,\n        ...this.searchObj,\n        createTime: this.timeObj,\n      }\n      if (this.activity_type) {\n        params.activity_type = this.activity_type\n      }\n      // let res = await this.getDataDemo(params)\n      const res = await getStyleList(params)\n      console.log({ res })\n      if (res.code === 0) {\n        console.log(this.$refs.pagingRef)\n        res.data.listData.forEach((item) => {\n          // console.log({ item })\n          item.images = item.image ? item.image.split(',') : []\n        })\n        // this.$refs.pagingRef?.complete(data)\n        this.getListExtend(res, refresh)\n      }\n    },\n    scroll(e) {\n      if (this.$refs.homeDropDownRef.popupChange) {\n        this.$refs.homeDropDownRef.init()\n      }\n    },\n  },\n}\n</script>\n\n<style scoped lang=\"scss\">\n.main-box {\n  padding: 32rpx 24rpx;\n}\n\n.month-card-box {\n  position: relative;\n  padding: 32rpx 32rpx 0;\n  background-color: #fff;\n}\n\n.sticky {\n  position: relative;\n}\n\n.list-item-box {\n  // border-bottom: 10px solid #f7f8fa;\n\n  &:last-child {\n    border-bottom: none;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pagesSub/sportsService/serviceStyle/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["shareMixins","listMixins","getMonthStartAndEnd","formatTimeBase","getStyleList"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA,MAAA,mBAAA,MAAA;AACA,qBAAA,MAAA;AACA,kBAAA,MAAA;AAMA,MAAA,YAAA;AAAA,EACA,QAAA,CAAAA,mBAAA,aAAAC,4BAAA;AAAA,EACA,YAAA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA;AAAA,EAEA;AAAA,EACA,OAAA;AACA,WAAA;AAAA,MACA,WAAA,CAAA;AAAA,MACA,MAAA,CAAA;AAAA,MACA,WAAA;AAAA,MACA,OAAA;AAAA,MACA,SAAA;AAAA,QACA,YAAA;AAAA,QACA,UAAA;AAAA,MACA;AAAA,MACA,cAAA;AAAA,IACA;AAAA,EACA;AAAA,EACA,OAAA,SAAA;AACA,QAAA,QAAA,cAAA;AACA,WAAA,gBAAA,QAAA;AAAA,IACA;AAAA,EACA;AAAA,EACA,SAAA;AACA,SAAA,cAAA;AACA,SAAA,UAAA;AAAA,EACA;AAAA,EACA,SAAA;AAAA,IACA,kBAAA,MAAA;AACA,cAAA,IAAA,cAAA,IAAA;AACA,WAAA,cAAA,KAAA,MAAA,KAAA,KAAA;AACA,WAAA,UAAA;AAAA,IACA;AAAA,IACA,cAAA,MAAA,OAAA;AACA,UAAA,CAAA,QAAA,CAAA,OAAA;AACA,YAAA,MAAA,oBAAA,KAAA;AACA,eAAA,IAAA,YAAA;AACA,gBAAA,IAAA,aAAA;AAAA,MACA;AACA,UAAA,EAAA,MAAA,IAAAC,eAAA,oBAAA,MAAA,KAAA;AACA,WAAA,UAAAC,8BAAA,OAAA,SAAA;AAAA,IACA;AAAA,IACA,OAAA,MAAA;AACA,cAAA,IAAA,KAAA;AAEA,YAAA,MAAA;AAAA,QACA,GAAA;AAAA,UACA,YAAA;AAAA,UACA,UAAA;AAAA,QACA;AAAA,MACA;AACA,UAAA,IAAA,KAAA,IAAA,GAAA;AACA,aAAA,aAAA,IAAA,KAAA,IAAA,EAAA;AACA,aAAA,WAAA,IAAA,KAAA,IAAA,EAAA;AAAA,MACA;AAEA,WAAA,YAAA;AACA,WAAA,UAAA;AAAA,IACA;AAAA,IACA,QAAA,UAAA,OAAA;AAAA;AACA,YAAA,SAAA;AAAA,UACA,MAAA,KAAA;AAAA,UACA,MAAA;AAAA,WACA,KAAA,YAHA;AAAA,UAIA,YAAA,KAAA;AAAA,QACA;AACA,YAAA,KAAA,eAAA;AACA,iBAAA,gBAAA,KAAA;AAAA,QACA;AAEA,cAAA,MAAA,MAAAC,gCAAAA,aAAA,MAAA;AACA,gBAAA,IAAA,EAAA,IAAA,CAAA;AACA,YAAA,IAAA,SAAA,GAAA;AACA,kBAAA,IAAA,KAAA,MAAA,SAAA;AACA,cAAA,KAAA,SAAA,QAAA,CAAA,SAAA;AAEA,iBAAA,SAAA,KAAA,QAAA,KAAA,MAAA,MAAA,GAAA,IAAA,CAAA;AAAA,UACA,CAAA;AAEA,eAAA,cAAA,KAAA,OAAA;AAAA,QACA;AAAA,MACA;AAAA;AAAA,IACA,OAAA,GAAA;AACA,UAAA,KAAA,MAAA,gBAAA,aAAA;AACA,aAAA,MAAA,gBAAA,KAAA;AAAA,MACA;AAAA,IACA;AAAA,EACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnIA,GAAG,WAAW,eAAe;"}