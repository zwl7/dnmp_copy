{"version":3,"file":"form.js","sources":["../../../../../../src/pagesSub/sportsService/serviceStyle/index.js","../../../../../../src/pagesSub/sportsService/serviceStyle/form.vue","../../../../../../uniPage:/cGFnZXNTdWIvc3BvcnRzU2VydmljZS9zZXJ2aWNlU3R5bGUvZm9ybS52dWU"],"sourcesContent":["import { reg_tel_phone, reg_cp } from '@/utils/reg'\n\nexport const rules = {\n  sport_tag_str: {\n    type: 'string',\n    required: true,\n    message: '请选择指导项目',\n    trigger: ['blur', 'change'],\n  },\n  realAddress: {\n    required: true,\n    message: '请选择活动地址',\n    trigger: ['blur', 'change'],\n  },\n  is_free: {\n    required: true,\n    message: '请选择场地收费情况',\n    trigger: ['blur', 'change'],\n  },\n  // activity_duration: [\n  // \t{\n  // \t\trequired: true,\n  // \t\tmessage: \"请填写活动时长\",\n  // \t\ttrigger: [\"blur\", \"change\"]\n  // \t}\n  // ],\n  // join_num: [\n  // \t{\n  // \t\trequired: true,\n  // \t\tmessage: \"请填写参与人数\",\n  // \t\ttrigger: [\"blur\", \"change\"]\n  // \t}\n  // ]\n}\n","<template>\n  <view class=\"apply-container overflow-auto greenBox\">\n    <view class=\"form-container mb-10\">\n      <uv-form\n        labelPosition=\"left\"\n        :model=\"form\"\n        :rules=\"rules\"\n        labelWidth=\"150\"\n        errorType=\"toast\"\n        ref=\"formRef\"\n      >\n        <uv-form-item prop=\"text\" borderBottom ref=\"item1\" class=\"border-none\">\n          <view class=\"publish-class\">\n            <uv-textarea\n              v-model=\"form.content\"\n              border=\"none\"\n              autoHeight\n              class=\"textarea\"\n              placeholder=\"分享你的活动\"\n              maxlength=\"100\"\n              count\n            />\n          </view>\n        </uv-form-item>\n        <uv-form-item prop=\"imags\" borderBottom ref=\"item1\" class=\"border-none upload\">\n          <Imgs\n            :previewFullImage=\"true\"\n            @getFileList=\"getFileList\"\n            :maxCount=\"9\"\n            :fileList=\"form.fileList\"\n          />\n        </uv-form-item>\n        <uv-form-item label=\"服务时长(小时)\" prop=\"activity_duration\" borderBottom ref=\"item1\">\n          <uv-input\n            v-model=\"form.realityHours\"\n            type=\"number\"\n            border=\"none\"\n            placeholder=\"请输入时长\"\n          />\n        </uv-form-item>\n        <uv-form-item label=\"参与人数\" prop=\"join_num\" borderBottom ref=\"item1\">\n          <uv-input\n            v-model=\"form.realityNum\"\n            border=\"none\"\n            type=\"number\"\n            placeholder=\"请输入参与人数\"\n          />\n        </uv-form-item>\n      </uv-form>\n      <!-- 选择 -->\n    </view>\n    <view class=\"footer-fixed\" @mousedown=\"startDragging\">\n      <view class=\"btn-black active\" @click=\"submit\">发布</view>\n    </view>\n  </view>\n</template>\n<script>\nimport { rules } from './index'\nimport Imgs from '@/components/upload/imgs.vue'\nimport bottomButton from '@/components/bottomButton.vue'\nimport { addStyle } from '@/apis/sportsService/serviceStyle'\nexport default {\n  components: {\n    Imgs,\n    bottomButton,\n  },\n  data() {\n    return {\n      showPicker: false,\n      rules,\n      form: {\n        content: '',\n        fileList: [],\n        serveWorkId: '',\n      },\n      pickSource: {},\n      selectAddressOptions: {},\n    }\n  },\n  onLoad(options) {\n    console.log({ options })\n\n    this.form.serveWorkId = options.id\n    this.form.realityHours = options.timeGap\n    this.form.realityNum = options.peopleNum\n  },\n  methods: {\n    handleSelectProject() {\n      const tagObj = {\n        tagIds: this.form.tagIds || this.form.tag_ids || '',\n      }\n      uni.navigateTo({\n        url: '/pages-sub/selectActivetyProject/index',\n        success: (res) => {\n          res.eventChannel.emit('TAGOBJ', tagObj)\n        },\n      })\n    },\n    getFileList(fileList) {\n      console.log({ fileList })\n\n      this.form.fileList = fileList\n    },\n    async submit() {\n      this.$refs.formRef.validate().then(async () => {\n        let params = JSON.parse(JSON.stringify(this.form))\n        let result = []\n        Object.keys(this.rules).forEach((key) => {\n          if (!params[key]) {\n            result.push(this.rules[key])\n          }\n        })\n        // if (result.length > 0) {\n        //   this.$toast(result[0].message)\n        //   return\n        // }\n        if(params.fileList.length == 0){\n          uni.showToast({ title: '请至少上传一张图片', icon: 'none' })\n          return\n        }\n        params.image = params.fileList?.map((item) => item.url).join(',')\n        delete params.fileList\n        let res = await addStyle(params)\n        if (res.code == 0) {\n          uni.showToast({ title: '发布成功', icon: 'success' })\n          // uni.redirectTo({ url: '/pages-sub/applyResult/success?type=activity&title=发布成功' })\n          setTimeout(() => {\n            uni.navigateBack()\n          }, 300)\n        } else {\n          uni.showToast({ title: res.message, icon: 'none' })\n        }\n      })\n    },\n    startDragging() {},\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.apply-container {\n  margin: 32rpx;\n  min-height: 100%;\n  background-color: #fff;\n\n  :deep(.form-container .uv-form-item .uni-input-input) {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    word-break: break-all;\n    width: auto;\n  }\n\n  :deep(.uni-textarea-wrapper) {\n    min-height: 150rpx;\n  }\n\n  .submit-btn {\n    margin-top: 80rpx;\n    height: 80rpx;\n    font-size: 28rpx;\n    color: #fff;\n    border-radius: 200rpx;\n    line-height: 80rpx;\n  }\n}\n.greenBox {\n  padding-top: 40rpx;\n background: linear-gradient(180deg, $hubei-card-bg3 0%, rgba(255, 255, 255, 1) 7%);}\n:deep(.form-container .uv-form-item .uv-radio-group) {\n  justify-content: flex-end;\n}\n\n:deep(.uv-radio) {\n  padding-left: 15px;\n}\n\n.border-none {\n  border-bottom: 2rpx solid red;\n}\n\n.footer-fixed {\n  background-color: #fff;\n  z-index: 100;\n  .btn-black {\n    width: 100%;\n    padding: 18rpx 0;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pagesSub/sportsService/serviceStyle/form.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","addStyle"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAEO,MAAM,QAAQ;AAAA,EACnB,eAAe;AAAA,IACb,MAAM;AAAA,IACN,UAAU;AAAA,IACV,SAAS;AAAA,IACT,SAAS,CAAC,QAAQ,QAAQ;AAAA,EAC3B;AAAA,EACD,aAAa;AAAA,IACX,UAAU;AAAA,IACV,SAAS;AAAA,IACT,SAAS,CAAC,QAAQ,QAAQ;AAAA,EAC3B;AAAA,EACD,SAAS;AAAA,IACP,UAAU;AAAA,IACV,SAAS;AAAA,IACT,SAAS,CAAC,QAAQ,QAAQ;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeH;ACyBA,MAAA,OAAA,MAAA;AACA,qBAAA,MAAA;AAEA,MAAA,YAAA;AAAA,EACA,YAAA;AAAA,IACA;AAAA,IACA;AAAA,EACA;AAAA,EACA,OAAA;AACA,WAAA;AAAA,MACA,YAAA;AAAA,MACA;AAAA,MACA,MAAA;AAAA,QACA,SAAA;AAAA,QACA,UAAA,CAAA;AAAA,QACA,aAAA;AAAA,MACA;AAAA,MACA,YAAA,CAAA;AAAA,MACA,sBAAA,CAAA;AAAA,IACA;AAAA,EACA;AAAA,EACA,OAAA,SAAA;AACA,YAAA,IAAA,EAAA,QAAA,CAAA;AAEA,SAAA,KAAA,cAAA,QAAA;AACA,SAAA,KAAA,eAAA,QAAA;AACA,SAAA,KAAA,aAAA,QAAA;AAAA,EACA;AAAA,EACA,SAAA;AAAA,IACA,sBAAA;AACA,YAAA,SAAA;AAAA,QACA,QAAA,KAAA,KAAA,UAAA,KAAA,KAAA,WAAA;AAAA,MACA;AACAA,oBAAAA,MAAA,WAAA;AAAA,QACA,KAAA;AAAA,QACA,SAAA,CAAA,QAAA;AACA,cAAA,aAAA,KAAA,UAAA,MAAA;AAAA,QACA;AAAA,MACA,CAAA;AAAA,IACA;AAAA,IACA,YAAA,UAAA;AACA,cAAA,IAAA,EAAA,SAAA,CAAA;AAEA,WAAA,KAAA,WAAA;AAAA,IACA;AAAA,IACA,SAAA;AAAA;AACA,aAAA,MAAA,QAAA,SAAA,EAAA,KAAA,MAAA;;AACA,cAAA,SAAA,KAAA,MAAA,KAAA,UAAA,KAAA,IAAA,CAAA;AACA,cAAA,SAAA,CAAA;AACA,iBAAA,KAAA,KAAA,KAAA,EAAA,QAAA,CAAA,QAAA;AACA,gBAAA,CAAA,OAAA,GAAA,GAAA;AACA,qBAAA,KAAA,KAAA,MAAA,GAAA,CAAA;AAAA,YACA;AAAA,UACA,CAAA;AAKA,cAAA,OAAA,SAAA,UAAA,GAAA;AACAA,0BAAA,MAAA,UAAA,EAAA,OAAA,aAAA,MAAA,OAAA,CAAA;AACA;AAAA,UACA;AACA,iBAAA,SAAA,YAAA,aAAA,mBAAA,IAAA,CAAA,SAAA,KAAA,KAAA,KAAA;AACA,iBAAA,OAAA;AACA,cAAA,MAAA,MAAAC,gCAAAA,SAAA,MAAA;AACA,cAAA,IAAA,QAAA,GAAA;AACAD,0BAAA,MAAA,UAAA,EAAA,OAAA,QAAA,MAAA,UAAA,CAAA;AAEA,uBAAA,MAAA;AACAA,4BAAAA,MAAA,aAAA;AAAA,eACA,GAAA;AAAA,iBACA;AACAA,0BAAA,MAAA,UAAA,EAAA,OAAA,IAAA,SAAA,MAAA,OAAA,CAAA;AAAA,UACA;AAAA,QACA,EAAA;AAAA,MACA;AAAA;AAAA,IACA,gBAAA;AAAA,IAAA;AAAA,EACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvIA,GAAG,WAAW,eAAe;"}