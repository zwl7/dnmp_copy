{"version":3,"file":"talenList.js","sources":["../../../../../../src/pagesSub/sportsService/serviceAssign/talenList.vue","../../../../../../uniPage:/cGFnZXNTdWIvc3BvcnRzU2VydmljZS9zZXJ2aWNlQXNzaWduL3RhbGVuTGlzdC52dWU"],"sourcesContent":["<template>\n  <view class=\"service-assign\">\n    <navBar\n      :navColor=\"'transparent'\"\n      title=\"\"\n      titleColor=\"#323233\"\n      backColor=\"#323233\"\n      :showBack=\"true\"\n    ></navBar>\n    <view class=\"header\">\n      <!-- 顶部渐变背景+标题+背景图 -->\n      <view class=\"order-header\">\n        <!-- <view class=\"header-content\">\n          <view class=\"header-title\">\n            健身服务\n            <br />\n            一屏览\n          </view>\n        </view> -->\n      </view>\n      <!--  customStyle=\"width: 100%;height: 80rpx;\" -->\n      <!-- itemStyle=\"width: 45%;line-height:60rpx;\" -->\n      <uv-tabs\n        :list=\"tabs\"\n        customStyle=\"width: 100%;height: 80rpx;\"\n        itemStyle=\"width: 50%;height: 80rpx;box-sizing: border-box\"\n        @click=\"changeTabs\"\n        lineColor=\"#303133\"\n      ></uv-tabs>\n      <!-- {{formSearch.serveWorkDevStatus}} -->\n      <view style=\"margin-top: 34rpx\" v-if=\"formSearch.serveWorkDevStatus !== 'serve_wait'\">\n        <searchForm\n          :statusList=\"statusList\"\n          :typeList=\"typeList\"\n          @search=\"hanldeSearch\"\n        ></searchForm>\n      </view>\n      <!-- <view class=\"tabs\">\n        <view\n          v-for=\"(tab, index) in tabs\"\n          :key=\"index\"\n          :class=\"['tab-item', currentTab === index ? 'active' : '']\"\n          @click=\"handleTabChange(index)\"\n        >\n          {{ tab.name }}\n          <text class=\"count\">({{ tab.count }})</text>\n        </view>\n      </view> -->\n    </view>\n    <!-- 滑动tab栏 -->\n    <view class=\"order-list\">\n      <!-- :showApplyBtn=\"currentTab === 0\" -->\n      <service-order-item\n        v-for=\"(item, index) in list\"\n        :key=\"index + 'orderItem'\"\n        :item=\"item\"\n        @reject=\"handleReject\"\n        @detail=\"handleDetail\"\n        :show-style-btn=\"item.serveWorkDevStatus === 'serve_wait'\"\n        @publishStyle=\"handlePublishStyle\"\n      />\n      <empty v-if=\"showEmpty\"></empty>\n      <loadMore :status=\"loadStatus\" v-if=\"showLoadMore\" />\n    </view>\n  </view>\n</template>\n\n<script>\nimport ServiceOrderItem from './components/ServiceOrderItem.vue'\nimport listMixins from '@/mixins/listMixins.js'\nimport {\n  getTalentOrderList,\n  orgDispatch,\n  platformDispatch,\n} from '@/apis/sportsService/serviceAssign.js'\nimport searchForm from './components/searchForm.vue'\nimport { useUserStore } from '@/store'\nimport { getServicesDictPage } from '@/apis/sportsService/common'\nimport { timeDifference } from '@/utils/timeUtil'\nexport default {\n  components: {\n    ServiceOrderItem,\n    searchForm,\n  },\n  mixins: [listMixins],\n  data() {\n    return {\n      tabs: [\n        { name: '待处理', count: 8, key: 'serve_wait' },\n        { name: '全部', count: 3, key: '' },\n      ],\n      currentTab: 0,\n      orderList: [],\n      page: 1,\n      pageSize: 10,\n      loadMoreStatus: 'loadmore',\n      isRefreshing: false,\n      // 模拟数据\n      mockOrders: [\n        {\n          id: 1,\n          categoryName: '科学健身指导',\n          title: '南门社区广场舞指导',\n          location: '南门社区广场',\n          serviceTime: '2025/08/26 12:00:00',\n          createTime: '2025/08/26 12:00',\n          status: '待派单',\n        },\n        {\n          id: 2,\n          categoryName: '科学健身指导',\n          title: '南门社区广场舞指导',\n          location: '南门社区广场',\n          serviceTime: '2025/08/26 12:00:00',\n          createTime: '2025/08/26 12:00',\n          status: '待服务',\n        },\n      ],\n      typeList: [],\n      statusList: [],\n      formSearch: {\n        dictId: '',\n        serveWorkStatStatus: '',\n        serveWorkDevStatus: 'serve_wait',\n      },\n    }\n  },\n  mounted() {\n    this.handelGetServicesDictPage()\n    // 获取状态\n    const data = useUserStore().getEnumListByKey('serveWorkStatStatus') || []\n    console.log({ data })\n    // data.unshift({ label: '全部', value: '' })\n    this.statusList = data.map((item) => ({\n      name: item.label,\n      value: item.value,\n    }))\n  },\n  onShow() {\n    this.resetData()\n  },\n  methods: {\n    // 获取订单列表\n    async getList(refresh = false) {\n      let param = {\n        page: this.page,\n        size: 10,\n        ...this.formSearch,\n      }\n\n      // 模拟接口请求\n      // await new Promise((resolve) => setTimeout(resolve, 500))\n      const res = await getTalentOrderList(param)\n      this.getListExtend(res, refresh)\n      // this.list = list\n    },\n    // 前往服务风采发布页面\n    handlePublishStyle(item) {\n      // 算出serveStartDate- serveEndDate差了多少个小时\n      const servicTimeGap = timeDifference(\n        new Date(item.serveStartDate).getTime(),\n        new Date(item.serveEndDate).getTime(),\n      )\n      console.log({ servicTimeGap, item })\n\n      uni.navigateTo({\n        url: `/pagesSub/sportsService/serviceStyle/form?id=${item.serveWorkId}&timeGap=${servicTimeGap.toFixed(1)}&peopleNum=${item.peopleNum}`,\n      })\n    },\n    hanldeSearch(formSearch) {\n      if (this.formSearch.serveWorkDevStatus === 'serve_wait') {\n        this.formSearch = {\n          dictId: '',\n          serveWorkStatStatus: '',\n          serveWorkDevStatus: 'serve_wait',\n        }\n      } else {\n        this.formSearch = Object.assign(this.formSearch, formSearch)\n      }\n      this.resetData()\n    },\n    // 切换tab栏\n    changeTabs(e) {\n      console.log({ e })\n      if (e.key === 'serve_wait') {\n        this.formSearch = {\n          dictId: '',\n          serveWorkStatStatus: '',\n          serveWorkDevStatus: 'serve_wait',\n        }\n      }\n      this.formSearch.serveWorkDevStatus = e.key\n      this.resetData()\n    },\n    // 获取服务类型\n    async handelGetServicesDictPage() {\n      const res = await getServicesDictPage({ dict_type_sign: 'service_type' })\n      if (res.code === 0) {\n        this.typeList = res.data.listData || []\n        this.typeList.unshift({ name: '全部', dictId: '' })\n      }\n    },\n    // 点击列表项\n    handleDetail(item) {\n      uni.navigateTo({\n        url: `/pagesSub/sportsService/serviceAssign/detail?id=${item.serveWorkId}&mode=plaform&showStyle=true`,\n      })\n    },\n    // 拒单\n    async handleReject(item, fn) {\n      console.log({ item })\n      const res = await platformDispatch({\n        processType: 'reject',\n        serveWorkId: item.serveWorkId,\n        rejectReason: item.rejectReason,\n      })\n      if (res.code === 0) {\n        uni.showToast({\n          title: '拒单成功',\n          icon: 'success',\n        })\n        this.resetData()\n        fn()\n      }\n    },\n    // 完成服务\n    async handleComplete(item) {\n      uni.showModal({\n        title: '提示',\n        content: '确认完成服务吗？',\n        success: (res) => {\n          if (res.confirm) {\n            uni.showToast({\n              title: '操作成功',\n              icon: 'success',\n            })\n            this.getTalentOrderList(true)\n          }\n        },\n      })\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.service-assign {\n  min-height: 100vh;\n  background-color: $hubei-list-page-bg-color;\n\n  .header {\n    // padding: 20px 30px;\n    // background-color: #fff;\n\n    .title {\n      margin-bottom: 20px;\n      font-size: 16px;\n      font-weight: bold;\n    }\n\n    .tabs {\n      display: flex;\n      border-bottom: 1px solid #eee;\n\n      .tab-item {\n        position: relative;\n        flex: 1;\n        padding: 20px 0;\n        font-size: 14px;\n        color: #666;\n        text-align: center;\n\n        .count {\n          font-size: 12px;\n          color: #999;\n        }\n\n        &.active {\n          font-weight: bold;\n          color: #2979ff;\n\n          &::after {\n            position: absolute;\n            bottom: -1px;\n            left: 50%;\n            width: 40px;\n            height: 4px;\n            content: '';\n            background-color: #2979ff;\n            transform: translateX(-50%);\n          }\n        }\n      }\n    }\n  }\n}\n\n.tab-bar-scroll {\n  width: 100vw;\n  background: transparent;\n  margin-top: -32rpx;\n  margin-bottom: 12rpx;\n}\n\n.tab-bar {\n  display: flex;\n  background: #fff;\n  border-radius: 40rpx;\n  box-shadow: 0 2rpx 8rpx #eaf9d6;\n  padding: 8rpx 12rpx;\n  margin: 0 24rpx;\n  overflow-x: auto;\n\n  .tab-item {\n    min-width: 120rpx;\n    padding: 12rpx 0;\n    margin: 0 12rpx;\n    font-size: 28rpx;\n    color: #888;\n    text-align: center;\n    border-radius: 32rpx;\n    background: transparent;\n    transition: all 0.2s;\n\n    &.active {\n      color: #fff;\n      background: linear-gradient(90deg, #b6f730 0%, #7bb800 100%);\n      font-weight: 700;\n      box-shadow: 0 2rpx 8rpx #b6f73044;\n    }\n  }\n}\n\n.order-header {\n  width: 100vw;\n  height: 448rpx;\n  background: url('https://cdn-static.papa.com.cn/social/sportsService/topBannerThree.png');\n  background-size: cover;\n  position: relative;\n  // margin-bottom: 20rpx;\n\n  .header-content {\n    position: absolute;\n    top: 174rpx;\n    z-index: 2;\n    padding-left: 40rpx;\n\n    .header-title {\n      font-size: 70rpx;\n      font-weight: 400;\n      color: rgba(48, 49, 51, 1);\n      line-height: 90rpx;\n      margin-bottom: 24rpx;\n    }\n\n    .header-desc {\n      font-size: 32rpx;\n      color: rgba(48, 49, 51, 1);\n      background: linear-gradient(90deg, rgba(140, 244, 188, 1) 0%, rgba(225, 255, 122, 1) 100%);\n      display: inline-block;\n      border-radius: 26rpx;\n      padding: 0 24rpx;\n      line-height: 56rpx;\n    }\n  }\n}\n\n.order-list {\n  box-sizing: border-box;\n  padding: 36rpx 32rpx 24rpx;\n  background: transparent;\n}\n</style>\n","import MiniProgramPage from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pagesSub/sportsService/serviceAssign/talenList.vue'\nwx.createPage(MiniProgramPage)"],"names":["listMixins","useUserStore","getTalentOrderList","timeDifference","uni","getServicesDictPage","platformDispatch"],"mappings":"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"}