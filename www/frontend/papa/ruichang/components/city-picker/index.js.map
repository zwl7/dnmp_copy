{"version":3,"file":"index.js","sources":["../../../../../src/components/city-picker/index.vue","../../../../../uniComponent:/L1VzZXJzL2d1b3hpYW9taW5nL2NvZGUvcGFwYS1jb2RlL3BtLXluL3VuaWFwcC1zb2NpYWwtc3BvcnRzLW5ldy9zcmMvY29tcG9uZW50cy9jaXR5LXBpY2tlci9pbmRleC52dWU"],"sourcesContent":["<template>\n  <view>\n    <uv-picker\n      ref=\"picker\"\n      :columns=\"addressList\"\n      :loading=\"loading\"\n      keyName=\"name\"\n      @change=\"change\"\n      @confirm=\"confirm\"\n      @close=\"closed\"\n    ></uv-picker>\n  </view>\n</template>\n<script>\nexport default {\n  data() {\n    return {\n      loading: true,\n      provinces: [], //省\n      citys: [], //市\n      areas: [], //区\n      pickerValue: [0, 0, 0],\n      maxDeep: 3,\n    }\n  },\n  created() {\n    this.getData()\n  },\n  computed: {\n    addressList() {\n      if (this.maxDeep == 1) {\n        return [this.prototype]\n      }\n      if (this.maxDeep == 2) {\n        return [this.provinces, this.citys]\n      }\n      return [this.provinces, this.citys, this.areas]\n    },\n  },\n  methods: {\n    closed() {\n      this.$emit('close')\n    },\n    open() {\n      this.$refs.picker.open()\n      this.handlePickValueDefault()\n    },\n    async getData() {\n      let setting = await this.$api.getAreaSetting({})\n      let params = {\n        high_level: setting.data.show_high_level,\n        level: setting.data.show_low_level,\n        with_up: 0,\n      }\n      const res = await this.$api.getCompanyAreaByAccount(params)\n      this.maxDeep = this.getMaxDepth(res.data)\n      this.provinces = res.data\n      this.handlePickValueDefault()\n      setTimeout(() => {\n        this.loading = false\n      }, 200)\n    },\n    getMaxDepth(tree) {\n      if (!tree || tree.length === 0) return 0\n      let maxDepth = 1\n      for (let node of tree) {\n        if (node.next && node.next.length > 0) {\n          const childDepth = this.getMaxDepth(node.next)\n          maxDepth = Math.max(maxDepth, childDepth + 1)\n        }\n      }\n      return maxDepth\n    },\n    handlePickValueDefault() {\n      // 设置省\n      this.pickerValue[0] = 0\n      if (this.maxDeep > 1) {\n        // 设置市\n        this.citys = this.provinces[0]?.next || []\n      }\n      if (this.maxDeep > 2) {\n        // 设置区\n        this.areas = this.citys[0]?.next || []\n      }\n      // 重置下位置\n      this.$refs.picker.setIndexs(\n        [this.pickerValue[0], this.pickerValue[1], this.pickerValue[2]],\n        true,\n      )\n    },\n    change(e) {\n      if (this.loading) return\n      const { columnIndex, index, indexs } = e\n      if (columnIndex === 0) {\n        this.citys = this.provinces[index]?.next || []\n        this.areas = this.citys[0]?.next || []\n        this.$refs.picker.setIndexs([index, 0, 0], true)\n      } else if (columnIndex === 1) {\n        this.areas = this.citys[index]?.next || []\n        this.$refs.picker.setIndexs(indexs, true)\n      }\n    },\n\n    confirm(e) {\n      console.log('确认选择的地区：', e)\n      this.$emit('confirm', e)\n    },\n  },\n}\n</script>\n","import Component from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/components/city-picker/index.vue'\nwx.createComponent(Component)"],"names":[],"mappings":"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"}