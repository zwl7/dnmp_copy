{"version":3,"file":"mapUtils.js","sources":["../../../../src/utils/mapUtils.ts"],"sourcesContent":["import config from '@/core/config.js'\nimport QQMapWX from '@/utils/thirdPartUtils/qqmap-wx-jssdk.js'\n\nvar DEF_PI = 3.14159265359 // PI\nvar DEF_2PI = 6.28318530712 // 2*PI\nvar DEF_PI180 = 0.01745329252 // PI/180.0\nvar DEF_R = 6370693.5 // radius of earth\nexport function getShortDistanceBase(lat1, lon1, lat2, lon2) {\n  var ew1, ns1, ew2, ns2\n  var dx, dy, dew\n  var distance\n  // 角度转换为弧度\n  ew1 = lon1 * DEF_PI180\n  ns1 = lat1 * DEF_PI180\n  ew2 = lon2 * DEF_PI180\n  ns2 = lat2 * DEF_PI180\n  // 经度差\n  dew = ew1 - ew2\n  // 若跨东经和西经180 度，进行调整\n  if (dew > DEF_PI) {\n    dew = DEF_2PI - dew\n  } else if (dew < -DEF_PI) {\n    dew = DEF_2PI + dew\n  }\n  dx = DEF_R * Math.cos(ns1) * dew // 东西方向长度(在纬度圈上的投影长度)\n  dy = DEF_R * (ns1 - ns2) // 南北方向长度(在经度圈上的投影长度)\n  // 勾股定理求斜边长\n  distance = Number(Math.sqrt(dx * dx + dy * dy).toFixed(0))\n  return distance\n}\n\nexport function getShortDistance(lat1, lon1, lat2, lon2) {\n  let distance = getShortDistanceBase(lat1, lon1, lat2, lon2)\n  distance = distance / 1000\n  return Math.floor(distance)\n}\n\n/* \n 根据经纬度解析出省市区id \n */\nexport function reverseGeocoder(latitude, longitude) {\n  return new Promise((resolve, reject) => {\n    let qqmapsdk = new QQMapWX({\n      key: config.qqmapKey,\n    })\n    if (!latitude && !longitude) {\n      reject('请传入经纬度')\n    }\n    qqmapsdk.reverseGeocoder({\n      location: {\n        latitude: latitude,\n        longitude: longitude,\n      },\n      success(res) {\n        let city_name = res.result.ad_info.city\n        let city_id = res.result.ad_info.city_code\n        city_id = String(city_id).slice(3, 7)\n        let params = {\n          city_name: city_name,\n          city_id: city_id,\n          result: res.result,\n          province: res.result.ad_info.province,\n        }\n        resolve(params)\n      },\n      fail(error) {\n        reject('解析错误', error)\n      },\n    })\n  })\n}\n"],"names":["QQMapWX","config"],"mappings":";;;AAGA,IAAI,SAAS;AACb,IAAI,UAAU;AACd,IAAI,YAAY;AAChB,IAAI,QAAQ;AACL,SAAS,qBAAqB,MAAM,MAAM,MAAM,MAAM;AACvD,MAAA,KAAK,KAAK,KAAK;AACnB,MAAI,IAAI,IAAI;AACR,MAAA;AAEJ,QAAM,OAAO;AACb,QAAM,OAAO;AACb,QAAM,OAAO;AACb,QAAM,OAAO;AAEb,QAAM,MAAM;AAEZ,MAAI,MAAM,QAAQ;AAChB,UAAM,UAAU;AAAA,EAAA,WACP,MAAM,CAAC,QAAQ;AACxB,UAAM,UAAU;AAAA,EAAA;AAElB,OAAK,QAAQ,KAAK,IAAI,GAAG,IAAI;AAC7B,OAAK,SAAS,MAAM;AAET,aAAA,OAAO,KAAK,KAAK,KAAK,KAAK,KAAK,EAAE,EAAE,QAAQ,CAAC,CAAC;AAClD,SAAA;AACT;AAWgB,SAAA,gBAAgB,UAAU,WAAW;AACnD,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAClC,QAAA,WAAW,IAAIA,0CAAQ;AAAA,MACzB,KAAKC,YAAAA,OAAO;AAAA,IAAA,CACb;AACG,QAAA,CAAC,YAAY,CAAC,WAAW;AAC3B,aAAO,QAAQ;AAAA,IAAA;AAEjB,aAAS,gBAAgB;AAAA,MACvB,UAAU;AAAA,QACR;AAAA,QACA;AAAA,MACF;AAAA,MACA,QAAQ,KAAK;AACP,YAAA,YAAY,IAAI,OAAO,QAAQ;AAC/B,YAAA,UAAU,IAAI,OAAO,QAAQ;AACjC,kBAAU,OAAO,OAAO,EAAE,MAAM,GAAG,CAAC;AACpC,YAAI,SAAS;AAAA,UACX;AAAA,UACA;AAAA,UACA,QAAQ,IAAI;AAAA,UACZ,UAAU,IAAI,OAAO,QAAQ;AAAA,QAC/B;AACA,gBAAQ,MAAM;AAAA,MAChB;AAAA,MACA,KAAK,OAAO;AACV,eAAO,QAAQ,KAAK;AAAA,MAAA;AAAA,IACtB,CACD;AAAA,EAAA,CACF;AACH;;;"}