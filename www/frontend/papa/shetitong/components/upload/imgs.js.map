{"version":3,"file":"imgs.js","sources":["../../../../../src/components/upload/imgs.vue","../../../../../uniComponent:/L1VzZXJzL2d1b3hpYW9taW5nL2NvZGUvcGFwYS1jb2RlL3BtLXluL3VuaWFwcC1zb2NpYWwtc3BvcnRzLW5ldy9zcmMvY29tcG9uZW50cy91cGxvYWQvaW1ncy52dWU"],"sourcesContent":["<template>\n  <uv-upload\n    :fileList=\"fileList\"\n    @afterRead=\"afterRead\"\n    @delete=\"deletePic\"\n    :width=\"width\"\n    :height=\"height\"\n    :multiple=\"multiple\"\n    :maxCount=\"maxCount\"\n    :previewFullImage=\"previewFullImage\"\n  ></uv-upload>\n</template>\n\n<script>\nimport mpImageCompress from '@/utils/image-compress'\nexport default {\n  props: {\n    multiple: {\n      type: Boolean,\n      default: true,\n    },\n    maxCount: {\n      type: Number,\n      default: 6,\n    },\n    width: {\n      type: Number,\n      default: 80,\n    },\n    height: {\n      type: Number,\n      default: 80,\n    },\n    previewFullImage: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['getFileList'],\n  data() {\n    return {\n      fileList: [],\n    }\n  },\n  methods: {\n    getMore() {\n      console.log('查看更多')\n    },\n    deletePic(event) {\n      this.fileList.splice(event.index, 1)\n      this.$emit('getFileList', this.fileList)\n    },\n    uploadFile(file) {\n      console.log('uploadFile', file)\n      return new Promise(async (resolve, reject) => {\n        try {\n          mpImageCompress.clearTempImg()\n          let fileInfo = await mpImageCompress.set(file.url, 1024 * 5, true)\n          let filePath = fileInfo.filePath\n          this.$api.uploadPic({ filePath: filePath, fileSize: 5 }).then((resp) => {\n            let res = JSON.parse(resp.data)\n            if (res.code == 200) {\n              resolve(res.data)\n            } else {\n              this.$toast(res.message)\n              reject(res.data)\n            }\n          })\n        } catch (error) {\n          console.error('error', error)\n          reject({})\n        }\n      })\n    },\n    async afterRead(event) {\n      let lists = [].concat(event.file)\n      let fileListLen = this[`fileList${event.name}`].length\n      lists.map((item) => {\n        this[`fileList${event.name}`].push({\n          ...item,\n          status: 'uploading',\n          message: '上传中',\n        })\n        return item\n      })\n      for (let i = 0; i < lists.length; i++) {\n        let result = {}\n        let status = 'success'\n        let message = ''\n        try {\n          result = await this.uploadFile(lists[i])\n        } catch (error) {\n          console.error('error', error)\n          status = 'failed'\n          message = '上传失败'\n        }\n        let item = this[`fileList${event.name}`][fileListLen]\n        this[`fileList${event.name}`].splice(\n          fileListLen,\n          1,\n          Object.assign(item, {\n            status: status,\n            message: message,\n            relativeUrl: result.imgPath,\n            url: result.imgUrl,\n            thumb: result.imgUrl,\n          }),\n        )\n        fileListLen++\n      }\n      this.$emit('getFileList', this.fileList)\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped></style>\n","import Component from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/components/upload/imgs.vue'\nwx.createComponent(Component)"],"names":["mpImageCompress"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAeA,MAAK,YAAU;AAAA,EACb,OAAO;AAAA,IACL,UAAU;AAAA,MACR,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,UAAU;AAAA,MACR,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,OAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,QAAQ;AAAA,MACN,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,IACD,kBAAkB;AAAA,MAChB,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,EACF;AAAA,EACD,OAAO,CAAC,aAAa;AAAA,EACrB,OAAO;AACL,WAAO;AAAA,MACL,UAAU,CAAE;AAAA,IACd;AAAA,EACD;AAAA,EACD,SAAS;AAAA,IACP,UAAU;AACR,cAAQ,IAAI,MAAM;AAAA,IACnB;AAAA,IACD,UAAU,OAAO;AACf,WAAK,SAAS,OAAO,MAAM,OAAO,CAAC;AACnC,WAAK,MAAM,eAAe,KAAK,QAAQ;AAAA,IACxC;AAAA,IACD,WAAW,MAAM;AACf,cAAQ,IAAI,cAAc,IAAI;AAC9B,aAAO,IAAI,QAAQ,CAAO,SAAS,WAAW;AAC5C,YAAI;AACFA,8BAAAA,gBAAgB,aAAY;AAC5B,cAAI,WAAW,MAAMA,oBAAAA,gBAAgB,IAAI,KAAK,KAAK,OAAO,GAAG,IAAI;AACjE,cAAI,WAAW,SAAS;AACxB,eAAK,KAAK,UAAU,EAAE,UAAoB,UAAU,EAAG,CAAA,EAAE,KAAK,CAAC,SAAS;AACtE,gBAAI,MAAM,KAAK,MAAM,KAAK,IAAI;AAC9B,gBAAI,IAAI,QAAQ,KAAK;AACnB,sBAAQ,IAAI,IAAI;AAAA,mBACX;AACL,mBAAK,OAAO,IAAI,OAAO;AACvB,qBAAO,IAAI,IAAI;AAAA,YACjB;AAAA,UACD,CAAA;AAAA,QACD,SAAO,OAAO;AACd,kBAAQ,MAAM,SAAS,KAAK;AAC5B,iBAAO,CAAE,CAAA;AAAA,QACX;AAAA,MACD,EAAA;AAAA,IACF;AAAA,IACK,UAAU,OAAO;AAAA;AACrB,YAAI,QAAQ,CAAA,EAAG,OAAO,MAAM,IAAI;AAChC,YAAI,cAAc,KAAK,WAAW,MAAM,IAAI,EAAE,EAAE;AAChD,cAAM,IAAI,CAAC,SAAS;AAClB,eAAK,WAAW,MAAM,IAAI,EAAE,EAAE,KAAK,iCAC9B,OAD8B;AAAA,YAEjC,QAAQ;AAAA,YACR,SAAS;AAAA,UACV,EAAA;AACD,iBAAO;AAAA,QACR,CAAA;AACD,iBAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACrC,cAAI,SAAS,CAAA;AACb,cAAI,SAAS;AACb,cAAI,UAAU;AACd,cAAI;AACF,qBAAS,MAAM,KAAK,WAAW,MAAM,CAAC,CAAC;AAAA,UACvC,SAAO,OAAO;AACd,oBAAQ,MAAM,SAAS,KAAK;AAC5B,qBAAS;AACT,sBAAU;AAAA,UACZ;AACA,cAAI,OAAO,KAAK,WAAW,MAAM,IAAI,EAAE,EAAE,WAAW;AACpD,eAAK,WAAW,MAAM,IAAI,EAAE,EAAE;AAAA,YAC5B;AAAA,YACA;AAAA,YACA,OAAO,OAAO,MAAM;AAAA,cAClB;AAAA,cACA;AAAA,cACA,aAAa,OAAO;AAAA,cACpB,KAAK,OAAO;AAAA,cACZ,OAAO,OAAO;AAAA,YAChB,CAAC;AAAA,UACH;AACA;AAAA,QACF;AACA,aAAK,MAAM,eAAe,KAAK,QAAQ;AAAA,MACxC;AAAA;AAAA,EACF;AACH;;;;;;;;;;;;;;;;;;;;;;;;AChHA,GAAG,gBAAgB,SAAS;"}