{"version":3,"file":"formatData.js","sources":["../../../../../src/components/paForm/formatData.js"],"sourcesContent":["const TYPE_MAP_LIST = [{\r\n\t\tlabel: '单文本',\r\n\t\tc_type: 'input', //c端类型\r\n\t\tvalue: 1\r\n\t},\r\n\t{\r\n\t\tlabel: '多文本',\r\n\t\tc_type: 'textarea',\r\n\t\tvalue: 2\r\n\t},\r\n\t{\r\n\t\tlabel: '单选框',\r\n\t\tc_type: 'radio',\r\n\t\tvalue: 4\r\n\t},\r\n\t{\r\n\t\tlabel: '多选框',\r\n\t\tc_type: 'checkbox',\r\n\t\tvalue: 5\r\n\t},\r\n\t{\r\n\t\tlabel: '单选下拉框',\r\n\t\tc_type: 'picker',\r\n\t\tvalue: 6\r\n\t},\r\n\t{\r\n\t\tlabel: '多选下拉框',\r\n\t\tc_type: 'multiple',\r\n\t\tvalue: 7\r\n\t},\r\n\t{\r\n\t\tlabel: '时间选择器',\r\n\t\tc_type: 'time',\r\n\t\tvalue: 8\r\n\t},\r\n\t{\r\n\t\tlabel: '日期选择器',\r\n\t\tc_type: 'date',\r\n\t\tvalue: 9\r\n\t},\r\n\r\n\t{\r\n\t\tlabel: '图片上传',\r\n\t\tc_type: 'image',\r\n\t\tvalue: 10\r\n\t}\r\n]\r\n\r\n\r\nclass FormatBackDataClass {\r\n\t// platform 平台  event 赛事\r\n\tconstructor(list, type = 'platform') {\r\n\t\tlist.map(e => {\r\n\t\t\te.key = e.key || 'field_' + e.field_id\r\n\t\t})\r\n\t\tthis.baseList = list\r\n\t\tthis.typeMap = this.getTypeMap()\r\n\t\tthis.handleType = type\r\n\t\tif (!(list instanceof Array)) {\r\n\t\t\tthrow new Error('请传入数组数据')\r\n\t\t}\r\n\t}\r\n\t// 获取配置Props\r\n\tgetDataList() {\r\n\t\tlet list = []\r\n\r\n\t\tthis.baseList.map(e => {\r\n\t\t\tlet obj = {}\r\n\t\t\tobj['label'] = e.field_name\r\n\t\t\tobj['prop'] = e.key\r\n\t\t\tif (['checkbox', 'image', 'picker', 'multiple'].indexOf(this.typeMap[e.field_type]) != -1) {\r\n\t\t\t\tobj['strProp'] = e.key + \"_str\"\r\n\t\t\t}\r\n\t\t\tobj['placeholder'] = e.field_desc\r\n\t\t\tobj['type'] = this.typeMap[e.field_type]\r\n\t\t\tobj['required'] = e.is_must == 1 ? true : false\r\n\t\t\tobj['id'] = e.field_id\r\n\t\t\tobj['default_value'] = e.field_default_value\r\n\t\t\tobj['key'] = e.key\r\n\t\t\tif (this.typeMap[e.field_type] == 'radio') {\r\n\t\t\t\tobj['options'] = this.getSelectValue(e.field_select_value)\r\n\t\t\t}\r\n\t\t\tif (this.typeMap[e.field_type] == 'checkbox') {\r\n\t\t\t\tobj['options'] = this.getSelectValue(e.field_select_value)\r\n\t\t\t}\r\n\t\t\tif (this.typeMap[e.field_type] == 'picker') {\r\n\t\t\t\tobj['options'] = [this.getSelectValue(e.field_select_value)]\r\n\t\t\t}\r\n\t\t\tif (this.typeMap[e.field_type] == 'multiple') {\r\n\t\t\t\tobj['options'] = this.getSelectValue(e.field_select_value)\r\n\t\t\t}\r\n\t\t\tlist.push(obj)\r\n\t\t})\r\n\t\treturn list\r\n\t}\r\n\t// 获取rules\r\n\tgetRules() {\r\n\t\tlet obj = {}\r\n\t\tthis.baseList.map(e => {\r\n\t\t\tif (e.is_must == 1) {\r\n\t\t\t\tobj[e.key] = {\r\n\t\t\t\t\ttype: ['checkbox', 'image', 'multiple'].indexOf(this.typeMap[e.field_type]) != -1 ?\r\n\t\t\t\t\t\t'array' : 'string',\r\n\t\t\t\t\trequired: true,\r\n\t\t\t\t\tmessage: e.field_desc,\r\n\t\t\t\t\ttrigger: [\"blur\", \"change\"]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t\treturn obj\r\n\t}\r\n\r\n\t// 获取默认的数据对象\r\n\tgetDefaultData() {\r\n\t\tlet obj = {}\r\n\t\tthis.baseList.map(e => {\r\n\t\t\tobj[e.key] = ['checkbox', 'image', 'multiple'].indexOf(this.typeMap[e.field_type]) != -1 ? [] : ''\r\n\t\t})\r\n\t\treturn obj\r\n\t}\r\n\r\n\t// 获取类型的映射表\r\n\tgetTypeMap() {\r\n\t\tlet obj = {}\r\n\t\tTYPE_MAP_LIST.map(e => {\r\n\t\t\tobj[e.value] = e.c_type\r\n\t\t})\r\n\t\treturn obj\r\n\t}\r\n\t// 获取类型选择\r\n\tgetSelectValue(value) {\r\n\t\tlet list = []\r\n\t\ttry {\r\n\t\t\tlet data = value\r\n\t\t\tif (!(value instanceof Array)) {\r\n\t\t\t\tdata = JSON.parse(value)\r\n\t\t\t}\r\n\t\t\tlist = data.map(e => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tlabel: e.name,\r\n\t\t\t\t\tvalue: this.handleType == 'event' ? String(e.value) : String(e.name)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e)\r\n\t\t}\r\n\t\treturn list\r\n\t}\r\n}\r\n\r\nexport default FormatBackDataClass"],"names":[],"mappings":"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"}