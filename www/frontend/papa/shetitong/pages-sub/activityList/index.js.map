{"version":3,"file":"index.js","sources":["../../../../../src/pages-sub/activityList/index.vue","../../../../../uniPage:/cGFnZXMtc3ViL2FjdGl2aXR5TGlzdC9pbmRleC52dWU"],"sourcesContent":["<!-- 使用 type=\"home\" 属性设置首页，其他页面不需要设置，默认为page；推荐使用json5，更强大，且允许注释 -->\n<!-- <route lang=\"json5\" type=\"home\">\n{\n  layout: 'tabbar',\n  style: {\n    navigationStyle: 'custom',\n    navigationBarTitleText: '首页',\n  },\n}\n</route> -->\n<template>\n  <view>\n    <z-paging\n      ref=\"pagingRef\"\n      v-model=\"dataList\"\n      @query=\"queryList\"\n      @scroll=\"scroll\"\n      class=\"paging\"\n      :paging-style=\"{ 'background-color': '#fff' }\"\n      :loading-more-custom-style=\"{ 'padding-bottom': '200rpx' }\"\n    >\n      <view class=\"sticky\">\n        <view class=\"month-card-box\">\n          <monthCard :total=\"count\" @changeData=\"onChangeMonthData\" />\n        </view>\n        <homeDropDown @search=\"search\" ref=\"homeDropDownRef\" />\n      </view>\n      <view class=\"main-box\">\n        <view class=\"list-item-box\" v-for=\"(item, index) in dataList\" :key=\"index\">\n          <ActivityItem :item=\"item\" />\n        </view>\n        <view v-if=\"dataList.length == 0\">\n          <empty></empty>\n        </view>\n      </view>\n      <template #empty></template>\n    </z-paging>\n  </view>\n</template>\n\n<script>\nimport shareMixins from '@/mixins/shareMixins'\nimport { getVoluntaryActivityList } from '@/api/voluntaryActivity/index'\nimport ActivityItem from '@/components/ActivityItem/index.vue'\nimport homeDropDown from './components/homeDropDown.vue'\nimport monthCard from './components/monthCard.vue'\nimport { getMonthStartAndEnd, formatTimeBase } from '@/utils/timeUtils'\nexport default {\n  mixins: [shareMixins],\n  components: {\n    ActivityItem,\n    homeDropDown,\n    monthCard,\n  },\n  data() {\n    return {\n      searchObj: {},\n      dataList: [],\n      scrollTop: 0,\n      count: 0,\n      timeObj: {\n        start_time: '',\n        end_time: '',\n      },\n      activityType: '',\n    }\n  },\n  onLoad(options) {\n    if (options.activityType) {\n      this.activity_type = options.activityType\n    }\n  },\n  mounted() {\n    this.getSearchTime()\n    this.queryList(1, 10)\n  },\n  methods: {\n    onChangeMonthData(data) {\n      console.log('[ data ] >', data)\n      this.getSearchTime(data.year, data.month)\n      this.queryList(1, 10)\n    },\n    getSearchTime(year, month) {\n      if (!year || !month) {\n        let now = new Date()\n        year = now.getFullYear()\n        month = now.getMonth() + 1\n      }\n      let { start, end } = getMonthStartAndEnd(year, month)\n      this.timeObj = {\n        start_time: formatTimeBase(start, '{y}-{m}-{d}'),\n        end_time: formatTimeBase(end, '{y}-{m}-{d}'),\n      }\n    },\n    search(data) {\n      this.searchObj = data\n      this.queryList(1, 10)\n    },\n    async queryList(pageNo, pageSize) {\n      console.log('[ pageNo ] >', pageNo)\n      console.log('[ pageSize ] >', pageSize)\n      let params = {\n        page: pageNo,\n        size: pageSize,\n        ...this.searchObj,\n        ...this.timeObj,\n      }\n      if (this.activity_type) {\n        params.activity_type = this.activity_type\n      }\n      if (this.activityType) {\n        params.activity_type = this.activityType\n      }\n      let res = await getVoluntaryActivityList(params)\n      if (res.code !== 200) {\n        this.$toast(res.message)\n        return\n      }\n      let dealData = res.data.list.map((item) => {\n        let formatObj = {\n          addressFormat: item.province_str + item.county_str + item.city_str + item.address,\n          startTime: this.$dayjs(item.c_time * 1000).format('YYYY-MM-DD HH:mm:ss'),\n        }\n        return {\n          ...formatObj,\n          ...item,\n        }\n      })\n      this.count = res.data.count\n      this.$refs.pagingRef?.complete(dealData)\n    },\n    scroll(e) {\n      if (this.$refs.homeDropDownRef.popupChange) {\n        this.$refs.homeDropDownRef.init()\n      }\n    },\n  },\n}\n</script>\n\n<style scoped lang=\"scss\">\n.month-card-box {\n  position: relative;\n  padding: 32rpx 32rpx 0;\n  background-color: #fff;\n}\n.sticky {\n  position: relative;\n}\n\n.list-item-box {\n  border-bottom: 10px solid #f7f8fa;\n  &:last-child {\n    border-bottom: none;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pages-sub/activityList/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["shareMixins","getMonthStartAndEnd","formatTimeBase","getVoluntaryActivityList"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA,MAAA,eAAA,MAAA;AACA,qBAAA,MAAA;AACA,kBAAA,MAAA;AAEA,MAAA,YAAA;AAAA,EACA,QAAA,CAAAA,mBAAAA,WAAA;AAAA,EACA,YAAA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACA;AAAA,EACA,OAAA;AACA,WAAA;AAAA,MACA,WAAA,CAAA;AAAA,MACA,UAAA,CAAA;AAAA,MACA,WAAA;AAAA,MACA,OAAA;AAAA,MACA,SAAA;AAAA,QACA,YAAA;AAAA,QACA,UAAA;AAAA,MACA;AAAA,MACA,cAAA;AAAA,IACA;AAAA,EACA;AAAA,EACA,OAAA,SAAA;AACA,QAAA,QAAA,cAAA;AACA,WAAA,gBAAA,QAAA;AAAA,IACA;AAAA,EACA;AAAA,EACA,UAAA;AACA,SAAA,cAAA;AACA,SAAA,UAAA,GAAA,EAAA;AAAA,EACA;AAAA,EACA,SAAA;AAAA,IACA,kBAAA,MAAA;AACA,cAAA,IAAA,cAAA,IAAA;AACA,WAAA,cAAA,KAAA,MAAA,KAAA,KAAA;AACA,WAAA,UAAA,GAAA,EAAA;AAAA,IACA;AAAA,IACA,cAAA,MAAA,OAAA;AACA,UAAA,CAAA,QAAA,CAAA,OAAA;AACA,YAAA,MAAA,oBAAA,KAAA;AACA,eAAA,IAAA,YAAA;AACA,gBAAA,IAAA,aAAA;AAAA,MACA;AACA,UAAA,EAAA,OAAA,QAAAC,gBAAA,oBAAA,MAAA,KAAA;AACA,WAAA,UAAA;AAAA,QACA,YAAAC,gBAAAA,eAAA,OAAA,aAAA;AAAA,QACA,UAAAA,gBAAAA,eAAA,KAAA,aAAA;AAAA,MACA;AAAA,IACA;AAAA,IACA,OAAA,MAAA;AACA,WAAA,YAAA;AACA,WAAA,UAAA,GAAA,EAAA;AAAA,IACA;AAAA,IACA,UAAA,QAAA,UAAA;AAAA;;AACA,gBAAA,IAAA,gBAAA,MAAA;AACA,gBAAA,IAAA,kBAAA,QAAA;AACA,YAAA,SAAA;AAAA,UACA,MAAA;AAAA,UACA,MAAA;AAAA,WACA,KAAA,YACA,KAAA;AAEA,YAAA,KAAA,eAAA;AACA,iBAAA,gBAAA,KAAA;AAAA,QACA;AACA,YAAA,KAAA,cAAA;AACA,iBAAA,gBAAA,KAAA;AAAA,QACA;AACA,YAAA,MAAA,MAAAC,4BAAAA,yBAAA,MAAA;AACA,YAAA,IAAA,SAAA,KAAA;AACA,eAAA,OAAA,IAAA,OAAA;AACA;AAAA,QACA;AACA,YAAA,WAAA,IAAA,KAAA,KAAA,IAAA,CAAA,SAAA;AACA,cAAA,YAAA;AAAA,YACA,eAAA,KAAA,eAAA,KAAA,aAAA,KAAA,WAAA,KAAA;AAAA,YACA,WAAA,KAAA,OAAA,KAAA,SAAA,GAAA,EAAA,OAAA,qBAAA;AAAA,UACA;AACA,iBAAA,kCACA,YACA;AAAA,QAEA,CAAA;AACA,aAAA,QAAA,IAAA,KAAA;AACA,mBAAA,MAAA,cAAA,mBAAA,SAAA;AAAA,MACA;AAAA;AAAA,IACA,OAAA,GAAA;AACA,UAAA,KAAA,MAAA,gBAAA,aAAA;AACA,aAAA,MAAA,gBAAA,KAAA;AAAA,MACA;AAAA,IACA;AAAA,EACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxIA,GAAG,WAAW,eAAe;"}