{"version":3,"file":"index.js","sources":["../../../../../src/pages-sub/trainDetail/index.vue","../../../../../uniPage:/cGFnZXMtc3ViL3RyYWluRGV0YWlsL2luZGV4LnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"train-detail-container\">\n    <view class=\"train-header\">\n      <swiper class=\"swiper-box\" :circular=\"true\" :autoplay=\"true\">\n        <swiper-item v-for=\"(item, index) in getSwiperList(form.cover_img_arr)\" :key=\"index\">\n          <view class=\"swiper-item\">\n            <!-- <div class=\"title uv-line-1\">{{ item.name }}</div> -->\n            <image :src=\"item.images_url\" mode=\"aspectFill\" />\n          </view>\n        </swiper-item>\n      </swiper>\n      <view class=\"h-time\">\n        <text class=\"t-title\">距离报名结束</text>\n        <view class=\"count-down\">\n          <uv-count-down\n            :time=\"countTime(form.apply_end_time * 1000)\"\n            format=\"DD:HH:mm:ss\"\n            autoStart\n            millisecond\n            @change=\"onChange\"\n          >\n            <view class=\"time\">\n              <text class=\"time-item\">{{ timeData.days }}&nbsp;</text>\n              <text class=\"time-text\">天</text>\n              <text class=\"time-item\">\n                {{ timeData.hours > 10 ? timeData.hours : timeData.hours }}\n              </text>\n              <text class=\"time-text\">时</text>\n              <text class=\"time-item\">{{ timeData.minutes }}</text>\n              <text class=\"time-text\">分</text>\n              <text class=\"time-item\">{{ timeData.seconds }}</text>\n              <text class=\"time-text\">秒</text>\n            </view>\n          </uv-count-down>\n        </view>\n      </view>\n    </view>\n    <view class=\"train-content\">\n      <view class=\"detail-title\">{{ form.promote_name }}</view>\n      <view class=\"detail-status\">\n        <!-- 默认success warning error -->\n        <text class=\"status-text\" :style=\"{ background: getBg(form.status_str) }\">\n          {{ form.status_str }}\n        </text>\n        <text v-for=\"(item, index) in form.tag_ids_arr\" :key=\"index\" class=\"status-type\">\n          {{ item.tag_id_str }}\n        </text>\n      </view>\n      <div class=\"detail-des\">\n        <view class=\"des-item\">\n          <uv-icon name=\"clock\" color=\"#A5ADBA\" size=\"15\"></uv-icon>\n          <text class=\"d-name\">报名时间</text>\n          <text class=\"d-text uv-line-1\">{{ form.applyStartTime }}-{{ form.applyEndTime }}</text>\n        </view>\n        <view class=\"des-item\">\n          <uv-icon name=\"clock\" color=\"#A5ADBA\" size=\"15\"></uv-icon>\n          <text class=\"d-name\">培训时间</text>\n          <text class=\"d-text uv-line-1\">{{ form.trainStartTime }}-{{ form.trainEndTime }}</text>\n        </view>\n        <view class=\"des-item\">\n          <view class=\"i-left\">\n            <uv-icon name=\"map\" color=\"#A5ADBA\" size=\"16\"></uv-icon>\n            <text class=\"d-name\">报道地址</text>\n            <view class=\"d-text uv-line-1\" @click=\"toLocation(form)\">{{ form.address }}</view>\n          </view>\n          <uv-icon\n            class=\"i-right\"\n            :name=\"map\"\n            color=\"#A5ADBA\"\n            size=\"32\"\n            @click=\"toLocation(form)\"\n          ></uv-icon>\n        </view>\n      </div>\n    </view>\n    <!-- <view class=\"apply-count\">\n\t\t\t<view class=\"img-wrap\">\n\t\t\t\t<image v-for=\"item in 4\" :key=\"item\" alt=\"头像\" />\n\t\t\t</view>\n\t\t\t<text>{{ form.allow_apply_num }}人参加</text>\n\t\t</view> -->\n    <view class=\"train-des\">\n      <view class=\"des\">\n        <view class=\"des-title\">主办单位</view>\n        <text class=\"des-item\">{{ form.main_hold_unit }}</text>\n      </view>\n      <view class=\"des\">\n        <view class=\"des-title\">协办单位</view>\n        <text class=\"des-item\">{{ form.help_hold_unit }}</text>\n      </view>\n      <view class=\"des\">\n        <view class=\"des-title\">承办单位</view>\n        <text class=\"des-item\">{{ form.real_hold_unit }}</text>\n      </view>\n      <view class=\"des\">\n        <view class=\"des-title\">详细介绍</view>\n        <!-- <text class=\"des-item\">{{ form.text }}</text> -->\n        <uv-parse class=\"des-item\" :content=\"form.text\"></uv-parse>\n      </view>\n      <!-- <view v-for=\"item in 4\" :key=\"item\" class=\"des-item\">\n\t\t\t\t<text class=\"i-title\"> 主办单位 </text>\n\t\t\t</view> -->\n    </view>\n    <view class=\"train-footer\">\n      <!-- <view class=\"share\">\n\t\t\t\t<uv-icon :name=\"share\" size=\"22\"></uv-icon>\n\t\t\t\t<text> 分享 </text>\n\t\t\t</view> -->\n      <view class=\"share\" @click=\"toPhone(form.phone)\">\n        <uv-icon :name=\"call\" size=\"22\"></uv-icon>\n        <text>电话</text>\n      </view>\n      <view style=\"flex: 1\">\n        <uv-button\n          :disabled=\"form.status_str != '报名中' || form.wx_is_apply != 1\"\n          shape=\"circle\"\n          type=\"primary\"\n          :customStyle=\"customStyle\"\n          @click=\"apply(form)\"\n        >\n          {{ form.status_str }}\n        </uv-button>\n      </view>\n    </view>\n  </view>\n</template>\n<script>\nimport shareMixins from '@/mixins/shareMixins'\nimport map from '@/static/images/map.png'\nimport call from '@/static/images/call.png'\nimport share from '@/static/images/share.png'\nimport uniStorage from '@/utils/storages/uniStorage'\nimport { isMp } from '@/utils/platform'\nimport { parseQueryParams } from '@/utils/index.ts'\nexport default {\n  mixins: [shareMixins],\n  data() {\n    return {\n      form: {\n        apply_end_time: 0,\n      },\n      map,\n      call,\n      share,\n      time: 30 * 60 * 60 * 1000,\n      timeData: {},\n      customStyle: {},\n    }\n  },\n  onLoad(options) {\n    if (options.q) {\n      let url = decodeURIComponent(options.q)\n      options.id = parseQueryParams(url).id\n    }\n    if (options.id) {\n      let form = {\n        id1: options.id,\n        title: options.title,\n        address1: options.address,\n      }\n      this.form = { ...form }\n      this.getDetail()\n    }\n  },\n  methods: {\n    toLocation(item) {\n      if (!item.address) {\n        return this.$toast('暂无地址')\n      }\n      window.location.href = `https://apis.map.qq.com/uri/v1/marker?marker=coord:${item.lat},${item.lng};title:${item.address};addr:${item.address}&referer=社体指导员移动端`\n    },\n    toPhone(phone) {\n      if (phone) {\n        isMp ? uni.makePhoneCall({ phoneNumber: phone }) : (window.location.href = `tel:${phone}`)\n      } else {\n        this.$toast('暂无联系方式')\n      }\n    },\n    countTime(endTime) {\n      let now = Date.parse(new Date())\n      let timeDiff = this.$dayjs.duration(endTime - now)\n      return timeDiff.$ms\n    },\n    getSwiperList(list = []) {\n      let data = list.map((item) => {\n        return {\n          images_url: item.http_img,\n        }\n      })\n      data.length == 0\n        ? data.push({ images_url: 'https://cdn-static.papa.com.cn/social/default.png' })\n        : ''\n      return data\n    },\n    getBg(tag) {\n      switch (tag) {\n        case '报名中':\n          return '#4cd964'\n          break\n        case '未开始':\n          return '#1b8bff'\n          break\n        case '报名结束':\n          return '#9f9fa0'\n          break\n        default:\n          return '#1b8bff'\n          break\n      }\n    },\n    async getDetail() {\n      let res = await this.$api.getWxTrainActivityItem({ train_activity_id: this.form.id1 })\n      if (res.code == 200) {\n        let form = {\n          title1: this.form.title,\n          address1: this.form.address1,\n          ...res.data,\n        }\n        this.form = {\n          formatTitle: form.title1,\n          formatAddress: form.address1 + form.address,\n          applyEndTime: this.$dayjs(form.apply_end_time * 1000).format('YYYY-MM-DD HH:mm:ss'),\n          applyStartTime: this.$dayjs(form.apply_start_time * 1000).format('YYYY-MM-DD HH:mm:ss'),\n          trainEndTime: this.$dayjs(form.train_end_time * 1000).format('YYYY-MM-DD HH:mm:ss'),\n          trainStartTime: this.$dayjs(form.train_start_time * 1000).format('YYYY-MM-DD HH:mm:ss'),\n          ...form,\n        }\n      } else {\n        this.$toast(res.message)\n      }\n    },\n    onChange(e) {\n      this.timeData = e\n    },\n    async apply(form) {\n      if (!uniStorage.get('is_login')) {\n        try {\n          await this.$dialog('您还未登录,去登录?', {\n            showCancelButton: true,\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n          })\n        } catch (error) {\n          console.log(error)\n          return\n        }\n        uni.navigateTo({\n          url: '/pages/login/index',\n        })\n        return\n      }\n      uniStorage.set('APPLYFORM', { trainId: form.train_activity_id, title: form.promote_name })\n      uni.navigateTo({\n        url: `/pages-sub/trainApply/index?id=${form.train_activity_id}`,\n      })\n    },\n  },\n}\n</script>\n<style lang=\"scss\" scoped>\n.train-detail-container {\n  padding-bottom: 100rpx;\n\n  .train-header {\n    position: relative;\n    height: 500rpx;\n    .swiper-box {\n      height: 500rpx;\n    }\n    image {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n    .swiper-item {\n      position: relative;\n      height: 100%;\n\n      // .title {\n      // \tposition: absolute;\n      // \tbottom: 24rpx;\n      // \tleft: 32rpx;\n      // \tz-index: 2;\n      // \tmax-width: 90%;\n      // \tfont-size: 28rpx;\n      // \tcolor: #fff;\n      // }\n\n      img,\n      image {\n        position: absolute;\n        inset: 0;\n        width: 100%;\n        height: 100%;\n        // object-fit: cover;\n      }\n    }\n\n    .h-time {\n      position: absolute;\n      right: 32rpx;\n      bottom: 44rpx;\n      display: flex;\n      align-items: center;\n      font-size: 24rpx;\n      color: #fff;\n\n      .t-title {\n        font-weight: 500;\n      }\n\n      .count-down {\n        margin-left: 32rpx;\n\n        .time {\n          display: flex;\n          align-items: center;\n          font-size: 24rpx;\n          color: #f56c6c;\n\n          .time-item {\n            min-width: 46rpx;\n            height: 46rpx;\n            font-size: 28rpx;\n            text-align: center;\n            color: #fff;\n            background-color: #f56c6c;\n            border-radius: 8rpx;\n            font-weight: 600;\n            line-height: 46rpx;\n          }\n\n          .time-text {\n            padding: 0 8rpx;\n\n            &:last-child {\n              padding-right: 0;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  .train-content {\n    position: relative;\n    top: -30rpx;\n    padding: 40rpx 32rpx 32rpx;\n    margin-bottom: 16rpx;\n    background-color: #fff;\n    border-radius: 32rpx 32rpx 0 0;\n\n    .detail-title {\n      font-size: 32rpx;\n      font-weight: 600;\n    }\n    .detail-status {\n      padding: 24rpx 0;\n      font-size: 24rpx;\n\n      .status-text {\n        display: inline-block;\n        margin-bottom: 5rpx;\n        width: fit-content;\n        min-height: 30rpx;\n        padding: 4rpx 8rpx;\n        margin-right: 15rpx;\n        color: #fff;\n        background-color: #4cd964;\n\n        &.warning {\n          background-color: #f0ad4e;\n        }\n\n        &.error {\n          background-color: #dd524d;\n        }\n      }\n\n      .status-type {\n        display: inline-block;\n        margin-bottom: 5rpx;\n        width: fit-content;\n        margin-right: 5rpx;\n        padding: 4rpx 20rpx;\n        color: #f90;\n        background: #fff4e0;\n        border: 1rpx solid #f90;\n      }\n    }\n\n    .detail-des {\n      display: flex;\n      flex-direction: column;\n      font-size: 24rpx;\n      color: #606266;\n\n      .des-item {\n        display: flex;\n        align-items: center;\n        margin: 16rpx 0;\n\n        .d-name {\n          padding: 0 10rpx;\n          color: #909399;\n          flex-shrink: 0;\n        }\n\n        &:last-child {\n          justify-content: space-between;\n\n          .i-left {\n            display: flex;\n            align-items: flex-start;\n          }\n\n          .i-right {\n            border-radius: 50%;\n          }\n        }\n      }\n    }\n  }\n\n  .apply-count {\n    position: relative;\n    top: -30rpx;\n    display: flex;\n    align-items: center;\n    margin-bottom: 16rpx;\n    font-size: 24rpx;\n    color: #909399;\n    background-color: #fff;\n\n    .img-wrap {\n      padding: 24rpx 32rpx;\n      margin-right: 8rpx;\n\n      img,\n      image {\n        margin-right: -18rpx;\n        width: 56rpx;\n        height: 56rpx;\n        border-radius: 50%;\n      }\n    }\n  }\n\n  .train-des {\n    position: relative;\n    top: -30rpx;\n    padding: 32rpx 32rpx 10rpx;\n    background-color: #fff;\n\n    .des-title {\n      font-size: 32rpx;\n      font-weight: 600;\n    }\n\n    .des-item {\n      display: flex;\n      flex-direction: column;\n      padding-bottom: 32rpx;\n      font-weight: 500;\n      font-size: 28rpx;\n\n      .i-title {\n        padding-bottom: 16rpx;\n        font-size: 28rpx;\n        font-weight: 500;\n      }\n\n      &:last-child {\n        padding-top: 16rpx;\n        color: #606266;\n      }\n    }\n  }\n\n  .train-footer {\n    position: fixed;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    display: flex;\n    align-items: center;\n    padding: 10rpx 32rpx;\n    height: 100rpx;\n    background-color: #fff;\n    box-shadow: 0 2px 5px rgb(66 64 64 / 20%);\n\n    .share {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      margin-right: 60rpx;\n      font-size: 20rpx;\n      line-height: 1.8;\n    }\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/src/pages-sub/trainDetail/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["shareMixins","map","call","share","parseQueryParams","isMp","uni","uniStorage"],"mappings":"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"}