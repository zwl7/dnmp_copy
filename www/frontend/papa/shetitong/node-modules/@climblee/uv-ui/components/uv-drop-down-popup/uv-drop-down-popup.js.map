{"version":3,"file":"uv-drop-down-popup.js","sources":["../../../../../../../../node_modules/@climblee/uv-ui/components/uv-drop-down-popup/uv-drop-down-popup.vue","../../../../../../../../uniComponent:/L1VzZXJzL2d1b3hpYW9taW5nL2NvZGUvcGFwYS1jb2RlL3BtLXluL3VuaWFwcC1zb2NpYWwtc3BvcnRzLW5ldy9ub2RlX21vZHVsZXMvQGNsaW1ibGVlL3V2LXVpL2NvbXBvbmVudHMvdXYtZHJvcC1kb3duLXBvcHVwL3V2LWRyb3AtZG93bi1wb3B1cC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"uv-drop-down-popup\">\r\n\t\t<uv-transition :show=\"show\" mode=\"fade\" :duration=\"300\" :custom-style=\"overlayStyle\" @click=\"clickOverlay\">\r\n\t\t\t<view class=\"uv-dp__container\" ref=\"uvDPContainer\" :style=\"{height: `${height}px`}\" @click.stop=\"blockClick\">\r\n\t\t\t\t<view class=\"uv-dp__container__list\" ref=\"uvDPList\">\r\n\t\t\t\t\t<slot>\r\n\t\t\t\t\t\t<view class=\"uv-dp__container__list--item\" v-for=\"(item,index) in list\" :key=\"index\" @click=\"clickHandler(item,index)\" :style=\"[itemCustomStyle(index)]\">\r\n\t\t\t\t\t\t\t<uv-text :text=\"item[keyName]\" :size=\"getTextSize(index)\" :color=\"getTextColor(index)\"></uv-text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</slot>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uv-transition>\r\n\t</view>\r\n</template>\r\n<script>\r\n\timport mpMixin from '../../libs/mixin/mpMixin.js';\r\n\timport mixin from '../../libs/mixin/mixin.js';\r\n\t// #ifdef APP-NVUE\r\n\tconst animation = uni.requireNativePlugin('animation');\r\n\tconst dom = uni.requireNativePlugin('dom');\r\n\t// #endif\r\n\t/**\r\n\t * DropDownPopup 下拉框\r\n\t * @description 下拉筛选框\r\n\t * @tutorial https://ext.dcloud.net.cn/plugin?name=uv-drop-down\r\n\t * @property {String | Number} name 字段标识\r\n\t * @property {String | Number} zIndex 弹出层的层级\r\n\t * @property {String | Number} opacity 遮罩层的透明度\r\n\t * @property {Boolean} clickOverlayOnClose 是否允许点击遮罩层关闭弹窗\r\n\t * @property {Object} currentDropItem 当前下拉筛选菜单对象\r\n\t * @property {String} keyName 指定从当前下拉筛选菜单对象元素中读取哪个属性作为文本展示\r\n\t */\r\n\texport default {\r\n\t\tname: 'uv-drop-down-popup',\r\n\t\tmixins: [mpMixin, mixin],\r\n\t\tprops: {\r\n\t\t\tsign: {\r\n\t\t\t\ttype: [String, Number],\r\n\t\t\t\tdefault: 'UVDROPDOWN'\r\n\t\t\t},\r\n\t\t\tzIndex: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 999\r\n\t\t\t},\r\n\t\t\topacity: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 0.5\r\n\t\t\t},\r\n\t\t\tclickOverlayOnClose: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\t// 当前下拉选项对象\r\n\t\t\tcurrentDropItem: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tactiveIndex: 0,\r\n\t\t\t\t\t\tchild: []\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tkeyName: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'label'\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tshow: false,\r\n\t\t\t\trect: {},\r\n\t\t\t\theight: 0\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\toverlayStyle() {\r\n\t\t\t\tlet { height = 0, top = 0 } = this.rect;\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\ttop += this.$uv.sys().windowTop;\r\n\t\t\t\t// #endif\r\n\t\t\t\tconst style = {\r\n\t\t\t\t\tposition: 'fixed',\r\n\t\t\t\t\ttop: `${top+height}px`,\r\n\t\t\t\t\tleft: 0,\r\n\t\t\t\t\tright: 0,\r\n\t\t\t\t\tzIndex: this.zIndex,\r\n\t\t\t\t\tbottom: 0,\r\n\t\t\t\t\t'background-color': `rgba(0, 0, 0, ${this.opacity})`\r\n\t\t\t\t}\r\n\t\t\t\treturn this.$uv.deepMerge(style, this.$uv.addStyle(this.customStyle))\r\n\t\t\t},\r\n\t\t\tlist() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn Array.isArray(this.currentDropItem.child) ? this.currentDropItem.child : [];\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetTextColor(index) {\r\n\t\t\t\treturn index => {\r\n\t\t\t\t\tconst active = this.currentDropItem.activeIndex == index;\r\n\t\t\t\t\tconst color = this.currentDropItem.color;\r\n\t\t\t\t\tconst activeColor = this.currentDropItem.activeColor;\r\n\t\t\t\t\tif (active) {\r\n\t\t\t\t\t\treturn activeColor ? activeColor : '#3c9cff';\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn color ? color : '#333';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetTextSize(index) {\r\n\t\t\t\treturn index => {\r\n\t\t\t\t\tconst active = this.currentDropItem.activeIndex == index;\r\n\t\t\t\t\tconst size = this.currentDropItem.size;\r\n\t\t\t\t\tconst activeSize = this.currentDropItem.activeSize;\r\n\t\t\t\t\tif (active) {\r\n\t\t\t\t\t\treturn activeSize ? activeSize : '30rpx';\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn size ? size : '30rpx';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\titemCustomStyle() {\r\n\t\t\t\treturn index => {\r\n\t\t\t\t\tconst active = this.currentDropItem.activeIndex == index;\r\n\t\t\t\t\tconst style = {};\r\n\t\t\t\t\tif (active && this.currentDropItem.itemActiveCustomStyle) {\r\n\t\t\t\t\t\treturn this.$uv.deepMerge(style, this.$uv.addStyle(this.currentDropItem.itemActiveCustomStyle));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.currentDropItem.itemCustomStyle) {\r\n\t\t\t\t\t\treturn this.$uv.deepMerge(style, this.$uv.addStyle(this.currentDropItem.itemCustomStyle))\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn style;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.init();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tblockClick() {},\r\n\t\t\tclickHandler(item, index) {\r\n\t\t\t\tthis.currentDropItem.activeIndex = index;\r\n\t\t\t\tthis.$emit('clickItem', item);\r\n\t\t\t\tthis.close();\r\n\t\t\t},\r\n\t\t\tinit() {\r\n\t\t\t\tuni.$off(`${this.sign}_GETRECT`);\r\n\t\t\t\tuni.$on(`${this.sign}_GETRECT`, rect => {\r\n\t\t\t\t\tthis.rect = rect;\r\n\t\t\t\t})\r\n\t\t\t\tuni.$off(`${this.sign}_CLICKMENU`);\r\n\t\t\t\tuni.$on(`${this.sign}_CLICKMENU`, async res => {\r\n\t\t\t\t\tif (res.show) {\r\n\t\t\t\t\t\tthis.open();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.close();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\topen() {\r\n\t\t\t\tthis.show = true;\r\n\t\t\t\tthis.$nextTick(async () => {\r\n\t\t\t\t\t// #ifndef H5 || MP-WEIXIN\r\n\t\t\t\t\tawait this.$uv.sleep(60);\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\tconst res = await this.queryRect();\r\n\t\t\t\t\t// #ifndef APP-NVUE\r\n\t\t\t\t\tthis.height = res.height;\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\t\tthis.animation(res.height);\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\tthis.$emit('popupChange', { show: true });\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tclose() {\r\n\t\t\t\tif(!this.show) return;\r\n\t\t\t\tthis.height = 0;\r\n\t\t\t\t// #ifndef APP-NVUE\r\n\t\t\t\tthis.height = 0;\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\tthis.animation(0);\r\n\t\t\t\t// #endif\r\n\t\t\t\tthis.show = false;\r\n\t\t\t\tuni.$emit(`${this.sign}_CLOSEPOPUP`);\r\n\t\t\t\tthis.$emit('popupChange', { show: false });\r\n\t\t\t},\r\n\t\t\tclickOverlay() {\r\n\t\t\t\tif (this.clickOverlayOnClose) {\r\n\t\t\t\t\tthis.close();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 查询内容高度\r\n\t\t\tqueryRect() {\r\n\t\t\t\t// #ifndef APP-NVUE\r\n\t\t\t\t// 组件内部一般用this.$uvGetRect，对外的为getRect，二者功能一致，名称不同\r\n\t\t\t\treturn new Promise(resolve => {\r\n\t\t\t\t\tthis.$uvGetRect(`.uv-dp__container__list`).then(size => {\r\n\t\t\t\t\t\tresolve(size)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\t// nvue下，使用dom模块查询元素高度\r\n\t\t\t\t// 返回一个promise，让调用此方法的主体能使用then回调\r\n\t\t\t\treturn new Promise(resolve => {\r\n\t\t\t\t\tdom.getComponentRect(this.$refs.uvDPList, res => {\r\n\t\t\t\t\t\tresolve(res.size)\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\t// nvue下设置高度\r\n\t\t\tanimation(height, duration = 200) {\r\n\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\tconst ref = this.$refs['uvDPContainer'];\r\n\t\t\t\tanimation.transition(ref, {\r\n\t\t\t\t\tstyles: {\r\n\t\t\t\t\t\theight: `${height}px`\r\n\t\t\t\t\t},\r\n\t\t\t\t\tduration\r\n\t\t\t\t})\r\n\t\t\t\t// #endif\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n<style scoped lang=\"scss\">\r\n\t.uv-dp__container {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\toverflow: hidden;\r\n\t\ttransition: all .15s;\r\n\t\t/* #endif */\r\n\t\tbackground-color: #fff;\r\n\t}\r\n\t.uv-dp__container__list {\r\n\t\t&--item {\r\n\t\t\tpadding: 20rpx 60rpx;\r\n\t\t}\r\n\t}\r\n</style>","import Component from '/Users/guoxiaoming/code/papa-code/pm-yn/uniapp-social-sports-new/node_modules/@climblee/uv-ui/components/uv-drop-down-popup/uv-drop-down-popup.vue'\nwx.createComponent(Component)"],"names":["mpMixin","mixin","index","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAiCC,MAAK,YAAU;AAAA,EACd,MAAM;AAAA,EACN,QAAQ,CAACA,cAAO,SAAEC,mBAAK;AAAA,EACvB,OAAO;AAAA,IACN,MAAM;AAAA,MACL,MAAM,CAAC,QAAQ,MAAM;AAAA,MACrB,SAAS;AAAA,IACT;AAAA,IACD,QAAQ;AAAA,MACP,MAAM,CAAC,QAAQ,MAAM;AAAA,MACrB,SAAS;AAAA,IACT;AAAA,IACD,SAAS;AAAA,MACR,MAAM,CAAC,QAAQ,MAAM;AAAA,MACrB,SAAS;AAAA,IACT;AAAA,IACD,qBAAqB;AAAA,MACpB,MAAM;AAAA,MACN,SAAS;AAAA,IACT;AAAA;AAAA,IAED,iBAAiB;AAAA,MAChB,MAAM;AAAA,MACN,UAAW;AACV,eAAO;AAAA,UACN,aAAa;AAAA,UACb,OAAO,CAAC;AAAA,QACT;AAAA,MACD;AAAA,IACA;AAAA,IACD,SAAS;AAAA,MACR,MAAM;AAAA,MACN,SAAS;AAAA,IACV;AAAA,EACA;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,MAAM;AAAA,MACN,MAAM,CAAE;AAAA,MACR,QAAQ;AAAA,IACT;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,eAAe;AACd,UAAI,EAAE,SAAS,GAAG,MAAM,EAAI,IAAE,KAAK;AAInC,YAAM,QAAQ;AAAA,QACb,UAAU;AAAA,QACV,KAAK,GAAG,MAAI,MAAM;AAAA,QAClB,MAAM;AAAA,QACN,OAAO;AAAA,QACP,QAAQ,KAAK;AAAA,QACb,QAAQ;AAAA,QACR,oBAAoB,iBAAiB,KAAK,OAAO;AAAA,MAClD;AACA,aAAO,KAAK,IAAI,UAAU,OAAO,KAAK,IAAI,SAAS,KAAK,WAAW,CAAC;AAAA,IACpE;AAAA,IACD,OAAO;AACN,UAAI;AACH,eAAO,MAAM,QAAQ,KAAK,gBAAgB,KAAK,IAAI,KAAK,gBAAgB,QAAQ;MACjF,SAAS,GAAG;AACX,eAAO;MACR;AAAA,IACA;AAAA,IACD,aAAa,OAAO;AACnB,aAAO,CAAAC,WAAS;AACf,cAAM,SAAS,KAAK,gBAAgB,eAAeA;AACnD,cAAM,QAAQ,KAAK,gBAAgB;AACnC,cAAM,cAAc,KAAK,gBAAgB;AACzC,YAAI,QAAQ;AACX,iBAAO,cAAc,cAAc;AAAA,QACpC;AACA,eAAO,QAAQ,QAAQ;AAAA,MACxB;AAAA,IACA;AAAA,IACD,YAAY,OAAO;AAClB,aAAO,CAAAA,WAAS;AACf,cAAM,SAAS,KAAK,gBAAgB,eAAeA;AACnD,cAAM,OAAO,KAAK,gBAAgB;AAClC,cAAM,aAAa,KAAK,gBAAgB;AACxC,YAAI,QAAQ;AACX,iBAAO,aAAa,aAAa;AAAA,QAClC;AACA,eAAO,OAAO,OAAO;AAAA,MACtB;AAAA,IACA;AAAA,IACD,kBAAkB;AACjB,aAAO,WAAS;AACf,cAAM,SAAS,KAAK,gBAAgB,eAAe;AACnD,cAAM,QAAQ,CAAA;AACd,YAAI,UAAU,KAAK,gBAAgB,uBAAuB;AACzD,iBAAO,KAAK,IAAI,UAAU,OAAO,KAAK,IAAI,SAAS,KAAK,gBAAgB,qBAAqB,CAAC;AAAA,QAC/F;AACA,YAAI,KAAK,gBAAgB,iBAAiB;AACzC,iBAAO,KAAK,IAAI,UAAU,OAAO,KAAK,IAAI,SAAS,KAAK,gBAAgB,eAAe,CAAC;AAAA,QACzF;AACA,eAAO;AAAA,MACR;AAAA,IACD;AAAA,EACA;AAAA,EACD,UAAU;AACT,SAAK,KAAI;AAAA,EACT;AAAA,EACD,SAAS;AAAA,IACR,aAAa;AAAA,IAAE;AAAA,IACf,aAAa,MAAM,OAAO;AACzB,WAAK,gBAAgB,cAAc;AACnC,WAAK,MAAM,aAAa,IAAI;AAC5B,WAAK,MAAK;AAAA,IACV;AAAA,IACD,OAAO;AACNC,oBAAG,MAAC,KAAK,GAAG,KAAK,IAAI,UAAU;AAC/BA,oBAAG,MAAC,IAAI,GAAG,KAAK,IAAI,YAAY,UAAQ;AACvC,aAAK,OAAO;AAAA,OACZ;AACDA,oBAAG,MAAC,KAAK,GAAG,KAAK,IAAI,YAAY;AACjCA,oBAAG,MAAC,IAAI,GAAG,KAAK,IAAI,cAAc,CAAM,QAAO;AAC9C,YAAI,IAAI,MAAM;AACb,eAAK,KAAI;AAAA,eACH;AACN,eAAK,MAAK;AAAA,QACX;AAAA,QACA;AAAA,IACD;AAAA,IACD,OAAO;AACN,WAAK,OAAO;AACZ,WAAK,UAAU,MAAY;AAI1B,cAAM,MAAM,MAAM,KAAK;AAEvB,aAAK,SAAS,IAAI;AAKlB,aAAK,MAAM,eAAe,EAAE,MAAM,KAAM,CAAA;AAAA,QACxC;AAAA,IACD;AAAA,IACD,QAAQ;AACP,UAAG,CAAC,KAAK;AAAM;AACf,WAAK,SAAS;AAEd,WAAK,SAAS;AAKd,WAAK,OAAO;AACZA,oBAAG,MAAC,MAAM,GAAG,KAAK,IAAI,aAAa;AACnC,WAAK,MAAM,eAAe,EAAE,MAAM,MAAO,CAAA;AAAA,IACzC;AAAA,IACD,eAAe;AACd,UAAI,KAAK,qBAAqB;AAC7B,aAAK,MAAK;AAAA,MACX;AAAA,IACA;AAAA;AAAA,IAED,YAAY;AAGX,aAAO,IAAI,QAAQ,aAAW;AAC7B,aAAK,WAAW,yBAAyB,EAAE,KAAK,UAAQ;AACvD,kBAAQ,IAAI;AAAA,SACZ;AAAA,OACD;AAAA,IAWD;AAAA;AAAA,IAED,UAAU,QAAQ,WAAW,KAAK;AAAA,IAUlC;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjOD,GAAG,gBAAgB,SAAS;","x_google_ignoreList":[0]}