import{d as L,r as _,T as Y,e as r,o as p,a as N,b as G,h as f,w as a,q as b,t as J,p as y,f as e,l as P,v as K,E as U,_ as I,V as Q,B as W,I as X,ab as Z,u as t,g as ee,F as te,Y as ae,U as oe}from"./index-73817fb6.js";import{I as ue}from"./index-64271805.js";import{u as le}from"./useTable-c08e9eeb.js";import{V as se}from"./index-c0d3fb64.js";import{u as ne}from"./useHandleData-a9a9d16a.js";import{k as ie,e as re}from"./event-3905bdce.js";import{g as ce}from"./project-7708919b.js";import{t as pe,a as de,b as me}from"./common-a24ad4a0.js";import{u as _e}from"./index-1eb1379c.js";const ve={class:"app-container"},fe={class:"flex-export-data"},ge=L({__name:"index",props:{taskName:String,taskOption:Object},setup(j){const C=j,d=_(""),c=_(0),g=_(0),k=_(0),m=_(1);Y(()=>{clearTimeout(k.value)});const F=()=>{w()},D=async()=>{var l;const n={task_name:C.taskName,task_id:g.value,...(l=C.taskOption)==null?void 0:l.param},{data:u}=await me(n);m.value=u.status,u.status===1?(u.completed.path&&(d.value="https://apitest.wesais.cn"+u.completed.path),k.value!==0&&U({title:"\u6E29\u99A8\u63D0\u793A",message:"\u5BFC\u51FA\u5B8C\u6210\uFF01",type:"success"})):(u.status===2?(c.value=parseFloat(u.processing.rate),g.value=u.processing.task_id):u.status===3&&(c.value=0,g.value=u.waiting.task_id),k.value=window.setTimeout(D,3e3))},B=async()=>{const n={task_id:g.value};await pe(n),U({title:"\u6E29\u99A8\u63D0\u793A",message:"\u5BFC\u51FA\u4EFB\u52A1\u53D6\u6D88\u6210\u529F\uFF01",type:"success"}),clearTimeout(k.value),D()},w=async()=>{var l;const n={task_name:C.taskName,...(l=C.taskOption)==null?void 0:l.param},{data:u}=await de(n);g.value=u.task_id,D()},h=()=>{const n=document.createElement("a");n.href=d.value,n.download="exportData",n.click()};return(n,u)=>{const l=r("el-button"),E=r("el-progress"),x=r("el-col");return p(),N("div",ve,[G("div",fe,[m.value!==2?(p(),f(l,{key:0,type:"primary",disabled:m.value===3,onClick:F},{default:a(()=>[b(J(m.value!==3?"\u5BFC\u51FA":"\u7B49\u5F85\u4E2D"),1)]),_:1},8,["disabled"])):y("v-if",!0),m.value===2?(p(),f(x,{key:1,span:8,class:"fr ml-20",align:"right"},{default:a(()=>[e(E,{percentage:c.value,class:"el-progress"},null,8,["percentage"])]),_:1})):y("v-if",!0),m.value!==1?(p(),f(l,{key:2,class:"ml-20",onClick:B},{default:a(()=>[b(" \u53D6\u6D88 ")]),_:1})):y("v-if",!0),P(e(l,{onClick:h},{default:a(()=>[b("\u4E0B\u8F7D\u6570\u636E")]),_:1},512),[[K,m.value===1&&d.value!==""]])])])}}});const Ce=I(ge,[["__scopeId","data-v-a72f49c3"],["__file","/Users/zwl/dnmp/www/frontend/ppos-sport-online/src/components/Export/index.vue"]]),ke=L({__name:"score",setup(j){const{tableData:C,pageable:d,searchParam:c,pageParam:g,handleSizeChange:k,handleCurrentChange:m,getTableList:F,search:D,renderEmpty:B,loading:w}=le(ie);Q(()=>c,_e(F,300),{deep:!0}),W();const h=async v=>{let i="\u4E0B\u67B6\u540E\u89C6\u9891,\u4E0B\u67B6\u540E\u5C06\u4ECE\u53C2\u8D5B\u89C6\u9891\u4E2D\u79FB\u9664\uFF0C\u5E76\u6E05\u7A7A\u5DF2\u6709\u7684\u6D4F\u89C8\u3001\u70B9\u8D5E\u3001\u8F6C\u53D1\u91CF";await ne(re,{activity_video_id:v.activity_video_id,status:3},i,"\u4E0B\u67B6\u6210\u529F"),F()},n=_([]),u=async()=>{let v=await ce({});v.code==200&&(n.value=v.data)},l=_(!1),E=_(""),x=_(""),S=v=>{E.value=v.url,x.value=v.images,l.value=!0};return X(()=>{F(),u()}),(v,i)=>{const T=r("el-input"),A=r("el-form-item"),O=r("el-option"),R=r("el-select"),V=r("el-button"),$=r("el-form"),s=r("el-table-column"),q=r("el-table"),M=r("el-pagination"),H=Z("loading");return p(),f(ue,null,{filter:a(()=>[e($,{model:t(c)},{default:a(()=>[e(A,{class:"filter_item w_300"},{default:a(()=>[e(T,{modelValue:t(c).keyword,"onUpdate:modelValue":i[0]||(i[0]=o=>t(c).keyword=o),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u54C1\u540D\u79F0/\u53C2\u8D5B\u8005\u59D3\u540D/\u624B\u673A\u53F7"},null,8,["modelValue"])]),_:1}),e(A,{class:"filter_item"},{default:a(()=>[e(R,{modelValue:t(c).project_id,"onUpdate:modelValue":i[1]||(i[1]=o=>t(c).project_id=o),clearable:"",placeholder:"\u6240\u5C5E\u9879\u76EE"},{default:a(()=>[(p(!0),N(te,null,ee(t(n),(o,z)=>(p(),f(O,{key:z,label:o.name,value:o.project_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(A,{class:"filter_item"},{default:a(()=>[e(V,{type:"primary",onClick:t(D)},{default:a(()=>[b("\u641C\u7D22")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),operation:a(()=>[e(Ce,{"task-name":"sportOnlineVideoList","task-option":{param:Object.assign({},t(c),t(g))}},null,8,["task-option"])]),table:a(()=>[P((p(),f(q,{data:t(C),size:"small",border:"",style:{width:"100%"}},{empty:a(()=>[(p(),f(ae(t(B))))]),default:a(()=>[e(s,{label:"\u5E8F\u53F7",type:"index"}),e(s,{label:"\u6240\u5C5E\u8D5B\u4F1A",prop:"match_name"}),e(s,{label:"\u6240\u5C5E\u9879\u76EE",prop:"project_name"}),e(s,{label:"\u8D5B\u4E8B\u540D\u79F0",prop:"match_activity_name"}),e(s,{label:"\u4F5C\u54C1ID",prop:"activity_video_id"}),e(s,{label:"\u4F5C\u54C1\u540D\u79F0",prop:"name"}),e(s,{label:"\u59D3\u540D",prop:"member_name"}),e(s,{label:"\u624B\u673A\u53F7",prop:"phone"}),e(s,{label:"\u89C6\u9891",align:"center"},{default:a(o=>[e(V,{link:"",size:"small",onClick:z=>S(o.row)},{default:a(()=>[b(" \u67E5\u770B\u89C6\u9891 ")]),_:2},1032,["onClick"])]),_:1}),e(s,{label:"\u6D4F\u89C8\u91CF",prop:"see"}),e(s,{label:"\u70B9\u8D5E\u91CF",prop:"love"}),e(s,{label:"\u8F6C\u53D1\u91CF",prop:"share"}),e(s,{label:"\u5206\u6570",prop:"score"}),e(s,{label:"\u64CD\u4F5C",align:"center",fixed:"right"},{default:a(o=>[o.row.status==2?(p(),f(V,{key:0,link:"",type:"danger",size:"small",onClick:z=>h(o.row)},{default:a(()=>[b(" \u4E0B\u67B6 ")]),_:2},1032,["onClick"])):y("v-if",!0)]),_:1})]),_:1},8,["data"])),[[H,t(w)]])]),pagination:a(()=>[e(M,{"current-page":t(d).page,"onUpdate:currentPage":i[2]||(i[2]=o=>t(d).page=o),"page-size":t(d).size,"onUpdate:pageSize":i[3]||(i[3]=o=>t(d).size=o),"page-sizes":[10,20,50,100],background:"",layout:"total, sizes, prev, pager, next",total:t(d).count,onSizeChange:t(k),onCurrentChange:t(m)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),dialog:a(()=>[e(se,{visible:t(l),"onUpdate:visible":i[4]||(i[4]=o=>oe(l)?l.value=o:null),title:"\u89C6\u9891\u5BA1\u6838",url:t(E),poster:t(E)},null,8,["visible","url","poster"])]),_:1})}}}),Ae=I(ke,[["__file","/Users/zwl/dnmp/www/frontend/ppos-sport-online/src/views/events/score.vue"]]);export{Ae as default};
