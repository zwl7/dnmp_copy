import{d as G,A as W,B as X,r as p,V as Z,P as ee,Q as te,I as ue,e as n,o as m,h as c,w as s,f as o,u as l,a as E,g as b,F as V,q as _,p as x,x as ae,k as le,y as oe,z as se,b as M,_ as de}from"./index-73817fb6.js";import{F as ie}from"./index-dfa22ab7.js";import{I as ne}from"./Imgs-dbc6d0a0.js";import{u as re}from"./useFormEdit-e635c879.js";import{K as me}from"./tabs-3df7d807.js";import{g as pe}from"./saihui-f69ee65f.js";import{i as _e,j as ce,k as fe,l as ge}from"./operatManage-c4d273ad.js";import"./upload-d8b475c5.js";const ve={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u516C\u544A\u6807\u9898",trigger:"change"},{max:20,message:"\u6700\u591A20\u4E2A\u5B57\u7B26",trigger:"change"}],community_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u6240\u5C5E\u8D5B\u4F1A",trigger:"change"}],imagesList:[{required:!0,message:"\u8BF7\u9009\u62E9\u6216\u4E0A\u4F20\u5C01\u9762\u56FE\u7247",trigger:"change"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u516C\u544A\u72B6\u6001 ",trigger:"change"}],type_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u63A8\u8350\u7C7B\u578B ",trigger:"change"}]},U=g=>(oe("data-v-1d95cb2a"),g=g(),se(),g),ye=U(()=>M("span",{class:"tip"},"2M",-1)),Fe=U(()=>M("span",{class:"tip"},"jpeg/jpg/png",-1)),Be=G({__name:"addRecommend",setup(g){const{closeCurrent:C,ruleFormRef:L,setTitle:D,loading:q,addMethod:I,updateMethod:N}=re(),k=me(),y=W();X();const v=p(y.query.recommend_id),t=p({community_id:"",name:"",images:"",imagesList:[],status:"1",type_id:"",topic_id:"",times:[],url:"",sort:0}),F=p(!1),B=p(!1),Y=p([{type_id:1,name:"\u516C\u544A\u6D88\u606F",small_type_id:1},{type_id:7,name:"H5\u94FE\u63A5",small_type_id:120}]),w=p([]);Z(()=>t.value.type_id,async(a,e)=>{if(F.value=!1,B.value=!1,a==7)F.value=!0,t.value.topic_id=a;else if(a==1){e==7&&(t.value.topic_id="");const i=await _e({type_id:a,page:1,size:100});w.value=i.data.list,B.value=!0}},{deep:!0});const T=async a=>{a.validate(async(e,i)=>{if(e){if(!t.value.topic_id){ae.warning("\u8BF7\u9009\u62E9\u63A8\u8350\u5185\u5BB9");return}let r=z(),d=I;v.value&&(r.recommend_id=v.value,d=N),(await d(v.value?ce:fe,r)).flag&&(C(),localStorage.removeItem("saihuiContent"))}})},j=()=>{C()},z=()=>{let a=JSON.parse(JSON.stringify(t.value)),e=a.imagesList.map(i=>i.url);return a.images=e.join(","),a.imagesList&&delete a.imagesList,a.times&&a.times.length&&(a.start_date=a.times[0],a.end_date=a.times[1],delete a.times),a},K=async()=>{let a={recommend_id:v.value},e=await ge(a);if(e.code==200){t.value.name=e.data.name,t.value.community_id=e.data.community_id,t.value.status=String(e.data.status),t.value.type_id=e.data.type_id,t.value.topic_id=e.data.topic_id,t.value.url=e.data.url,t.value.sort=e.data.sort;let i=e.data.images.split(",").map((r,d)=>({name:String(d),url:r}));if(e.data.start_date&&e.data.end_date&&e.data.start_date!="1970-01-01"&&e.data.end_date!="1970-01-01"){let r=[e.data.start_date,e.data.end_date];t.value.times=r}t.value,await le(),t.value.imagesList=i}},S=p([]),$=async()=>{let a=await pe();a.code==200&&(S.value=a.data)};return ee((a,e,i)=>{a.name==="wordEdit"?k.addKeepAliveName(e.name):k.removeKeepAliveName(e.name),i()}),te(()=>{}),ue(()=>{$(),y.query.recommend_id?(D(`\u63A8\u8350\u7F16\u8F91_${y.query.recommend_id}`),K()):D("\u63A8\u8350\u65B0\u589E")}),(a,e)=>{const i=n("el-option"),r=n("el-select"),d=n("el-form-item"),A=n("el-input"),H=n("el-date-picker"),J=n("el-input-number"),R=n("el-radio"),O=n("el-radio-group"),P=n("el-col"),h=n("el-button"),Q=n("el-form");return m(),c(ie,null,{default:s(()=>[o(Q,{model:l(t),rules:l(ve),ref_key:"ruleFormRef",ref:L,"label-width":"120px"},{default:s(()=>[o(P,{span:10},{default:s(()=>[o(d,{label:"\u6240\u5C5E\u8D5B\u4F1A",prop:"community_id"},{default:s(()=>[o(r,{modelValue:l(t).community_id,"onUpdate:modelValue":e[0]||(e[0]=u=>l(t).community_id=u),placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u8D5B\u4F1A",style:{width:"60%"}},{default:s(()=>[(m(!0),E(V,null,b(l(S),(u,f)=>(m(),c(i,{key:f,label:u.name,value:u.match_id,disabled:u.status!==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"\u6807\u9898",prop:"name"},{default:s(()=>[o(A,{modelValue:l(t).name,"onUpdate:modelValue":e[1]||(e[1]=u=>l(t).name=u),placeholder:"\u8BF7\u8F93\u5165\u89C6\u9891\u6807\u9898"},null,8,["modelValue"])]),_:1}),o(d,{label:"\u5C01\u9762",prop:"imagesList"},{default:s(()=>[o(ne,{fileList:l(t).imagesList,"onUpdate:fileList":e[2]||(e[2]=u=>l(t).imagesList=u),fileSize:5,limit:1},{tip:s(()=>[_(" \u8BF7\u4E0A\u4F20\u5927\u5C0F\u4E0D\u8D85\u8FC7 "),ye,_(" \u683C\u5F0F\u4E3A"),Fe,_("\u7684\u56FE\u7247 ")]),_:1},8,["fileList"])]),_:1}),o(d,{label:"\u63A8\u8350\u7C7B\u578B",prop:"type_id"},{default:s(()=>[o(r,{modelValue:l(t).type_id,"onUpdate:modelValue":e[3]||(e[3]=u=>l(t).type_id=u),placeholder:"\u8BF7\u9009\u62E9"},{default:s(()=>[(m(!0),E(V,null,b(l(Y),(u,f)=>(m(),c(i,{key:f,label:u.name,value:u.type_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(F)?(m(),c(d,{key:0,label:"\u63A8\u8350\u5730\u5740"},{default:s(()=>[o(A,{modelValue:l(t).url,"onUpdate:modelValue":e[4]||(e[4]=u=>l(t).url=u),placeholder:"\u8BF7\u8F93\u5165\u63A8\u8350\u5730\u5740"},null,8,["modelValue"])]),_:1})):x("v-if",!0),l(B)?(m(),c(d,{key:1,label:"\u63A8\u8350\u5185\u5BB9",required:""},{default:s(()=>[o(r,{modelValue:l(t).topic_id,"onUpdate:modelValue":e[5]||(e[5]=u=>l(t).topic_id=u),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:s(()=>[(m(!0),E(V,null,b(l(w),(u,f)=>(m(),c(i,{key:f,label:u.name,value:u.topic_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):x("v-if",!0),o(d,{label:"\u63A8\u8350\u65F6\u95F4",prop:"times"},{default:s(()=>[o(H,{modelValue:l(t).times,"onUpdate:modelValue":e[6]||(e[6]=u=>l(t).times=u),type:"daterange","value-format":"YYYY-MM-DD",format:"YYYY-MM-DD","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),_:1}),o(d,{label:"\u63A8\u8350\u6743\u91CD",prop:"imagesList"},{default:s(()=>[o(J,{modelValue:l(t).sort,"onUpdate:modelValue":e[7]||(e[7]=u=>l(t).sort=u),step:1,min:0,max:1e4},null,8,["modelValue"])]),_:1}),o(d,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[o(O,{modelValue:l(t).status,"onUpdate:modelValue":e[8]||(e[8]=u=>l(t).status=u)},{default:s(()=>[o(R,{label:"1"},{default:s(()=>[_("\u53D1\u5E03")]),_:1}),o(R,{label:"2"},{default:s(()=>[_("\u6682\u4E0D\u53D1\u5E03")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(d,null,{default:s(()=>[o(h,{type:"primary",loading:l(q),onClick:e[9]||(e[9]=u=>T(l(L)))},{default:s(()=>[_("\u521B\u5EFA")]),_:1},8,["loading"]),o(h,{onClick:j},{default:s(()=>[_("\u53D6\u6D88")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}}});const we=de(Be,[["__scopeId","data-v-1d95cb2a"],["__file","/Users/zwl/dnmp/www/frontend/ppos-sport-online/src/views/operatManage/addRecommend.vue"]]);export{we as default};
