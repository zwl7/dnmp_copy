import{d as z,A as J,B as O,r as g,P as $,Q as P,I as W,e as r,o as F,h as L,w as s,f as u,u as l,a as H,g as Q,F as G,q as m,k as X,y as Y,z as Z,b as w,_ as ee}from"./index-73817fb6.js";import{F as te}from"./index-dfa22ab7.js";import{W as ue}from"./index-da48d765.js";import{I as ae}from"./Imgs-dbc6d0a0.js";import{u as le}from"./useFormEdit-e635c879.js";import{K as oe}from"./tabs-3df7d807.js";import{g as se}from"./saihui-f69ee65f.js";import{e as ie,f as ne,h as re}from"./operatManage-c4d273ad.js";import"./style-6cf98c5c.js";import"./upload-d8b475c5.js";const de={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u516C\u544A\u6807\u9898",trigger:"change"},{max:20,message:"\u6700\u591A20\u4E2A\u5B57\u7B26",trigger:"change"}],community_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u6240\u5C5E\u8D5B\u4F1A",trigger:"change"}],imagesList:[{required:!0,message:"\u8BF7\u9009\u62E9\u6216\u4E0A\u4F20\u5C01\u9762\u56FE\u7247",trigger:"change"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u516C\u544A\u72B6\u6001 ",trigger:"change"}]},S=c=>(Y("data-v-8d15af8a"),c=c(),Z(),c),me=S(()=>w("span",{class:"tip"},"2M",-1)),pe=S(()=>w("span",{class:"tip"},"jpeg/jpg/png",-1)),ce=z({__name:"addNotice",setup(c){const{closeCurrent:v,ruleFormRef:B,setTitle:y,loading:V,addMethod:h,updateMethod:N}=le(),E=oe(),_=J(),D=O(),p=g(_.query.notice_id),t=g({community_id:"",type:"",name:"",images:"",imagesList:[],des:"",url:"",status:"1"}),k=async a=>{a.validate(async(e,n)=>{if(e){let d=I(),i=h;p.value&&(d.notice_id=p.value,i=N),(await i(p.value?ie:ne,d)).flag&&(v(),localStorage.removeItem("saihuiContent"))}})},x=()=>{v()},I=()=>{let a=JSON.parse(JSON.stringify(t.value)),e=a.imagesList.map(n=>n.url);return a.images=e.join(","),a.imagesList&&delete a.imagesList,a},q=async()=>{let a={notice_id:p.value},e=await re(a);if(e.code==200){t.value.name=e.data.name,t.value.des=e.data.des,t.value.status=String(e.data.status),t.value.type=String(e.data.type),t.value.url=String(e.data.url),t.value.community_id=e.data.community_id;let n=e.data.images.split(",").map((d,i)=>({name:String(i),url:d}));await X(),t.value.imagesList=n}},U=()=>{localStorage.setItem("noticeContent",t.value.des),D.push({name:"wordEdit",query:{type:"noticeAdd",title:t.value.name,id:p.value}})},A=g([]),M=async()=>{let a=await se();a.code==200&&(A.value=a.data)};return $((a,e,n)=>{a.name==="wordEdit"?E.addKeepAliveName(e.name):E.removeKeepAliveName(e.name),n()}),P(()=>{try{let a=JSON.parse(localStorage.getItem("noticeAdd"));a&&(t.value.name=a.title,t.value.des=a.content)}catch(a){console.error("-------\u7F13\u5B58\u89E3\u6790\u9519\u8BEF",a)}}),W(()=>{M(),_.query.notice_id?(y(`\u516C\u544A\u7F16\u8F91_${_.query.notice_id}`),q()):y("\u516C\u544A\u65B0\u589E")}),(a,e)=>{const n=r("el-option"),d=r("el-select"),i=r("el-form-item"),f=r("el-input"),C=r("el-radio"),R=r("el-radio-group"),T=r("el-col"),b=r("el-button"),j=r("el-form");return F(),L(te,null,{default:s(()=>[u(j,{model:l(t),rules:l(de),ref_key:"ruleFormRef",ref:B,"label-width":"120px"},{default:s(()=>[u(T,{span:10},{default:s(()=>[u(i,{label:"\u6240\u5C5E\u8D5B\u4F1A",prop:"community_id"},{default:s(()=>[u(d,{modelValue:l(t).community_id,"onUpdate:modelValue":e[0]||(e[0]=o=>l(t).community_id=o),placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u8D5B\u4F1A",style:{width:"60%"}},{default:s(()=>[(F(!0),H(G,null,Q(l(A),(o,K)=>(F(),L(n,{key:K,label:o.name,value:o.match_id,disabled:o.status!==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(i,{label:"\u516C\u544A\u7C7B\u578B",prop:"type"},{default:s(()=>[u(d,{modelValue:l(t).type,"onUpdate:modelValue":e[1]||(e[1]=o=>l(t).type=o),placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u7C7B\u578B",style:{width:"60%"},clearable:""},{default:s(()=>[u(n,{label:"\u6700\u65B0\u70ED\u70B9",value:"11"}),u(n,{label:"\u6BD4\u8D5B\u54A8\u8BE2",value:"12"})]),_:1},8,["modelValue"])]),_:1}),u(i,{label:"\u516C\u544A\u540D\u79F0",prop:"name"},{default:s(()=>[u(f,{modelValue:l(t).name,"onUpdate:modelValue":e[2]||(e[2]=o=>l(t).name=o),placeholder:"\u8BF7\u8F93\u5165\u516C\u544A\u540D\u79F0"},null,8,["modelValue"])]),_:1}),u(i,{label:"\u5C01\u9762",prop:"imagesList"},{default:s(()=>[u(ae,{fileList:l(t).imagesList,"onUpdate:fileList":e[3]||(e[3]=o=>l(t).imagesList=o),fileSize:5,limit:1},{tip:s(()=>[m(" \u8BF7\u4E0A\u4F20\u5927\u5C0F\u4E0D\u8D85\u8FC7 "),me,m(" \u683C\u5F0F\u4E3A"),pe,m("\u7684\u56FE\u7247 ")]),_:1},8,["fileList"])]),_:1}),u(i,{label:"\u516C\u544A\u5730\u5740",prop:"url"},{default:s(()=>[u(f,{modelValue:l(t).url,"onUpdate:modelValue":e[4]||(e[4]=o=>l(t).url=o),placeholder:"\u8F93\u5165\u94FE\u63A5\u4EE5\u5F15\u7528\u516C\u4F17\u53F7\u6587\u7AE0,\u542F\u7528\u94FE\u63A5\u5C06\u5BFC\u81F4\u6B63\u6587\u5931\u6548"},null,8,["modelValue"])]),_:1}),u(i,{label:"\u6B63\u6587",prop:"des"},{default:s(()=>[u(ue,{value:l(t).des,"onUpdate:value":e[5]||(e[5]=o=>l(t).des=o),title:l(t).name,"onUpdate:title":e[6]||(e[6]=o=>l(t).name=o),hideToolBar:!0,showEditorAll:!0,height:"300px",onEdit:U},null,8,["value","title"])]),_:1}),u(i,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[u(R,{modelValue:l(t).status,"onUpdate:modelValue":e[7]||(e[7]=o=>l(t).status=o)},{default:s(()=>[u(C,{label:"1"},{default:s(()=>[m("\u53D1\u5E03")]),_:1}),u(C,{label:"4"},{default:s(()=>[m("\u8349\u7A3F")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),u(i,null,{default:s(()=>[u(b,{type:"primary",loading:l(V),onClick:e[8]||(e[8]=o=>k(l(B)))},{default:s(()=>[m("\u521B\u5EFA")]),_:1},8,["loading"]),u(b,{onClick:x},{default:s(()=>[m("\u53D6\u6D88")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}}});const be=ee(ce,[["__scopeId","data-v-8d15af8a"],["__file","/Users/zwl/dnmp/www/frontend/ppos-sport-online/src/views/operatManage/addNotice.vue"]]);export{be as default};
