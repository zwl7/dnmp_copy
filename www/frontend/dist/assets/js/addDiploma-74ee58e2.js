import{d as T,A as j,B as J,r as f,I as K,e as i,o as F,h as V,w as o,f as a,u as t,a as O,g as $,F as P,q as m,k as G,y as H,z as Q,b as h,_ as W}from"./index-73817fb6.js";import{F as X}from"./index-dfa22ab7.js";import{I as Y}from"./Imgs-dbc6d0a0.js";import{u as Z}from"./useFormEdit-e635c879.js";import{K as ee}from"./tabs-3df7d807.js";import{a as ue}from"./event-3905bdce.js";import{u as ae,a as te,g as le}from"./operatManage-c4d273ad.js";import"./upload-d8b475c5.js";const oe={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BC1\u4E66\u540D\u79F0",trigger:"change"},{max:20,message:"\u6700\u591A20\u4E2A\u5B57\u7B26",trigger:"change"}],theme:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BC1\u4E66\u4E3B\u9898",trigger:"change"},{max:70,message:"\u6700\u591A70\u4E2A\u5B57\u7B26",trigger:"change"}],match_activity_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u6240\u5C5E\u8D5B\u4E8B",trigger:"change"}],level:[{required:!0,message:"\u8BF7\u9009\u62E9\u8BC1\u4E66\u7B49\u7EA7",trigger:"change"}],awards_time:[{required:!0,message:"\u8BF7\u9009\u62E9\u9881\u53D1\u65F6\u95F4",trigger:"change"}],imagesList:[{required:!0,message:"\u8BF7\u9009\u62E9\u6216\u4E0A\u4F20\u5C01\u9762\u56FE\u7247",trigger:"change"}],status:[{required:!0,message:"\u8BF7\u9009\u62E9\u72B6\u6001 ",trigger:"change"}]},b=_=>(H("data-v-0f159516"),_=_(),Q(),_),se=b(()=>h("span",{class:"tip"},"2M",-1)),de=b(()=>h("span",{class:"tip"},"jpeg/jpg/png",-1)),re=T({__name:"addDiploma",setup(_){const{closeCurrent:B,ruleFormRef:v,setTitle:E,loading:D,addMethod:L,updateMethod:A}=Z();ee();const g=j();J();const c=f(g.query.cert_id),u=f({name:"",match_activity_id:"",theme:"",level:"",awards_unit:"",awards_time:"",des_one:"",des_two:"",imagesList:[],images:"",notes:"",status:"1"}),x=async d=>{u.value.awards_time,d.validate(async(e,r)=>{if(e){let n=q(),s=L;c.value&&(n.cert_id=c.value,s=A),(await s(c.value?ae:te,n)).flag&&B()}})},k=()=>{B()},q=()=>{let d=JSON.parse(JSON.stringify(u.value)),e=d.imagesList.map(r=>r.url);return d.images=e.join(","),d.imagesList&&delete d.imagesList,d.awards_time=Math.ceil(new Date(d.awards_time).getTime()/1e3),d},S=async()=>{let d={cert_id:c.value},e=await le(d);if(e.code==200){u.value.match_activity_id=e.data.match_activity_id,u.value.theme=e.data.theme,u.value.level=String(e.data.level),u.value.name=e.data.name,u.value.awards_unit=e.data.awards_unit,u.value.status=String(e.data.status),u.value.notes=e.data.notes,u.value.des_one=e.data.des_one,u.value.des_two=e.data.des_two,u.value.awards_time=new Date(e.data.awards_time*1e3);let r=e.data.images.split(",").map((n,s)=>({name:String(s),url:n}));await G(),u.value.imagesList=r}},C=f([]),U=async()=>{let d=await ue({page:1,size:100});d.code==200&&(C.value=d.data.list)};return K(()=>{U(),g.query.cert_id?(E(`\u8BC1\u4E66\u7F16\u8F91_${g.query.cert_id}`),S()):E("\u8BC1\u4E66\u65B0\u589E")}),(d,e)=>{const r=i("el-option"),n=i("el-select"),s=i("el-form-item"),p=i("el-input"),I=i("el-date-picker"),w=i("el-radio"),M=i("el-radio-group"),N=i("el-col"),y=i("el-button"),R=i("el-form");return F(),V(X,null,{default:o(()=>[a(R,{model:t(u),rules:t(oe),ref_key:"ruleFormRef",ref:v,"label-width":"120px"},{default:o(()=>[a(N,{span:10},{default:o(()=>[a(s,{label:"\u6240\u5C5E\u8D5B\u4E8B",prop:"match_activity_id"},{default:o(()=>[a(n,{modelValue:t(u).match_activity_id,"onUpdate:modelValue":e[0]||(e[0]=l=>t(u).match_activity_id=l),placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u8D5B\u4E8B",style:{width:"60%"}},{default:o(()=>[(F(!0),O(P,null,$(t(C),(l,z)=>(F(),V(r,{key:z,label:l.name,value:l.match_activity_id,disabled:l.status!==1},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"\u8BC1\u4E66\u540D\u79F0",prop:"name"},{default:o(()=>[a(p,{modelValue:t(u).name,"onUpdate:modelValue":e[1]||(e[1]=l=>t(u).name=l),placeholder:"\u8BF7\u8F93\u5165\u8BC1\u4E66\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u8BC1\u4E66\u4E3B\u9898",prop:"theme"},{default:o(()=>[a(p,{modelValue:t(u).theme,"onUpdate:modelValue":e[2]||(e[2]=l=>t(u).theme=l),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u8BC1\u4E66\u4E3B\u9898"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u8BC1\u4E66\u7B49\u7EA7",prop:"level"},{default:o(()=>[a(n,{modelValue:t(u).level,"onUpdate:modelValue":e[3]||(e[3]=l=>t(u).level=l),placeholder:"\u8BF7\u9009\u62E9\u8BC1\u4E66\u7B49\u7EA7",style:{width:"60%"},clearable:""},{default:o(()=>[a(r,{label:"\u4E00\u7B49\u5956",value:"1"}),a(r,{label:"\u4E8C\u7B49\u5956",value:"2"}),a(r,{label:"\u4E09\u7B49\u5956",value:"3"}),a(r,{label:"\u4F18\u79C0\u5956",value:"10"})]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"\u9881\u53D1\u5355\u4F4D",prop:"awards_unit"},{default:o(()=>[a(p,{modelValue:t(u).awards_unit,"onUpdate:modelValue":e[4]||(e[4]=l=>t(u).awards_unit=l),placeholder:"\u8BF7\u8F93\u5165\u9881\u53D1\u5355\u4F4D"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u9881\u53D1\u65F6\u95F4",prop:"awards_time"},{default:o(()=>[a(I,{modelValue:t(u).awards_time,"onUpdate:modelValue":e[5]||(e[5]=l=>t(u).awards_time=l),type:"date",placeholder:"\u8BF7\u9009\u62E9\u9881\u53D1\u65F6\u95F4",style:{width:"60%"}},null,8,["modelValue"])]),_:1}),a(s,{label:"\u8BC1\u4E66\u63CF\u8FF0",prop:"des_one"},{default:o(()=>[a(p,{modelValue:t(u).des_one,"onUpdate:modelValue":e[6]||(e[6]=l=>t(u).des_one=l),placeholder:"\u8BF7\u8F93\u5165\u8BC1\u4E66\u63CF\u8FF0",type:"textarea"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u5C01\u9762",prop:"imagesList"},{default:o(()=>[a(Y,{fileList:t(u).imagesList,"onUpdate:fileList":e[7]||(e[7]=l=>t(u).imagesList=l),fileSize:5,limit:1},{tip:o(()=>[m(" \u8BF7\u4E0A\u4F20\u5927\u5C0F\u4E0D\u8D85\u8FC7 "),se,m(" \u683C\u5F0F\u4E3A"),de,m("\u7684\u56FE\u7247 ")]),_:1},8,["fileList"])]),_:1}),a(s,{label:"\u5907\u6CE8",prop:"notes"},{default:o(()=>[a(p,{modelValue:t(u).notes,"onUpdate:modelValue":e[8]||(e[8]=l=>t(u).notes=l),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u72B6\u6001",prop:"status"},{default:o(()=>[a(M,{modelValue:t(u).status,"onUpdate:modelValue":e[9]||(e[9]=l=>t(u).status=l)},{default:o(()=>[a(w,{label:"1"},{default:o(()=>[m("\u542F\u7528")]),_:1}),a(w,{label:"4"},{default:o(()=>[m("\u7981\u7528")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,null,{default:o(()=>[a(y,{type:"primary",loading:t(D),onClick:e[10]||(e[10]=l=>x(t(v)))},{default:o(()=>[m("\u521B\u5EFA")]),_:1},8,["loading"]),a(y,{onClick:k},{default:o(()=>[m("\u53D6\u6D88")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}}});const Fe=W(re,[["__scopeId","data-v-0f159516"],["__file","/Users/zwl/dnmp/www/frontend/ppos-sport-online/src/views/events/addDiploma.vue"]]);export{Fe as default};
