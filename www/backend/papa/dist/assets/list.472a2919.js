import{c as E,d as F,e as A,f as b,g as N,h as x,j as k,k as V}from"./element-plus.fda9d17d.js";import"./vue.ed337178.js";import{_ as S}from"./Table.9b2293ee.js";import{S as T}from"./Select.78c64a3c.js";import I from"./Oeration.6e115ddf.js";import C from"./tagOption.dc3dd682.js";import{h as w}from"./http.ed4ad2d7.js";import{c as P,_ as j}from"./index.43a84b26.js";import{Q as L,d as _,e as $,k as z,o as M,X as O,W as m,u as a,l}from"./@vue.7f0f1fa4.js";import"./lodash-es.32c7d6de.js";import"./async-validator.6fbb5f2f.js";import"./@vueuse.a0d26dd7.js";import"./dayjs.8e294223.js";import"./axios.c8347845.js";import"./@element-plus.debac796.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./table.b064dc6b.js";import"./qs.fa7a39be.js";import"./side-channel.3e40f30b.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.ac588fa5.js";import"./vue-router.52e17900.js";import"./pinia.840704ed.js";import"./vue-demi.4b2e6391.js";import"./js-cookie.711e9524.js";import"./nprogress.d7e4ab0b.js";import"./default-passive-events.74004992.js";const R={type_id:0,keywords:"",activity_type:""},U=r=>w.fetchPost("/activityPlatform/distributionAuth/activityList",r),W=r=>w.fetchPost("/activityPlatform/activity/distribution",r),q=()=>{const r=L(R),f=_(0),h=_(""),o=[{headerName:"\u6D3B\u52A8\u540D\u79F0",field:"name",align:"center"},{headerName:"\u6240\u5C5E\u661F\u7403",field:"community_name",align:"center"},{headerName:"\u6D3B\u52A8\u7C7B\u578B",field:"resource_type",align:"center"},{headerName:"\u4E70\u5355\u6A21\u5F0F",field:"is_free",valueFormatter:t=>{let i={1:"\u514D\u8D39",2:"AA",3:"\u6536\u8D39"};return i[t.value]?i[t.value]:"--"}},{headerName:"\u5B9E\u9645\u6536\u6B3E",field:"worth",align:"center"},{headerName:"\u5F85\u5212\u91D1\u989D",field:"distribution_detailed",minWidth:120,align:"center",cellRendererSelector:t=>({component:C,show:!0,params:{data:{field:"distribution_detailed",...t.data}}})},{headerName:"\u51BB\u7ED3\u91D1\u989D",field:"freeze_worth",align:"center"},{headerName:"\u5DF2\u5212\u91D1\u989D",field:"worth_detailed",minWidth:120,align:"center",cellRendererSelector:t=>({component:C,show:!0,params:{data:{field:"worth_detailed",...t.data}}})},{headerName:"\u6D3B\u52A8\u72B6\u6001",field:"activity_status",align:"center"},{headerName:"\u5212\u62E8\u72B6\u6001",field:"split_str",align:"center"},{headerName:"\u5212\u6267\u65F6\u95F4",field:"worth_c_time_str",align:"center"},{headerName:"\u6D3B\u52A8\u65F6\u95F4",field:"start_time",width:320,valueGetter:t=>t.data.start_time_str+" \u81F3 "+t.data.end_time_str},{width:160,headerName:"\u64CD\u4F5C",field:"activity",pinned:"right",align:"center",cellRendererSelector:t=>({component:I,show:!0,params:{data:t.data,splitBill(){let i=t.data.name,n=t.data.activity_id,e=`\u6B64\u64CD\u4F5C\u5C06\u5BF9\u6D3B\u52A8\u3010${i}\u3011\u6536\u76CA\u8FDB\u884C\u5212\u62E8`;E.confirm(e,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{W({activity_id:n}).then(D=>{D.code==200?(F({type:"success",message:"\u64CD\u4F5C\u6210\u529F"}),s()):F({type:"error",message:D.message})})}).catch(()=>{})},viewDetail(){let i=t.data.activity_id;P.push({name:"splitBillDetail",query:{activity_id:i}})}}})}],v=[],c=_(1),u=_(10);let d=_(v);const s=(t=()=>{})=>{d.value=[],U(Object.assign({page:c.value,size:u.value},r)).then(i=>{let n=Math.floor(new Date().getTime()/1e3);i.data.list.map(e=>{let p="";e.start_time>n?p="\u672A\u5F00\u59CB":e.start_time<n&&n<e.end_time?p="\u8FDB\u884C\u4E2D":n>e.end_time&&(p="\u5DF2\u7ED3\u675F"),e.activity_status=p}),d.value=i.data.list,f.value=i.data.count,t.apply(null)}).catch(()=>{})},y=t=>{c.value=t,s()};return $(r,()=>{c.value=1,s()}),{getSplitBillList:s,total:f,splitBillList:d,page:c,size:u,activityColumns:o,listFilters:r,keywords:h,handleCurrentChange:y}};const G=z({__name:"list",setup(r){const{getSplitBillList:f,total:h,splitBillList:g,activityColumns:B,listFilters:o,handleCurrentChange:v}=q();return f(),(c,u)=>{const d=A,s=b,y=N,t=x,i=k,n=V;return M(),O(S,{columns:a(B),list:a(g),tableId:"activity_id",showIndex:""},{search:m(()=>[l(i,{style:{display:"flex","flex-wrap":"wrap"}},{default:m(()=>[l(s,{class:"keywords search-item"},{default:m(()=>[l(d,{placeholder:"\u8F93\u5165\u6807\u9898 \u641C\u7D22",class:"keywords search-item",modelValue:a(o).keywords,"onUpdate:modelValue":u[0]||(u[0]=e=>a(o).keywords=e)},null,8,["modelValue"])]),_:1}),l(s,{label:"",prop:"type_id",class:"search-item"},{default:m(()=>[l(T,{url:"/activityPlatform/resourceType/select",modelValue:a(o).type_id,"onUpdate:modelValue":u[1]||(u[1]=e=>a(o).type_id=e),desc:"\u7C7B\u578B",single:!0,params:{type_id:1,status:1}},null,8,["modelValue"])]),_:1}),l(s,{prop:"status",class:"search-item"},{default:m(()=>[l(t,{modelValue:a(o).activity_type,"onUpdate:modelValue":u[2]||(u[2]=e=>a(o).activity_type=e),class:"m-2",placeholder:"\u8D5B\u4E8B\u7C7B\u578B",multiple:!1},{default:m(()=>[l(y,{label:"\u666E\u901A\u6D3B\u52A8",value:"1"}),l(y,{label:"\u8D5B\u4E8B\u6D3B\u52A8",value:"2"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),pagination:m(()=>[l(n,{background:"",layout:"total, prev, pager, next",total:a(h),onCurrentChange:a(v)},null,8,["total","onCurrentChange"])]),_:1},8,["columns","list"])}}});var Nt=j(G,[["__scopeId","data-v-fc00eb74"]]);export{Nt as default};
