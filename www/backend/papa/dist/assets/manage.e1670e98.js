import{b as ut,x as st,y as nt,m as lt,n as ct,k as dt,q as pt,A as rt,o as _t,f as vt,r as mt,d as r,c as gt}from"./element-plus.fda9d17d.js";import"./vue.ed337178.js";import yt from"./editorDialog.a6345072.js";import ft from"./changeActivityDialog.0667eccd.js";import{b as Et,u as bt}from"./vue-router.52e17900.js";import{u as j,g as Bt,b as Dt,d as ht}from"./restful.83d9a0f2.js";import{e as Ft}from"./restful.b7783b2d.js";import{_ as Ct}from"./index.43a84b26.js";import{k as At,d as s,Q as kt,i as Tt,ag as wt,o as xt,c as It,a as e,$ as b,l as o,W as u,a3 as U,a4 as N,n as Vt,_ as c,aA as St,aB as jt}from"./@vue.7f0f1fa4.js";import"./lodash-es.32c7d6de.js";import"./async-validator.6fbb5f2f.js";import"./@vueuse.a0d26dd7.js";import"./dayjs.8e294223.js";import"./axios.c8347845.js";import"./@element-plus.debac796.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./index.f95e1288.js";import"./@wangeditor.3afebf6c.js";import"./http.ed4ad2d7.js";import"./qs.fa7a39be.js";import"./side-channel.3e40f30b.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.ac588fa5.js";import"./pinia.840704ed.js";import"./vue-demi.4b2e6391.js";import"./js-cookie.711e9524.js";import"./nprogress.d7e4ab0b.js";import"./default-passive-events.74004992.js";const y=B=>(St("data-v-068b6608"),B=B(),jt(),B),Lt={class:"heder-container"},Mt={class:"image"},$t=["src"],Ut={class:"left"},Nt={class:"title"},zt={class:"bottom-info"},Ht={class:"item"},Pt={class:"item"},qt={class:"right"},Qt={class:"topic"},Rt={class:"topic-item"},Wt={class:"header"},Gt=y(()=>e("div",{class:"topic-item-title"},"\u6D3B\u52A8\u7B80\u4ECB",-1)),Jt={class:"content"},Kt=["innerHTML"],Ot={class:"topic-item"},Xt={class:"header"},Yt=y(()=>e("div",{class:"topic-item-title"},"\u53C2\u4E0E\u6D41\u7A0B",-1)),Zt={class:"content"},te=["innerHTML"],ee={class:"topic-item"},ae={class:"header"},oe=y(()=>e("div",{class:"topic-item-title"},"\u5176\u4ED6\u8BF4\u660E",-1)),ie={class:"content"},ue=["innerHTML"],se={class:"topic-item"},ne={class:"header"},le=y(()=>e("div",{class:"topic-item-title"},"\u8D2D\u7968\u9650\u5236",-1)),ce={class:"content form-item"},de=y(()=>e("div",{class:"label"},[e("span",{style:{"margin-right":"10px"}},"\u6BCF\u4EBA\u9650\u8D2D")],-1)),pe={class:"value"},re={class:"topic"},_e={class:"pagination"},ve={class:"label-loading"},me=y(()=>e("span",null,"\u6BCF\u4EBA\u53EF\u53C2\u4E0E\u6D3B\u52A8\u6570\u91CF",-1)),ge={class:"dialog-footer"},ye=At({__name:"manage",setup(B){const z=Et(),H=bt(),_=s(H.query.activity_special_page_id),d=kt({banner:"",content:"",title:"",community_count:0,activity_count:0}),D=s(""),h=s(""),F=s(""),p=s(""),k=s(""),C=s("\u5185\u5BB9\u7F16\u8F91"),v=s(0),A=s("1"),T=s(!1),f=s(!1),P=()=>{z.push({name:"specialEventsAdd",query:{activity_special_page_id:_.value}})},q=(a,t)=>{console.log(a,t)},Q=()=>{let a={[k.value]:p.value,activity_special_page_id:_.value};j(a).then(t=>{if(t.code===200)switch(r({message:"\u66F4\u65B0\u6210\u529F",grouping:!0,type:"success"}),k.value){case"content":F.value=p.value;break;case"others":h.value=p.value;break;case"join_process":D.value=p.value;break}else r({message:"\u66F4\u65B0\u5931\u8D25",grouping:!0,type:"warning"})})},R=()=>{let a={activity_special_page_id:_.value,can_apply_num:v.value};j(a).then(t=>{t.code===200?r({message:"\u66F4\u65B0\u6210\u529F",grouping:!0,type:"success"}):r({message:"\u66F4\u65B0\u5931\u8D25",grouping:!0,type:"warning"})}),f.value=!1},w=()=>{Bt({activity_special_page_id:_.value}).then(a=>{a.code===200&&(v.value=a.data.can_apply_num,d.banner=a.data.banner,d.content=a.data.content,d.title=a.data.title,d.community_count=a.data.community_count,d.activity_count=a.data.activity_count,h.value=a.data.others?a.data.others:"\u5176\u4ED6\u8BF4\u660E\u6682\u65E0",F.value=a.data.content?a.data.content:"\u6D3B\u52A8\u7B80\u4ECB\u6682\u65E0",D.value=a.data.join_process?a.data.join_process:"\u53C2\u4E0E\u6D41\u7A0B\u6682\u65E0",a.data.activity_ids&&($.value=a.data.activity_ids.split(",").map(Number)))})},x=async a=>{switch(k.value=a,a){case"content":p.value=F.value,C.value="\u6D3B\u52A8\u7B80\u4ECB";break;case"others":p.value=h.value,C.value="\u53C2\u4E0E\u6D41\u7A0B";break;case"join_process":p.value=D.value,C.value="\u5176\u4ED6\u8BF4\u660E";break}await Vt(),T.value=!0},I=s(!1),V=s(1),S=s(10),L=s(0),M=s([]),$=s([]),W=()=>{I.value=!0},G=a=>{let t={activity_id:a.join(","),activity_special_page_id:_.value};j(t).then(n=>{n.code===200?(r({message:"\u66F4\u65B0\u6210\u529F",grouping:!0,type:"success"}),m(),w()):r({message:"\u66F4\u65B0\u5931\u8D25",grouping:!0,type:"warning"})})},m=()=>{let a={page:V.value,size:S.value,activity_special_page_id:_.value};Dt(a).then(t=>{t.code==200&&(L.value=t.data.count,M.value=t.data.list)})},J=a=>{let{name:t,activity_id:n}=a,g=`\u662F\u5426\u4ECE\u5F53\u524D\u4E13\u9898\u5220\u9664\u6D3B\u52A8${t}?`;gt.confirm(g,"\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{let E={activity_id:n,activity_special_page_id:_.value};ht(E).then(l=>{l.code&&(r({message:"\u5220\u9664\u6210\u529F",grouping:!0,type:"success"}),m(),w())})}).catch(()=>{})},K=a=>{let{activity_id:t,status:n}=a,g=parseInt(n,10)===1?"3":"1";Ft({activity_id:t,status:g}).then(E=>{E.code===200&&(r({message:"\u66F4\u65B0\u6210\u529F",grouping:!0,type:"success"}),m())})};return Tt(()=>{w(),m()}),(a,t)=>{const n=ut,g=st,E=nt,l=lt,O=ct,X=dt,Y=wt("QuestionFilled"),Z=pt,tt=rt,et=_t,at=vt,ot=mt;return xt(),It("div",null,[e("div",Lt,[e("div",Mt,[e("img",{src:d.banner,alt:"",srcset:""},null,8,$t)]),e("div",Ut,[e("div",Nt,b(d.title),1),e("div",zt,[e("div",Ht,"\u53C2\u4E0E\u661F\u7403\u6570: "+b(d.community_count),1),e("div",Pt,"\u53C2\u4E0E\u6D3B\u52A8\u6570\uFF1A"+b(d.activity_count),1)])]),e("div",qt,[o(n,{type:"primary",onClick:W},{default:u(()=>[c("\u6DFB\u52A0\u6D3B\u52A8")]),_:1}),o(n,{onClick:P},{default:u(()=>[c("\u8BBE\u7F6E")]),_:1})])]),o(E,{modelValue:A.value,"onUpdate:modelValue":t[0]||(t[0]=i=>A.value=i),type:"card",class:"tabs",onTabClick:q},{default:u(()=>[o(g,{label:"\u4E13\u9898\u914D\u7F6E",name:"1"}),o(g,{label:"\u53C2\u4E0E\u6D3B\u52A8",name:"2 "})]),_:1},8,["modelValue"]),U(e("div",Qt,[e("div",Rt,[e("div",Wt,[Gt,o(n,{type:"primary",link:"",onClick:t[1]||(t[1]=i=>x("content"))},{default:u(()=>[c("\u7F16\u8F91")]),_:1})]),e("div",Jt,[e("div",{innerHTML:F.value},null,8,Kt)])]),e("div",Ot,[e("div",Xt,[Yt,o(n,{type:"primary",link:"",onClick:t[2]||(t[2]=i=>x("join_process"))},{default:u(()=>[c("\u7F16\u8F91")]),_:1})]),e("div",Zt,[e("div",{innerHTML:D.value},null,8,te)])]),e("div",ee,[e("div",ae,[oe,o(n,{type:"primary",link:"",onClick:t[3]||(t[3]=i=>x("others"))},{default:u(()=>[c("\u7F16\u8F91")]),_:1})]),e("div",ie,[e("div",{innerHTML:h.value},null,8,ue)])]),e("div",se,[e("div",ne,[le,o(n,{type:"primary",link:"",onClick:t[4]||(t[4]=i=>f.value=!0)},{default:u(()=>[c("\u7F16\u8F91")]),_:1})]),e("div",ce,[de,e("div",pe,b(v.value>0?v.value:"\u4E0D\u9650\u8D2D"),1)])])],512),[[N,A.value==1]]),U(e("div",re,[o(O,{data:M.value,border:""},{default:u(()=>[o(l,{type:"index",width:"50"}),o(l,{prop:"activity_id",label:"\u6D3B\u52A8id"}),o(l,{prop:"name",label:"\u6D3B\u52A8\u540D\u79F0"}),o(l,{prop:"community_name",label:"\u6240\u5C5E\u5708\u5B50"}),o(l,{prop:"address",label:"\u6D3B\u52A8\u5730\u5740"}),o(l,{prop:"c_time",label:"\u521B\u5EFA\u65F6\u95F4"}),o(l,{prop:"status_str",label:"\u6D3B\u52A8\u72B6\u6001",align:"center"}),o(l,{prop:"",label:"\u64CD\u4F5C",align:"center"},{default:u(i=>[o(n,{type:"primary",onClick:it=>K(i.row),link:""},{default:u(()=>[c(b(parseInt(i.row.status,10)==1?"\u4E0B\u67B6":"\u4E0A\u67B6"),1)]),_:2},1032,["onClick"]),o(n,{type:"warning",link:"",onClick:it=>J(i.row)},{default:u(()=>[c("\u5220\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e("div",_e,[o(X,{"current-page":V.value,"onUpdate:currentPage":t[5]||(t[5]=i=>V.value=i),"page-size":S.value,"onUpdate:pageSize":t[6]||(t[6]=i=>S.value=i),background:"",layout:"total, prev, pager, next",total:L.value,onCurrentChange:m,onSizeChange:m},null,8,["current-page","page-size","total"])])],512),[[N,A.value==2]]),o(yt,{visible:T.value,"onUpdate:visible":t[7]||(t[7]=i=>T.value=i),content:p.value,"onUpdate:content":t[8]||(t[8]=i=>p.value=i),title:C.value,onConfirm:Q},null,8,["visible","content","title"]),o(ft,{visible:I.value,"onUpdate:visible":t[9]||(t[9]=i=>I.value=i),activityIds:$.value,onConfirm:G},null,8,["visible","activityIds"]),o(ot,{modelValue:f.value,"onUpdate:modelValue":t[12]||(t[12]=i=>f.value=i),title:"\u8D2D\u7968\u9650\u5236",width:"500px","before-close":a.handleClose},{footer:u(()=>[e("span",ge,[o(n,{onClick:t[11]||(t[11]=i=>f.value=!1)},{default:u(()=>[c("\u53D6\u6D88")]),_:1}),o(n,{type:"primary",onClick:R},{default:u(()=>[c(" \u786E\u8BA4 ")]),_:1})])]),default:u(()=>[o(at,null,{label:u(()=>[e("div",ve,[me,o(tt,{class:"box-item",effect:"dark",content:"\u8F93\u5165\u6570\u91CF0\u8868\u793A\u4E0D\u9650\u8D2D",placement:"top"},{default:u(()=>[o(Z,null,{default:u(()=>[o(Y)]),_:1})]),_:1})])]),default:u(()=>[o(et,{modelValue:v.value,"onUpdate:modelValue":t[10]||(t[10]=i=>v.value=i),min:0,step:1},null,8,["modelValue"])]),_:1})]),_:1},8,["modelValue","before-close"])])}}});var ta=Ct(ye,[["__scopeId","data-v-068b6608"]]);export{ta as default};
