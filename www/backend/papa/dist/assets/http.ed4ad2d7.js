import{u as k,b as u,m as r,M as c,r as g}from"./index.43a84b26.js";import{b as l}from"./axios.c8347845.js";import{l as w}from"./qs.fa7a39be.js";const P=k(),n=new Map,h=e=>{const{url:s,method:t,data:o}=e;return[s,t,o].join("&")},f=e=>{const s=h(e);n.has(s)||(e.cancelToken=new l.CancelToken(t=>{n.set(s,t)}))},i=e=>{const s=h(e);n.has(s)&&(n.get(s)(s),n.delete(s))},d=l.create({baseURL:"https://apitest.wesais.cn",timeout:5e4});d.interceptors.request.use(e=>{const s=u();e.headers.Authorization=s.getToken;let t=[];return e.data&&e.data.indexOf("&")>-1?t=e.data.split("&"):e.data&&(t[0]=e.data),P.getMode==="development"&&(t[t.length]=`company_id=${{}.VITE_APP_COMPANY_ID}`,t[t.length]="personnel_id=178"),e.data=t.join("&"),e.headers["Content-Type"]="application/x-www-form-urlencoded",i(e),f(e),e},e=>Promise.reject(e));d.interceptors.response.use(e=>(i(e.config),e.data),e=>(i(e.config||{}),Promise.reject(e)));function T(e,s){let t=!0;return s.hiddenMessage&&(t=!1),new Promise((o,m)=>{d.post(e,w.stringify(s)).then(a=>{switch(a.code){case 200:o(a);break;case 40101:const p=u();r(a.message,c.error),p.clearToken(),g();break;default:r(a.message,c.error)}}).catch(a=>{t&&r(a,c.error),m(a)})})}const q={fetchPost:T};export{q as h};
