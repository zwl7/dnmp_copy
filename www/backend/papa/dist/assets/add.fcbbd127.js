import{e as C,f as I,b as V,j as U,d as n}from"./element-plus.fda9d17d.js";import"./vue.ed337178.js";import{u as R,b as j}from"./vue-router.52e17900.js";import{g as q}from"./listener.f2472c1b.js";import{U as A}from"./UploadImg.f662dd18.js";import{_ as D}from"./index.f95e1288.js";import{g as N,a as S,u as T}from"./restful.83d9a0f2.js";import{_ as $}from"./index.43a84b26.js";import{k as M,d as m,Q as f,i as O,o as W,X as L,W as l,l as a,a as Q,_ as g}from"./@vue.7f0f1fa4.js";import"./lodash-es.32c7d6de.js";import"./async-validator.6fbb5f2f.js";import"./@vueuse.a0d26dd7.js";import"./dayjs.8e294223.js";import"./axios.c8347845.js";import"./@element-plus.debac796.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@wangeditor.3afebf6c.js";import"./http.ed4ad2d7.js";import"./qs.fa7a39be.js";import"./side-channel.3e40f30b.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.ac588fa5.js";import"./pinia.840704ed.js";import"./vue-demi.4b2e6391.js";import"./js-cookie.711e9524.js";import"./nprogress.d7e4ab0b.js";import"./default-passive-events.74004992.js";const X={title:[{required:!0,message:"\u6807\u9898\u5FC5\u9700"},{max:255,message:"\u6700\u5927\u957F\u5EA6\u4E3A255"}],banner:[{required:!0,message:"\u56FE\u7247\u5FC5\u9700",trigger:["blur","change"]}]};const z={style:{width:"100%","text-align":"left"}},G=M({__name:"add",setup(H){const c=m(),v=f(X),{windowBeforeunload:b,removeWindowBfunload:J}=q(),y=R(),r=m(y.query.activity_special_page_id),d=j(),o=f({title:"",banner:"",content:""}),s=m(!1);b();const F=async e=>{!e||await e.validate((t,p)=>{t?r.value?x():h():console.log("error submit!",p)})},E=()=>{},B=e=>{o.banner=e},h=()=>{s.value=!0;let e=Object.assign({},o);S(e).then(t=>{t.code===200?(n({message:"\u65B0\u589E\u6210\u529F",grouping:!0,type:"success"}),setTimeout(()=>{d.back()},1e3)):n({message:t.message,grouping:!0,type:"error"}),s.value=!1}).catch(()=>{s.value=!1})},x=()=>{s.value=!0;let e=Object.assign({activity_special_page_id:r.value},o);e.content!=="<p><br></p>"&&(e.content=""),T(e).then(t=>{t.code===200?n({message:"\u66F4\u65B0\u6210\u529F",grouping:!0,type:"success"}):n({message:t.message,grouping:!0,type:"error"}),setTimeout(()=>{d.back()},1e3),s.value=!1}).catch(()=>{s.value=!1})},w=()=>{N({activity_special_page_id:r.value}).then(e=>{e.code===200&&(o.banner=e.data.banner,o.content=e.data.content,o.title=e.data.title)})};return O(()=>{r.value&&w()}),(e,t)=>{const p=C,u=I,_=V,k=U;return W(),L(k,{rules:v,ref_key:"ruleFormRef",ref:c,model:o,"label-width":"80px","label-position":"left"},{default:l(()=>[a(u,{label:"\u6807\u9898",prop:"title"},{default:l(()=>[a(p,{modelValue:o.title,"onUpdate:modelValue":t[0]||(t[0]=i=>o.title=i),placeholder:"\u8BF7\u8F93\u5165\u6807\u9898",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),a(u,{label:"\u4E13\u9898\u56FE\u7247",prop:"banner",class:"tl"},{default:l(()=>[a(A,{img:o.banner,multiple:!1,limit:0,onUploadedImg:B,width:250,height:182},null,8,["img"])]),_:1}),a(u,{label:"\u7B80\u4ECB",prop:"content",class:"tl"},{default:l(()=>[a(D,{value:o.content,"onUpdate:value":t[1]||(t[1]=i=>o.content=i)},null,8,["value"])]),_:1}),a(u,null,{default:l(()=>[Q("div",z,[a(_,{onClick:E},{default:l(()=>[g("\u53D6\u6D88")]),_:1}),a(_,{type:"success",loading:s.value,onClick:t[2]||(t[2]=i=>F(c.value))},{default:l(()=>[g("\u63D0\u4EA4")]),_:1},8,["loading"])])]),_:1})]),_:1},8,["rules","model"])}}});var Re=$(G,[["__scopeId","data-v-4f85039a"]]);export{Re as default};
