import{c as N,d as C,e as P,f as I,i as L,g as T,h as U,p as M,j as S,k as O}from"./element-plus.fda9d17d.js";import"./vue.ed337178.js";import{_ as z}from"./Table.9b2293ee.js";import{h as b}from"./http.ed4ad2d7.js";import{p as $}from"./restful.b7783b2d.js";import j from"./Operation.1092c943.js";import{p as D,_ as G}from"./index.43a84b26.js";import{Q,d as c,e as R,k as W,o as w,X as k,W as n,u as o,l as a,c as X,ad as H,U as J}from"./@vue.7f0f1fa4.js";import{c as K}from"./city.aedd9592.js";import"./lodash-es.32c7d6de.js";import"./async-validator.6fbb5f2f.js";import"./@vueuse.a0d26dd7.js";import"./dayjs.8e294223.js";import"./axios.c8347845.js";import"./@element-plus.debac796.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./table.b064dc6b.js";import"./qs.fa7a39be.js";import"./side-channel.3e40f30b.js";import"./get-intrinsic.8c87d952.js";import"./has-symbols.caae0f97.js";import"./has-proto.76cff6c7.js";import"./function-bind.cb3858f2.js";import"./has.c1051c46.js";import"./call-bind.208b5ef0.js";import"./object-inspect.ac588fa5.js";import"./vue-router.52e17900.js";import"./pinia.840704ed.js";import"./vue-demi.4b2e6391.js";import"./js-cookie.711e9524.js";import"./nprogress.d7e4ab0b.js";import"./default-passive-events.74004992.js";const Y=e=>b.fetchPost("/activityPlatform/activitySessions/getPushList",e),Z=e=>b.fetchPost("/activityPlatform/community/list",e),q=()=>{const e=Q({c_time_range:[],community_id:"",status:"",keywords:"",street_id:[]}),f=c(0),F=[{headerName:"\u6D3B\u52A8id",field:"activity_id"},{headerName:"\u65F6\u95F4",field:"update_time"},{headerName:"\u63A8\u9001\u6D3B\u52A8",field:"activity_name"},{headerName:"\u6D3B\u52A8\u65F6\u95F4",field:"activity_time"},{headerName:"\u6240\u5C5E\u661F\u7403",field:"community_name"},{headerName:"\u5730\u533A",field:"addr"},{headerName:"\u63A8\u9001\u62A5\u540D\u4EBA\u6570",field:"num"},{headerName:"\u63A8\u9001\u72B6\u6001",field:"status_str"},{headerName:"\u5907\u6CE8",field:"reason"},{width:120,headerName:"\u64CD\u4F5C",align:"center",pinned:"right",cellRendererSelector:s=>({component:j,show:!0,params:{data:s.data,updateStatus(){_(s)}}})}],B=[],d=c(1),v=c(10);let l=c(B);const g=(s=()=>{})=>{l.value=[];let i={};e.street_id&&e.street_id[1]&&(i.street_id=e.street_id[1]/100),e.status&&(i.status=e.status),e.community_id&&(i.community_id=e.community_id),e.keywords&&(i.keyword=e.keywords),e.c_time_range&&e.c_time_range.length>0&&(i.start_date=D(e.c_time_range[0],"{y}-{M}-{d}"),i.end_date=D(e.c_time_range[1],"{y}-{M}-{d}")),Y(Object.assign({page:d.value,size:v.value},i)).then(r=>{r.data.list.map(t=>{t.update_time=D(t.u_time,"{y}-{M}-{d} {h}:{m}:{s}")}),l.value=r.data.list,f.value=r.data.count,d.value+=1,s.apply(null)}).catch(()=>{})},_=s=>{N.confirm("\u91CD\u4F20\u5F53\u524D\u8BB0\u5F55\u6570\u636E?","\u63D0\u793A",{confirmButtonText:"\u786E\u8BA4",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{let{activity_id:i,activity_sessions_id:r}=s.data;$({activity_id:i,activity_sessions_id:r}).then(p=>{p.code==200?(C({message:"\u91CD\u4F20\u6210\u529F",grouping:!0,type:"success"}),s.data.status=1):C({message:p.message,grouping:!0,type:"warning"})})}).catch(()=>{})};return R(e,()=>{d.value=1,console.log(e),g()},{immediate:!0}),{getList:g,advTotal:f,advList:l,advPage:d,advSize:v,advColumns:F,advFilters:e}};const ee=W({__name:"list",setup(e){const{getList:f,advTotal:F,advList:B,advPage:d,advColumns:v,advFilters:l}=q(),g=r=>{d.value=r,f()},_=c([]),s=c(!1),i=r=>{let t={page:1,size:50,keywords:r};r?(s.value=!0,Z(t).then(p=>{let m=[];p.data.list.map(y=>{m.push({label:y.name,value:y.community_id})}),_.value=m,s.value=!1})):_.value=[]};return(r,t)=>{const p=P,m=I,y=L,h=T,E=U,V=M,A=S,x=O;return w(),k(z,{columns:o(v),list:o(B),tableId:"adv_id",showIndex:""},{search:n(()=>[a(A,{style:{display:"flex","flex-wrap":"wrap"}},{default:n(()=>[a(m,{class:"keywords search-item"},{default:n(()=>[a(p,{placeholder:"\u8BF7\u8F93\u5165\u6D3B\u52A8ID/\u6D3B\u52A8\u540D\u79F0 \u641C\u7D22",clearable:"",class:"keywords search-item",modelValue:o(l).keywords,"onUpdate:modelValue":t[0]||(t[0]=u=>o(l).keywords=u)},null,8,["modelValue"])]),_:1}),a(m,{label:"",prop:"dates_1",class:"search-item"},{default:n(()=>[a(y,{type:"daterange","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",class:"search-item","value-format":"x",modelValue:o(l).c_time_range,"onUpdate:modelValue":t[1]||(t[1]=u=>o(l).c_time_range=u)},null,8,["modelValue"])]),_:1}),a(m,{prop:"content_type",class:"search-item"},{default:n(()=>[a(E,{modelValue:o(l).community_id,"onUpdate:modelValue":t[2]||(t[2]=u=>o(l).community_id=u),filterable:"",remote:"",clearable:"",placeholder:"\u8F93\u5165\u661F\u7403\u7B5B\u9009","remote-show-suffix":"","remote-method":i,loading:s.value},{default:n(()=>[(w(!0),X(J,null,H(_.value,u=>(w(),k(h,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),a(m,{prop:"content_type",class:"search-item"},{default:n(()=>[a(V,{placeholder:"\u533A\u57DF\u7B5B\u9009",options:o(K),"show-all-levels":!1,clearable:!0,filterable:"",modelValue:o(l).street_id,"onUpdate:modelValue":t[3]||(t[3]=u=>o(l).street_id=u)},null,8,["options","modelValue"])]),_:1}),a(m,{prop:"status",class:"search-item"},{default:n(()=>[a(E,{modelValue:o(l).status,"onUpdate:modelValue":t[4]||(t[4]=u=>o(l).status=u),clearable:"",class:"m-2",placeholder:"\u72B6\u6001",multiple:!1},{default:n(()=>[a(h,{value:"",label:"\u8BF7\u9009\u62E9\u72B6\u6001"}),a(h,{label:"\u6210\u529F",value:"1"}),a(h,{label:"\u5931\u8D25",value:"2"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),pagination:n(()=>[a(x,{background:"",layout:"total, prev, pager, next",total:o(F),onCurrentChange:g},null,8,["total"])]),_:1},8,["columns","list"])}}});var Ue=G(ee,[["__scopeId","data-v-6874e60e"]]);export{Ue as default};
